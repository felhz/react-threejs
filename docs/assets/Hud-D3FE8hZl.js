import{e as d,z as C,G as b,H as R,J as x,K as T,d as F,_ as v,j as w,l as L}from"./react-three-fiber.esm-B87Saucm.js";import{r as e}from"./ssg-client-C6-up7Ct.js";function S(n,u,c){const t=d(o=>o.size),s=d(o=>o.viewport),a=typeof n=="number"?n:t.width*s.dpr,l=typeof u=="number"?u:t.height*s.dpr,g=(typeof n=="number"?c:n)||{},{samples:p=0,depth:m,...i}=g,f=e.useMemo(()=>{const o=new C(a,l,{minFilter:b,magFilter:b,type:R,...i});return m&&(o.depthTexture=new x(a,l,T)),o.samples=p,o},[]);return e.useLayoutEffect(()=>{f.setSize(a,l),p&&(f.samples=p)},[p,f,a,l]),e.useEffect(()=>()=>f.dispose(),[]),f}const H=n=>typeof n=="function",j=e.forwardRef(({envMap:n,resolution:u=256,frames:c=1/0,children:t,makeDefault:s,...a},l)=>{const g=d(({set:r})=>r),p=d(({camera:r})=>r),m=d(({size:r})=>r),i=e.useRef(null);e.useImperativeHandle(l,()=>i.current,[]);const f=e.useRef(null),o=S(u);e.useLayoutEffect(()=>{a.manual||i.current.updateProjectionMatrix()},[m,a]),e.useLayoutEffect(()=>{i.current.updateProjectionMatrix()}),e.useLayoutEffect(()=>{if(s){const r=p;return g(()=>({camera:i.current})),()=>g(()=>({camera:r}))}},[i,s,g]);let E=0,y=null;const h=H(t);return F(r=>{h&&(c===1/0||E<c)&&(f.current.visible=!1,r.gl.setRenderTarget(o),y=r.scene.background,n&&(r.scene.background=n),r.gl.render(r.scene,i.current),r.scene.background=y,r.gl.setRenderTarget(null),f.current.visible=!0,E++)}),e.createElement(e.Fragment,null,e.createElement("orthographicCamera",v({left:m.width/-2,right:m.width/2,top:m.height/2,bottom:m.height/-2,ref:i},a),!h&&t),e.createElement("group",{ref:f},h&&t(o.texture)))});function z({defaultScene:n,defaultCamera:u,renderPriority:c=1}){const{gl:t,scene:s,camera:a}=d();let l;return F(()=>{l=t.autoClear,c===1&&(t.autoClear=!0,t.render(n,u)),t.autoClear=!1,t.clearDepth(),t.render(s,a),t.autoClear=l},c),e.createElement("group",{onPointerOver:()=>null})}function I({children:n,renderPriority:u=1}){const{scene:c,camera:t}=d(),[s]=e.useState(()=>new w);return e.createElement(e.Fragment,null,L(e.createElement(e.Fragment,null,n,e.createElement(z,{defaultScene:c,defaultCamera:t,renderPriority:u})),s,{events:{priority:u+1}}))}export{I as H,j as O,S as u};
