import{p as ba}from"./geo_-FU1-d8Ot.js";import{r as rt,j as He,u as So}from"./ssg-client-Dg7YBUPF.js";import{E as Sa,s as Ua}from"./index-C-9Gv-4J.js";import{U as ka,M as Ta,R as Ea,e as Aa,f as Ca,g as jr,F as Fa,a as ln,V as en,h as Ma,i as Ei,I as Da,j as Ra,B as La,k as Oa,D as Uo,l as Ga,m as Ai,n as Pa,o as Ia,p as Ba,c as Yr,P as Jr,q as Na,r as Wa,s as ko,t as za,_ as Va,C as Ha,O as Xa,u as ja,L as Ya,v as Ja,w as Ka}from"./OrbitControls-BaRFn3-G.js";import{G as qa,a as Qa}from"./GizmoViewport-CSqHPst1.js";function Za(){var t=Object.create(null);function e(r,n){var i=r.id,o=r.name,a=r.dependencies;a===void 0&&(a=[]);var f=r.init;f===void 0&&(f=function(){});var u=r.getTransferables;if(u===void 0&&(u=null),!t[i])try{a=a.map(function(h){return h&&h.isWorkerModule&&(e(h,function(d){if(d instanceof Error)throw d}),h=t[h.id].value),h}),f=l("<"+o+">.init",f),u&&(u=l("<"+o+">.getTransferables",u));var c=null;typeof f=="function"?c=f.apply(void 0,a):console.error("worker module init function failed to rehydrate"),t[i]={id:i,value:c,getTransferables:u},n(c)}catch(h){h&&h.noLog||console.error(h),n(h)}}function s(r,n){var i,o=r.id,a=r.args;(!t[o]||typeof t[o].value!="function")&&n(new Error("Worker module "+o+": not found or its 'init' did not return a function"));try{var f=(i=t[o]).value.apply(i,a);f&&typeof f.then=="function"?f.then(u,function(c){return n(c instanceof Error?c:new Error(""+c))}):u(f)}catch(c){n(c)}function u(c){try{var h=t[o].getTransferables&&t[o].getTransferables(c);(!h||!Array.isArray(h)||!h.length)&&(h=void 0),n(c,h)}catch(d){console.error(d),n(d)}}}function l(r,n){var i=void 0;self.troikaDefine=function(a){return i=a};var o=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+n+`
)`],{type:"application/javascript"}));try{importScripts(o)}catch(a){console.error(a)}return URL.revokeObjectURL(o),delete self.troikaDefine,i}self.addEventListener("message",function(r){var n=r.data,i=n.messageId,o=n.action,a=n.data;try{o==="registerModule"&&e(a,function(f){f instanceof Error?postMessage({messageId:i,success:!1,error:f.message}):postMessage({messageId:i,success:!0,result:{isCallable:typeof f=="function"}})}),o==="callModule"&&s(a,function(f,u){f instanceof Error?postMessage({messageId:i,success:!1,error:f.message}):postMessage({messageId:i,success:!0,result:f},u||void 0)})}catch(f){postMessage({messageId:i,success:!1,error:f.stack})}})}function $a(t){var e=function(){for(var s=[],l=arguments.length;l--;)s[l]=arguments[l];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,s);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var s=t.dependencies,l=t.init;s=Array.isArray(s)?s.map(function(n){return n&&n._getInitResult?n._getInitResult():n}):[];var r=Promise.all(s).then(function(n){return l.apply(null,n)});return e._getInitResult=function(){return r},r},e}var To=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(s){typeof process<"u",console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+s.message+"]")}return To=function(){return t},t},es=0,ts=0,wr=!1,Zt=Object.create(null),$t=Object.create(null),Cr=Object.create(null);function Lt(t){if((!t||typeof t.init!="function")&&!wr)throw new Error("requires `options.init` function");var e=t.dependencies,s=t.init,l=t.getTransferables,r=t.workerId;if(!To())return $a(t);r==null&&(r="#default");var n="workerModule"+ ++es,i=t.name||n,o=null;e=e&&e.map(function(f){return typeof f=="function"&&!f.workerModuleData&&(wr=!0,f=Lt({workerId:r,name:"<"+i+"> function dependency: "+f.name,init:`function(){return (
`+Ln(f)+`
)}`}),wr=!1),f&&f.workerModuleData&&(f=f.workerModuleData),f});function a(){for(var f=[],u=arguments.length;u--;)f[u]=arguments[u];if(!o){o=Ci(r,"registerModule",a.workerModuleData);var c=function(){o=null,$t[r].delete(c)};($t[r]||($t[r]=new Set)).add(c)}return o.then(function(h){var d=h.isCallable;if(d)return Ci(r,"callModule",{id:n,args:f});throw new Error("Worker module function was called but `init` did not return a callable function")})}return a.workerModuleData={isWorkerModule:!0,id:n,name:i,dependencies:e,init:Ln(s),getTransferables:l&&Ln(l)},a}function ns(t){$t[t]&&$t[t].forEach(function(e){e()}),Zt[t]&&(Zt[t].terminate(),delete Zt[t])}function Ln(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function rs(t){var e=Zt[t];if(!e){var s=Ln(Za);e=Zt[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+s+")()"],{type:"application/javascript"}))),e.onmessage=function(l){var r=l.data,n=r.messageId,i=Cr[n];if(!i)throw new Error("WorkerModule response with empty or unknown messageId");delete Cr[n],i(r)}}return e}function Ci(t,e,s){return new Promise(function(l,r){var n=++ts;Cr[n]=function(i){i.success?l(i.result):r(new Error("Error in worker "+e+" call: "+i.error))},rs(t).postMessage({messageId:n,action:e,data:s})})}function Eo(){var t=function(e){function s(B,P,m,T,M,L,F,V){var I=1-F;V.x=I*I*B+2*I*F*m+F*F*M,V.y=I*I*P+2*I*F*T+F*F*L}function l(B,P,m,T,M,L,F,V,I,z){var K=1-I;z.x=K*K*K*B+3*K*K*I*m+3*K*I*I*M+I*I*I*F,z.y=K*K*K*P+3*K*K*I*T+3*K*I*I*L+I*I*I*V}function r(B,P){for(var m=/([MLQCZ])([^MLQCZ]*)/g,T,M,L,F,V;T=m.exec(B);){var I=T[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(z){return parseFloat(z)});switch(T[1]){case"M":F=M=I[0],V=L=I[1];break;case"L":(I[0]!==F||I[1]!==V)&&P("L",F,V,F=I[0],V=I[1]);break;case"Q":{P("Q",F,V,F=I[2],V=I[3],I[0],I[1]);break}case"C":{P("C",F,V,F=I[4],V=I[5],I[0],I[1],I[2],I[3]);break}case"Z":(F!==M||V!==L)&&P("L",F,V,M,L);break}}}function n(B,P,m){m===void 0&&(m=16);var T={x:0,y:0};r(B,function(M,L,F,V,I,z,K,ee,Y){switch(M){case"L":P(L,F,V,I);break;case"Q":{for(var H=L,ve=F,ue=1;ue<m;ue++)s(L,F,z,K,V,I,ue/(m-1),T),P(H,ve,T.x,T.y),H=T.x,ve=T.y;break}case"C":{for(var Z=L,te=F,se=1;se<m;se++)l(L,F,z,K,ee,Y,V,I,se/(m-1),T),P(Z,te,T.x,T.y),Z=T.x,te=T.y;break}}})}var i="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",o="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",a=new WeakMap,f={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(B,P){var m=B.getContext?B.getContext("webgl",f):B,T=a.get(m);if(!T){let K=function(Z){var te=L[Z];if(!te&&(te=L[Z]=m.getExtension(Z),!te))throw new Error(Z+" not supported");return te},ee=function(Z,te){var se=m.createShader(te);return m.shaderSource(se,Z),m.compileShader(se),se},Y=function(Z,te,se,X){if(!F[Z]){var ne={},$={},W=m.createProgram();m.attachShader(W,ee(te,m.VERTEX_SHADER)),m.attachShader(W,ee(se,m.FRAGMENT_SHADER)),m.linkProgram(W),F[Z]={program:W,transaction:function(Q){m.useProgram(W),Q({setUniform:function(q,xe){for(var re=[],oe=arguments.length-2;oe-- >0;)re[oe]=arguments[oe+2];var le=$[xe]||($[xe]=m.getUniformLocation(W,xe));m["uniform"+q].apply(m,[le].concat(re))},setAttribute:function(q,xe,re,oe,le){var de=ne[q];de||(de=ne[q]={buf:m.createBuffer(),loc:m.getAttribLocation(W,q),data:null}),m.bindBuffer(m.ARRAY_BUFFER,de.buf),m.vertexAttribPointer(de.loc,xe,m.FLOAT,!1,0,0),m.enableVertexAttribArray(de.loc),M?m.vertexAttribDivisor(de.loc,oe):K("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(de.loc,oe),le!==de.data&&(m.bufferData(m.ARRAY_BUFFER,le,re),de.data=le)}})}}}F[Z].transaction(X)},H=function(Z,te){I++;try{m.activeTexture(m.TEXTURE0+I);var se=V[Z];se||(se=V[Z]=m.createTexture(),m.bindTexture(m.TEXTURE_2D,se),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.NEAREST),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.NEAREST)),m.bindTexture(m.TEXTURE_2D,se),te(se,I)}finally{I--}},ve=function(Z,te,se){var X=m.createFramebuffer();z.push(X),m.bindFramebuffer(m.FRAMEBUFFER,X),m.activeTexture(m.TEXTURE0+te),m.bindTexture(m.TEXTURE_2D,Z),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,Z,0);try{se(X)}finally{m.deleteFramebuffer(X),m.bindFramebuffer(m.FRAMEBUFFER,z[--z.length-1]||null)}},ue=function(){L={},F={},V={},I=-1,z.length=0};var M=typeof WebGL2RenderingContext<"u"&&m instanceof WebGL2RenderingContext,L={},F={},V={},I=-1,z=[];m.canvas.addEventListener("webglcontextlost",function(Z){ue(),Z.preventDefault()},!1),a.set(m,T={gl:m,isWebGL2:M,getExtension:K,withProgram:Y,withTexture:H,withTextureFramebuffer:ve,handleContextLoss:ue})}P(T)}function c(B,P,m,T,M,L,F,V){F===void 0&&(F=15),V===void 0&&(V=null),u(B,function(I){var z=I.gl,K=I.withProgram,ee=I.withTexture;ee("copy",function(Y,H){z.texImage2D(z.TEXTURE_2D,0,z.RGBA,M,L,0,z.RGBA,z.UNSIGNED_BYTE,P),K("copy",i,o,function(ve){var ue=ve.setUniform,Z=ve.setAttribute;Z("aUV",2,z.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),ue("1i","image",H),z.bindFramebuffer(z.FRAMEBUFFER,V||null),z.disable(z.BLEND),z.colorMask(F&8,F&4,F&2,F&1),z.viewport(m,T,M,L),z.scissor(m,T,M,L),z.drawArrays(z.TRIANGLES,0,3)})})})}function h(B,P,m){var T=B.width,M=B.height;u(B,function(L){var F=L.gl,V=new Uint8Array(T*M*4);F.readPixels(0,0,T,M,F.RGBA,F.UNSIGNED_BYTE,V),B.width=P,B.height=m,c(F,V,0,0,T,M)})}var d=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:c,resizeWebGLCanvasWithoutClearing:h});function p(B,P,m,T,M,L){L===void 0&&(L=1);var F=new Uint8Array(B*P),V=T[2]-T[0],I=T[3]-T[1],z=[];n(m,function(Z,te,se,X){z.push({x1:Z,y1:te,x2:se,y2:X,minX:Math.min(Z,se),minY:Math.min(te,X),maxX:Math.max(Z,se),maxY:Math.max(te,X)})}),z.sort(function(Z,te){return Z.maxX-te.maxX});for(var K=0;K<B;K++)for(var ee=0;ee<P;ee++){var Y=ve(T[0]+V*(K+.5)/B,T[1]+I*(ee+.5)/P),H=Math.pow(1-Math.abs(Y)/M,L)/2;Y<0&&(H=1-H),H=Math.max(0,Math.min(255,Math.round(H*255))),F[ee*B+K]=H}return F;function ve(Z,te){for(var se=1/0,X=1/0,ne=z.length;ne--;){var $=z[ne];if($.maxX+X<=Z)break;if(Z+X>$.minX&&te-X<$.maxY&&te+X>$.minY){var W=A(Z,te,$.x1,$.y1,$.x2,$.y2);W<se&&(se=W,X=Math.sqrt(se))}}return ue(Z,te)&&(X=-X),X}function ue(Z,te){for(var se=0,X=z.length;X--;){var ne=z[X];if(ne.maxX<=Z)break;var $=ne.y1>te!=ne.y2>te&&Z<(ne.x2-ne.x1)*(te-ne.y1)/(ne.y2-ne.y1)+ne.x1;$&&(se+=ne.y1<ne.y2?1:-1)}return se!==0}}function g(B,P,m,T,M,L,F,V,I,z){L===void 0&&(L=1),V===void 0&&(V=0),I===void 0&&(I=0),z===void 0&&(z=0),v(B,P,m,T,M,L,F,null,V,I,z)}function v(B,P,m,T,M,L,F,V,I,z,K){L===void 0&&(L=1),I===void 0&&(I=0),z===void 0&&(z=0),K===void 0&&(K=0);for(var ee=p(B,P,m,T,M,L),Y=new Uint8Array(ee.length*4),H=0;H<ee.length;H++)Y[H*4+K]=ee[H];c(F,Y,I,z,B,P,1<<3-K,V)}function A(B,P,m,T,M,L){var F=M-m,V=L-T,I=F*F+V*V,z=I?Math.max(0,Math.min(1,((B-m)*F+(P-T)*V)/I)):0,K=B-(m+z*F),ee=P-(T+z*V);return K*K+ee*ee}var _=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:g,generateIntoFramebuffer:v}),x="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",y="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",S="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",C=new Float32Array([0,0,2,0,0,2]),U=null,k=!1,O={},R=new WeakMap;function N(B){if(!k&&!b(B))throw new Error("WebGL generation not supported")}function w(B,P,m,T,M,L,F){if(L===void 0&&(L=1),F===void 0&&(F=null),!F&&(F=U,!F)){var V=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!V)throw new Error("OffscreenCanvas or DOM canvas not supported");F=U=V.getContext("webgl",{depth:!1})}N(F);var I=new Uint8Array(B*P*4);u(F,function(Y){var H=Y.gl,ve=Y.withTexture,ue=Y.withTextureFramebuffer;ve("readable",function(Z,te){H.texImage2D(H.TEXTURE_2D,0,H.RGBA,B,P,0,H.RGBA,H.UNSIGNED_BYTE,null),ue(Z,te,function(se){E(B,P,m,T,M,L,H,se,0,0,0),H.readPixels(0,0,B,P,H.RGBA,H.UNSIGNED_BYTE,I)})})});for(var z=new Uint8Array(B*P),K=0,ee=0;K<I.length;K+=4)z[ee++]=I[K];return z}function D(B,P,m,T,M,L,F,V,I,z){L===void 0&&(L=1),V===void 0&&(V=0),I===void 0&&(I=0),z===void 0&&(z=0),E(B,P,m,T,M,L,F,null,V,I,z)}function E(B,P,m,T,M,L,F,V,I,z,K){L===void 0&&(L=1),I===void 0&&(I=0),z===void 0&&(z=0),K===void 0&&(K=0),N(F);var ee=[];n(m,function(Y,H,ve,ue){ee.push(Y,H,ve,ue)}),ee=new Float32Array(ee),u(F,function(Y){var H=Y.gl,ve=Y.isWebGL2,ue=Y.getExtension,Z=Y.withProgram,te=Y.withTexture,se=Y.withTextureFramebuffer,X=Y.handleContextLoss;if(te("rawDistances",function(ne,$){(B!==ne._lastWidth||P!==ne._lastHeight)&&H.texImage2D(H.TEXTURE_2D,0,H.RGBA,ne._lastWidth=B,ne._lastHeight=P,0,H.RGBA,H.UNSIGNED_BYTE,null),Z("main",x,y,function(W){var he=W.setAttribute,Q=W.setUniform,ie=!ve&&ue("ANGLE_instanced_arrays"),q=!ve&&ue("EXT_blend_minmax");he("aUV",2,H.STATIC_DRAW,0,C),he("aLineSegment",4,H.DYNAMIC_DRAW,1,ee),Q.apply(void 0,["4f","uGlyphBounds"].concat(T)),Q("1f","uMaxDistance",M),Q("1f","uExponent",L),se(ne,$,function(xe){H.enable(H.BLEND),H.colorMask(!0,!0,!0,!0),H.viewport(0,0,B,P),H.scissor(0,0,B,P),H.blendFunc(H.ONE,H.ONE),H.blendEquationSeparate(H.FUNC_ADD,ve?H.MAX:q.MAX_EXT),H.clear(H.COLOR_BUFFER_BIT),ve?H.drawArraysInstanced(H.TRIANGLES,0,3,ee.length/4):ie.drawArraysInstancedANGLE(H.TRIANGLES,0,3,ee.length/4)})}),Z("post",i,S,function(W){W.setAttribute("aUV",2,H.STATIC_DRAW,0,C),W.setUniform("1i","tex",$),H.bindFramebuffer(H.FRAMEBUFFER,V),H.disable(H.BLEND),H.colorMask(K===0,K===1,K===2,K===3),H.viewport(I,z,B,P),H.scissor(I,z,B,P),H.drawArrays(H.TRIANGLES,0,3)})}),H.isContextLost())throw X(),new Error("webgl context lost")})}function b(B){var P=!B||B===U?O:B.canvas||B,m=R.get(P);if(m===void 0){k=!0;var T=null;try{var M=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],L=w(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,B);m=L&&M.length===L.length&&L.every(function(F,V){return F===M[V]}),m||(T="bad trial run results",console.info(M,L))}catch(F){m=!1,T=F.message}T&&console.warn("WebGL SDF generation not supported:",T),k=!1,R.set(P,m)}return m}var G=Object.freeze({__proto__:null,generate:w,generateIntoCanvas:D,generateIntoFramebuffer:E,isSupported:b});function j(B,P,m,T,M,L){M===void 0&&(M=Math.max(T[2]-T[0],T[3]-T[1])/2),L===void 0&&(L=1);try{return w.apply(G,arguments)}catch(F){return console.info("WebGL SDF generation failed, falling back to JS",F),p.apply(_,arguments)}}function J(B,P,m,T,M,L,F,V,I,z){M===void 0&&(M=Math.max(T[2]-T[0],T[3]-T[1])/2),L===void 0&&(L=1),V===void 0&&(V=0),I===void 0&&(I=0),z===void 0&&(z=0);try{return D.apply(G,arguments)}catch(K){return console.info("WebGL SDF generation failed, falling back to JS",K),g.apply(_,arguments)}}return e.forEachPathCommand=r,e.generate=j,e.generateIntoCanvas=J,e.javascript=_,e.pathToLineSegments=n,e.webgl=G,e.webglUtils=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function is(){var t=function(e){var s={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},l={},r={};l.L=1,r[1]="L",Object.keys(s).forEach(function(X,ne){l[X]=1<<ne+1,r[l[X]]=X}),Object.freeze(l);var n=l.LRI|l.RLI|l.FSI,i=l.L|l.R|l.AL,o=l.B|l.S|l.WS|l.ON|l.FSI|l.LRI|l.RLI|l.PDI,a=l.BN|l.RLE|l.LRE|l.RLO|l.LRO|l.PDF,f=l.S|l.WS|l.B|n|l.PDI|a,u=null;function c(){if(!u){u=new Map;var X=function($){if(s.hasOwnProperty($)){var W=0;s[$].split(",").forEach(function(he){var Q=he.split("+"),ie=Q[0],q=Q[1];ie=parseInt(ie,36),q=q?parseInt(q,36):0,u.set(W+=ie,l[$]);for(var xe=0;xe<q;xe++)u.set(++W,l[$])})}};for(var ne in s)X(ne)}}function h(X){return c(),u.get(X.codePointAt(0))||l.L}function d(X){return r[h(X)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(X,ne){var $=36,W=0,he=new Map,Q=ne&&new Map,ie;return X.split(",").forEach(function q(xe){if(xe.indexOf("+")!==-1)for(var re=+xe;re--;)q(ie);else{ie=xe;var oe=xe.split(">"),le=oe[0],de=oe[1];le=String.fromCodePoint(W+=parseInt(le,$)),de=String.fromCodePoint(W+=parseInt(de,$)),he.set(le,de),ne&&Q.set(de,le)}}),{map:he,reverseMap:Q}}var v,A,_;function x(){if(!v){var X=g(p.pairs,!0),ne=X.map,$=X.reverseMap;v=ne,A=$,_=g(p.canonical,!1).map}}function y(X){return x(),v.get(X)||null}function S(X){return x(),A.get(X)||null}function C(X){return x(),_.get(X)||null}var U=l.L,k=l.R,O=l.EN,R=l.ES,N=l.ET,w=l.AN,D=l.CS,E=l.B,b=l.S,G=l.ON,j=l.BN,J=l.NSM,B=l.AL,P=l.LRO,m=l.RLO,T=l.LRE,M=l.RLE,L=l.PDF,F=l.LRI,V=l.RLI,I=l.FSI,z=l.PDI;function K(X,ne){for(var $=125,W=new Uint32Array(X.length),he=0;he<X.length;he++)W[he]=h(X[he]);var Q=new Map;function ie(ze,Ze){var Ve=W[ze];W[ze]=Ze,Q.set(Ve,Q.get(Ve)-1),Ve&o&&Q.set(o,Q.get(o)-1),Q.set(Ze,(Q.get(Ze)||0)+1),Ze&o&&Q.set(o,(Q.get(o)||0)+1)}for(var q=new Uint8Array(X.length),xe=new Map,re=[],oe=null,le=0;le<X.length;le++)oe||re.push(oe={start:le,end:X.length-1,level:ne==="rtl"?1:ne==="ltr"?0:ki(le,!1)}),W[le]&E&&(oe.end=le,oe=null);for(var de=M|T|m|P|n|z|L|E,Se=function(ze){return ze+(ze&1?1:2)},Ce=function(ze){return ze+(ze&1?2:1)},ge=0;ge<re.length;ge++){oe=re[ge];var me=[{_level:oe.level,_override:0,_isolate:0}],fe=void 0,Fe=0,Te=0,We=0;Q.clear();for(var Ue=oe.start;Ue<=oe.end;Ue++){var ce=W[Ue];if(fe=me[me.length-1],Q.set(ce,(Q.get(ce)||0)+1),ce&o&&Q.set(o,(Q.get(o)||0)+1),ce&de)if(ce&(M|T)){q[Ue]=fe._level;var we=(ce===M?Ce:Se)(fe._level);we<=$&&!Fe&&!Te?me.push({_level:we,_override:0,_isolate:0}):Fe||Te++}else if(ce&(m|P)){q[Ue]=fe._level;var ut=(ce===m?Ce:Se)(fe._level);ut<=$&&!Fe&&!Te?me.push({_level:ut,_override:ce&m?k:U,_isolate:0}):Fe||Te++}else if(ce&n){ce&I&&(ce=ki(Ue+1,!0)===1?V:F),q[Ue]=fe._level,fe._override&&ie(Ue,fe._override);var be=(ce===V?Ce:Se)(fe._level);be<=$&&Fe===0&&Te===0?(We++,me.push({_level:be,_override:0,_isolate:1,_isolInitIndex:Ue})):Fe++}else if(ce&z){if(Fe>0)Fe--;else if(We>0){for(Te=0;!me[me.length-1]._isolate;)me.pop();var ye=me[me.length-1]._isolInitIndex;ye!=null&&(xe.set(ye,Ue),xe.set(Ue,ye)),me.pop(),We--}fe=me[me.length-1],q[Ue]=fe._level,fe._override&&ie(Ue,fe._override)}else ce&L?(Fe===0&&(Te>0?Te--:!fe._isolate&&me.length>1&&(me.pop(),fe=me[me.length-1])),q[Ue]=fe._level):ce&E&&(q[Ue]=oe.level);else q[Ue]=fe._level,fe._override&&ce!==j&&ie(Ue,fe._override)}for(var Le=[],Ee=null,pe=oe.start;pe<=oe.end;pe++){var Ae=W[pe];if(!(Ae&a)){var Be=q[pe],Ie=Ae&n,Ge=Ae===z;Ee&&Be===Ee._level?(Ee._end=pe,Ee._endsWithIsolInit=Ie):Le.push(Ee={_start:pe,_end:pe,_level:Be,_startsWithPDI:Ge,_endsWithIsolInit:Ie})}}for(var qe=[],ct=0;ct<Le.length;ct++){var at=Le[ct];if(!at._startsWithPDI||at._startsWithPDI&&!xe.has(at._start)){for(var ht=[Ee=at],gt=void 0;Ee&&Ee._endsWithIsolInit&&(gt=xe.get(Ee._end))!=null;)for(var st=ct+1;st<Le.length;st++)if(Le[st]._start===gt){ht.push(Ee=Le[st]);break}for(var Ne=[],mt=0;mt<ht.length;mt++)for(var oi=ht[mt],tr=oi._start;tr<=oi._end;tr++)Ne.push(tr);for(var ga=q[Ne[0]],ai=oe.level,hn=Ne[0]-1;hn>=0;hn--)if(!(W[hn]&a)){ai=q[hn];break}var nr=Ne[Ne.length-1],ma=q[nr],si=oe.level;if(!(W[nr]&n)){for(var dn=nr+1;dn<=oe.end;dn++)if(!(W[dn]&a)){si=q[dn];break}}qe.push({_seqIndices:Ne,_sosType:Math.max(ai,ga)%2?k:U,_eosType:Math.max(si,ma)%2?k:U})}}for(var rr=0;rr<qe.length;rr++){var ir=qe[rr],ae=ir._seqIndices,Ot=ir._sosType,ya=ir._eosType,St=q[ae[0]]&1?k:U;if(Q.get(J))for(var pn=0;pn<ae.length;pn++){var fi=ae[pn];if(W[fi]&J){for(var or=Ot,vn=pn-1;vn>=0;vn--)if(!(W[ae[vn]]&a)){or=W[ae[vn]];break}ie(fi,or&(n|z)?G:or)}}if(Q.get(O))for(var gn=0;gn<ae.length;gn++){var li=ae[gn];if(W[li]&O)for(var mn=gn-1;mn>=-1;mn--){var ui=mn===-1?Ot:W[ae[mn]];if(ui&i){ui===B&&ie(li,w);break}}}if(Q.get(B))for(var ar=0;ar<ae.length;ar++){var ci=ae[ar];W[ci]&B&&ie(ci,k)}if(Q.get(R)||Q.get(D))for(var Gt=1;Gt<ae.length-1;Gt++){var sr=ae[Gt];if(W[sr]&(R|D)){for(var Ut=0,fr=0,lr=Gt-1;lr>=0&&(Ut=W[ae[lr]],!!(Ut&a));lr--);for(var ur=Gt+1;ur<ae.length&&(fr=W[ae[ur]],!!(fr&a));ur++);Ut===fr&&(W[sr]===R?Ut===O:Ut&(O|w))&&ie(sr,Ut)}}if(Q.get(O))for(var nt=0;nt<ae.length;nt++){var _a=ae[nt];if(W[_a]&O){for(var yn=nt-1;yn>=0&&W[ae[yn]]&(N|a);yn--)ie(ae[yn],O);for(nt++;nt<ae.length&&W[ae[nt]]&(N|a|O);nt++)W[ae[nt]]!==O&&ie(ae[nt],O)}}if(Q.get(N)||Q.get(R)||Q.get(D))for(var Pt=0;Pt<ae.length;Pt++){var hi=ae[Pt];if(W[hi]&(N|R|D)){ie(hi,G);for(var _n=Pt-1;_n>=0&&W[ae[_n]]&a;_n--)ie(ae[_n],G);for(var xn=Pt+1;xn<ae.length&&W[ae[xn]]&a;xn++)ie(ae[xn],G)}}if(Q.get(O))for(var cr=0,di=Ot;cr<ae.length;cr++){var pi=ae[cr],hr=W[pi];hr&O?di===U&&ie(pi,U):hr&i&&(di=hr)}if(Q.get(o)){var It=k|O|w,vi=It|U,wn=[];{for(var kt=[],Tt=0;Tt<ae.length;Tt++)if(W[ae[Tt]]&o){var Bt=X[ae[Tt]],gi=void 0;if(y(Bt)!==null)if(kt.length<63)kt.push({char:Bt,seqIndex:Tt});else break;else if((gi=S(Bt))!==null)for(var Nt=kt.length-1;Nt>=0;Nt--){var dr=kt[Nt].char;if(dr===gi||dr===S(C(Bt))||y(C(dr))===Bt){wn.push([kt[Nt].seqIndex,Tt]),kt.length=Nt;break}}}wn.sort(function(ze,Ze){return ze[0]-Ze[0]})}for(var pr=0;pr<wn.length;pr++){for(var mi=wn[pr],bn=mi[0],vr=mi[1],yi=!1,Qe=0,gr=bn+1;gr<vr;gr++){var _i=ae[gr];if(W[_i]&vi){yi=!0;var xi=W[_i]&It?k:U;if(xi===St){Qe=xi;break}}}if(yi&&!Qe){Qe=Ot;for(var mr=bn-1;mr>=0;mr--){var wi=ae[mr];if(W[wi]&vi){var bi=W[wi]&It?k:U;bi!==St?Qe=bi:Qe=St;break}}}if(Qe){if(W[ae[bn]]=W[ae[vr]]=Qe,Qe!==St){for(var Wt=bn+1;Wt<ae.length;Wt++)if(!(W[ae[Wt]]&a)){h(X[ae[Wt]])&J&&(W[ae[Wt]]=Qe);break}}if(Qe!==St){for(var zt=vr+1;zt<ae.length;zt++)if(!(W[ae[zt]]&a)){h(X[ae[zt]])&J&&(W[ae[zt]]=Qe);break}}}}for(var dt=0;dt<ae.length;dt++)if(W[ae[dt]]&o){for(var Si=dt,yr=dt,_r=Ot,Vt=dt-1;Vt>=0;Vt--)if(W[ae[Vt]]&a)Si=Vt;else{_r=W[ae[Vt]]&It?k:U;break}for(var Ui=ya,Ht=dt+1;Ht<ae.length;Ht++)if(W[ae[Ht]]&(o|a))yr=Ht;else{Ui=W[ae[Ht]]&It?k:U;break}for(var xr=Si;xr<=yr;xr++)W[ae[xr]]=_r===Ui?_r:St;dt=yr}}}for(var Ye=oe.start;Ye<=oe.end;Ye++){var xa=q[Ye],Sn=W[Ye];if(xa&1?Sn&(U|O|w)&&q[Ye]++:Sn&k?q[Ye]++:Sn&(w|O)&&(q[Ye]+=2),Sn&a&&(q[Ye]=Ye===0?oe.level:q[Ye-1]),Ye===oe.end||h(X[Ye])&(b|E))for(var Un=Ye;Un>=0&&h(X[Un])&f;Un--)q[Un]=oe.level}}return{levels:q,paragraphs:re};function ki(ze,Ze){for(var Ve=ze;Ve<X.length;Ve++){var pt=W[Ve];if(pt&(k|B))return 1;if(pt&(E|U)||Ze&&pt===z)return 0;if(pt&n){var Ti=wa(Ve);Ve=Ti===-1?X.length:Ti}}return 0}function wa(ze){for(var Ze=1,Ve=ze+1;Ve<X.length;Ve++){var pt=W[Ve];if(pt&E)break;if(pt&z){if(--Ze===0)return Ve}else pt&n&&Ze++}return-1}}var ee="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",Y;function H(){if(!Y){var X=g(ee,!0),ne=X.map,$=X.reverseMap;$.forEach(function(W,he){ne.set(he,W)}),Y=ne}}function ve(X){return H(),Y.get(X)||null}function ue(X,ne,$,W){var he=X.length;$=Math.max(0,$==null?0:+$),W=Math.min(he-1,W==null?he-1:+W);for(var Q=new Map,ie=$;ie<=W;ie++)if(ne[ie]&1){var q=ve(X[ie]);q!==null&&Q.set(ie,q)}return Q}function Z(X,ne,$,W){var he=X.length;$=Math.max(0,$==null?0:+$),W=Math.min(he-1,W==null?he-1:+W);var Q=[];return ne.paragraphs.forEach(function(ie){var q=Math.max($,ie.start),xe=Math.min(W,ie.end);if(q<xe){for(var re=ne.levels.slice(q,xe+1),oe=xe;oe>=q&&h(X[oe])&f;oe--)re[oe]=ie.level;for(var le=ie.level,de=1/0,Se=0;Se<re.length;Se++){var Ce=re[Se];Ce>le&&(le=Ce),Ce<de&&(de=Ce|1)}for(var ge=le;ge>=de;ge--)for(var me=0;me<re.length;me++)if(re[me]>=ge){for(var fe=me;me+1<re.length&&re[me+1]>=ge;)me++;me>fe&&Q.push([fe+q,me+q])}}}),Q}function te(X,ne,$,W){var he=se(X,ne,$,W),Q=[].concat(X);return he.forEach(function(ie,q){Q[q]=(ne.levels[ie]&1?ve(X[ie]):null)||X[ie]}),Q.join("")}function se(X,ne,$,W){for(var he=Z(X,ne,$,W),Q=[],ie=0;ie<X.length;ie++)Q[ie]=ie;return he.forEach(function(q){for(var xe=q[0],re=q[1],oe=Q.slice(xe,re+1),le=oe.length;le--;)Q[re-le]=oe[le]}),Q}return e.closingToOpeningBracket=S,e.getBidiCharType=h,e.getBidiCharTypeName=d,e.getCanonicalBracket=C,e.getEmbeddingLevels=K,e.getMirroredCharacter=ve,e.getMirroredCharactersMap=ue,e.getReorderSegments=Z,e.getReorderedIndices=se,e.getReorderedString=te,e.openingToClosingBracket=y,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const Ao=/\bvoid\s+main\s*\(\s*\)\s*{/g;function Fr(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function s(l,r){let n=Ca[r];return n?Fr(n):l}return t.replace(e,s)}const Pe=[];for(let t=0;t<256;t++)Pe[t]=(t<16?"0":"")+t.toString(16);function os(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,s=Math.random()*4294967295|0,l=Math.random()*4294967295|0;return(Pe[t&255]+Pe[t>>8&255]+Pe[t>>16&255]+Pe[t>>24&255]+"-"+Pe[e&255]+Pe[e>>8&255]+"-"+Pe[e>>16&15|64]+Pe[e>>24&255]+"-"+Pe[s&63|128]+Pe[s>>8&255]+"-"+Pe[s>>16&255]+Pe[s>>24&255]+Pe[l&255]+Pe[l>>8&255]+Pe[l>>16&255]+Pe[l>>24&255]).toUpperCase()}const yt=Object.assign||function(){let t=arguments[0];for(let e=1,s=arguments.length;e<s;e++){let l=arguments[e];if(l)for(let r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r])}return t},as=Date.now(),Fi=new WeakMap,Mi=new Map;let ss=1e10;function Mr(t,e){const s=cs(e);let l=Fi.get(t);if(l||Fi.set(t,l=Object.create(null)),l[s])return new l[s];const r=`_onBeforeCompile${s}`,n=function(f,u){t.onBeforeCompile.call(this,f,u);const c=this.customProgramCacheKey()+"|"+f.vertexShader+"|"+f.fragmentShader;let h=Mi[c];if(!h){const d=fs(this,f,e,s);h=Mi[c]=d}f.vertexShader=h.vertexShader,f.fragmentShader=h.fragmentShader,yt(f.uniforms,this.uniforms),e.timeUniform&&(f.uniforms[e.timeUniform]={get value(){return Date.now()-as}}),this[r]&&this[r](f)},i=function(){return o(e.chained?t:t.clone())},o=function(f){const u=Object.create(f,a);return Object.defineProperty(u,"baseMaterial",{value:t}),Object.defineProperty(u,"id",{value:ss++}),u.uuid=os(),u.uniforms=yt({},f.uniforms,e.uniforms),u.defines=yt({},f.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${s}`]="",u.extensions=yt({},f.extensions,e.extensions),u._listeners=void 0,u},a={constructor:{value:i},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+s}},onBeforeCompile:{get(){return n},set(f){this[r]=f}},copy:{writable:!0,configurable:!0,value:function(f){return t.copy.call(this,f),!t.isShaderMaterial&&!t.isDerivedMaterial&&(yt(this.extensions,f.extensions),yt(this.defines,f.defines),yt(this.uniforms,ka.clone(f.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const f=new t.constructor;return o(f).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let f=this._depthMaterial;return f||(f=this._depthMaterial=Mr(t.isDerivedMaterial?t.getDepthMaterial():new Ta({depthPacking:Ea}),e),f.defines.IS_DEPTH_MATERIAL="",f.uniforms=this.uniforms),f}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let f=this._distanceMaterial;return f||(f=this._distanceMaterial=Mr(t.isDerivedMaterial?t.getDistanceMaterial():new Aa,e),f.defines.IS_DISTANCE_MATERIAL="",f.uniforms=this.uniforms),f}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:f,_distanceMaterial:u}=this;f&&f.dispose(),u&&u.dispose(),t.dispose.call(this)}}};return l[s]=i,new i}function fs(t,{vertexShader:e,fragmentShader:s},l,r){let{vertexDefs:n,vertexMainIntro:i,vertexMainOutro:o,vertexTransform:a,fragmentDefs:f,fragmentMainIntro:u,fragmentMainOutro:c,fragmentColorTransform:h,customRewriter:d,timeUniform:p}=l;if(n=n||"",i=i||"",o=o||"",f=f||"",u=u||"",c=c||"",(a||d)&&(e=Fr(e)),(h||d)&&(s=s.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),s=Fr(s)),d){let g=d({vertexShader:e,fragmentShader:s});e=g.vertexShader,s=g.fragmentShader}if(h){let g=[];s=s.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,v=>(g.push(v),"")),c=`${h}
${g.join(`
`)}
${c}`}if(p){const g=`
uniform float ${p};
`;n=g+n,f=g+f}return a&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,n=`${n}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${a}
}
`,i=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${i}
`,e=e.replace(/\b(position|normal|uv)\b/g,(g,v,A,_)=>/\battribute\s+vec[23]\s+$/.test(_.substr(0,A))?v:`troika_${v}_${r}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=Di(e,r,n,i,o),s=Di(s,r,f,u,c),{vertexShader:e,fragmentShader:s}}function Di(t,e,s,l,r){return(l||r||s)&&(t=t.replace(Ao,`
${s}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${l}
  troikaOrigMain${e}();
  ${r}
}`),t}function ls(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let us=0;const Ri=new Map;function cs(t){const e=JSON.stringify(t,ls);let s=Ri.get(e);return s==null&&Ri.set(e,s=++us),s}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function hs(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(r){var n=e._bin,i=new Uint8Array(r);if(n.readASCII(i,0,4)=="ttcf"){var o=4;n.readUshort(i,o),o+=2,n.readUshort(i,o),o+=2;var a=n.readUint(i,o);o+=4;for(var f=[],u=0;u<a;u++){var c=n.readUint(i,o);o+=4,f.push(e._readFont(i,c))}return f}return[e._readFont(i,0)]},_readFont:function(r,n){var i=e._bin,o=n;i.readFixed(r,n),n+=4;var a=i.readUshort(r,n);n+=2,i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2;for(var f=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:r,_offset:o},c={},h=0;h<a;h++){var d=i.readASCII(r,n,4);n+=4,i.readUint(r,n),n+=4;var p=i.readUint(r,n);n+=4;var g=i.readUint(r,n);n+=4,c[d]={offset:p,length:g}}for(h=0;h<f.length;h++){var v=f[h];c[v]&&(u[v.trim()]=e[v.trim()].parse(r,c[v].offset,c[v].length,u))}return u},_tabOffset:function(r,n,i){for(var o=e._bin,a=o.readUshort(r,i+4),f=i+12,u=0;u<a;u++){var c=o.readASCII(r,f,4);f+=4,o.readUint(r,f),f+=4;var h=o.readUint(r,f);if(f+=4,o.readUint(r,f),f+=4,c==n)return h}return 0}};e._bin={readFixed:function(r,n){return(r[n]<<8|r[n+1])+(r[n+2]<<8|r[n+3])/65540},readF2dot14:function(r,n){return e._bin.readShort(r,n)/16384},readInt:function(r,n){return e._bin._view(r).getInt32(n)},readInt8:function(r,n){return e._bin._view(r).getInt8(n)},readShort:function(r,n){return e._bin._view(r).getInt16(n)},readUshort:function(r,n){return e._bin._view(r).getUint16(n)},readUshorts:function(r,n,i){for(var o=[],a=0;a<i;a++)o.push(e._bin.readUshort(r,n+2*a));return o},readUint:function(r,n){return e._bin._view(r).getUint32(n)},readUint64:function(r,n){return 4294967296*e._bin.readUint(r,n)+e._bin.readUint(r,n+4)},readASCII:function(r,n,i){for(var o="",a=0;a<i;a++)o+=String.fromCharCode(r[n+a]);return o},readUnicode:function(r,n,i){for(var o="",a=0;a<i;a++){var f=r[n++]<<8|r[n++];o+=String.fromCharCode(f)}return o},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,n,i){var o=e._bin._tdec;return o&&n==0&&i==r.length?o.decode(r):e._bin.readASCII(r,n,i)},readBytes:function(r,n,i){for(var o=[],a=0;a<i;a++)o.push(r[n+a]);return o},readASCIIArray:function(r,n,i){for(var o=[],a=0;a<i;a++)o.push(String.fromCharCode(r[n+a]));return o},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,n,i,o,a){var f=e._bin,u={},c=n;f.readFixed(r,n),n+=4;var h=f.readUshort(r,n);n+=2;var d=f.readUshort(r,n);n+=2;var p=f.readUshort(r,n);return n+=2,u.scriptList=e._lctf.readScriptList(r,c+h),u.featureList=e._lctf.readFeatureList(r,c+d),u.lookupList=e._lctf.readLookupList(r,c+p,a),u},e._lctf.readLookupList=function(r,n,i){var o=e._bin,a=n,f=[],u=o.readUshort(r,n);n+=2;for(var c=0;c<u;c++){var h=o.readUshort(r,n);n+=2;var d=e._lctf.readLookupTable(r,a+h,i);f.push(d)}return f},e._lctf.readLookupTable=function(r,n,i){var o=e._bin,a=n,f={tabs:[]};f.ltype=o.readUshort(r,n),n+=2,f.flag=o.readUshort(r,n),n+=2;var u=o.readUshort(r,n);n+=2;for(var c=f.ltype,h=0;h<u;h++){var d=o.readUshort(r,n);n+=2;var p=i(r,c,a+d,f);f.tabs.push(p)}return f},e._lctf.numOfOnes=function(r){for(var n=0,i=0;i<32;i++)r>>>i&1&&n++;return n},e._lctf.readClassDef=function(r,n){var i=e._bin,o=[],a=i.readUshort(r,n);if(n+=2,a==1){var f=i.readUshort(r,n);n+=2;var u=i.readUshort(r,n);n+=2;for(var c=0;c<u;c++)o.push(f+c),o.push(f+c),o.push(i.readUshort(r,n)),n+=2}if(a==2){var h=i.readUshort(r,n);for(n+=2,c=0;c<h;c++)o.push(i.readUshort(r,n)),n+=2,o.push(i.readUshort(r,n)),n+=2,o.push(i.readUshort(r,n)),n+=2}return o},e._lctf.getInterval=function(r,n){for(var i=0;i<r.length;i+=3){var o=r[i],a=r[i+1];if(r[i+2],o<=n&&n<=a)return i}return-1},e._lctf.readCoverage=function(r,n){var i=e._bin,o={};o.fmt=i.readUshort(r,n),n+=2;var a=i.readUshort(r,n);return n+=2,o.fmt==1&&(o.tab=i.readUshorts(r,n,a)),o.fmt==2&&(o.tab=i.readUshorts(r,n,3*a)),o},e._lctf.coverageIndex=function(r,n){var i=r.tab;if(r.fmt==1)return i.indexOf(n);if(r.fmt==2){var o=e._lctf.getInterval(i,n);if(o!=-1)return i[o+2]+(n-i[o])}return-1},e._lctf.readFeatureList=function(r,n){var i=e._bin,o=n,a=[],f=i.readUshort(r,n);n+=2;for(var u=0;u<f;u++){var c=i.readASCII(r,n,4);n+=4;var h=i.readUshort(r,n);n+=2;var d=e._lctf.readFeatureTable(r,o+h);d.tag=c.trim(),a.push(d)}return a},e._lctf.readFeatureTable=function(r,n){var i=e._bin,o=n,a={},f=i.readUshort(r,n);n+=2,f>0&&(a.featureParams=o+f);var u=i.readUshort(r,n);n+=2,a.tab=[];for(var c=0;c<u;c++)a.tab.push(i.readUshort(r,n+2*c));return a},e._lctf.readScriptList=function(r,n){var i=e._bin,o=n,a={},f=i.readUshort(r,n);n+=2;for(var u=0;u<f;u++){var c=i.readASCII(r,n,4);n+=4;var h=i.readUshort(r,n);n+=2,a[c.trim()]=e._lctf.readScriptTable(r,o+h)}return a},e._lctf.readScriptTable=function(r,n){var i=e._bin,o=n,a={},f=i.readUshort(r,n);n+=2,f>0&&(a.default=e._lctf.readLangSysTable(r,o+f));var u=i.readUshort(r,n);n+=2;for(var c=0;c<u;c++){var h=i.readASCII(r,n,4);n+=4;var d=i.readUshort(r,n);n+=2,a[h.trim()]=e._lctf.readLangSysTable(r,o+d)}return a},e._lctf.readLangSysTable=function(r,n){var i=e._bin,o={};i.readUshort(r,n),n+=2,o.reqFeature=i.readUshort(r,n),n+=2;var a=i.readUshort(r,n);return n+=2,o.features=i.readUshorts(r,n,a),o},e.CFF={},e.CFF.parse=function(r,n,i){var o=e._bin;(r=new Uint8Array(r.buffer,n,i))[n=0],r[++n],r[++n],r[++n],n++;var a=[];n=e.CFF.readIndex(r,n,a);for(var f=[],u=0;u<a.length-1;u++)f.push(o.readASCII(r,n+a[u],a[u+1]-a[u]));n+=a[a.length-1];var c=[];n=e.CFF.readIndex(r,n,c);var h=[];for(u=0;u<c.length-1;u++)h.push(e.CFF.readDict(r,n+c[u],n+c[u+1]));n+=c[c.length-1];var d=h[0],p=[];n=e.CFF.readIndex(r,n,p);var g=[];for(u=0;u<p.length-1;u++)g.push(o.readASCII(r,n+p[u],p[u+1]-p[u]));if(n+=p[p.length-1],e.CFF.readSubrs(r,n,d),d.CharStrings){n=d.CharStrings,p=[],n=e.CFF.readIndex(r,n,p);var v=[];for(u=0;u<p.length-1;u++)v.push(o.readBytes(r,n+p[u],p[u+1]-p[u]));d.CharStrings=v}if(d.ROS){n=d.FDArray;var A=[];for(n=e.CFF.readIndex(r,n,A),d.FDArray=[],u=0;u<A.length-1;u++){var _=e.CFF.readDict(r,n+A[u],n+A[u+1]);e.CFF._readFDict(r,_,g),d.FDArray.push(_)}n+=A[A.length-1],n=d.FDSelect,d.FDSelect=[];var x=r[n];if(n++,x!=3)throw x;var y=o.readUshort(r,n);for(n+=2,u=0;u<y+1;u++)d.FDSelect.push(o.readUshort(r,n),r[n+2]),n+=3}return d.Encoding&&(d.Encoding=e.CFF.readEncoding(r,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=e.CFF.readCharset(r,d.charset,d.CharStrings.length)),e.CFF._readFDict(r,d,g),d},e.CFF._readFDict=function(r,n,i){var o;for(var a in n.Private&&(o=n.Private[1],n.Private=e.CFF.readDict(r,o,o+n.Private[0]),n.Private.Subrs&&e.CFF.readSubrs(r,o+n.Private.Subrs,n.Private)),n)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(a)!=-1&&(n[a]=i[n[a]-426+35])},e.CFF.readSubrs=function(r,n,i){var o=e._bin,a=[];n=e.CFF.readIndex(r,n,a);var f,u=a.length;f=u<1240?107:u<33900?1131:32768,i.Bias=f,i.Subrs=[];for(var c=0;c<a.length-1;c++)i.Subrs.push(o.readBytes(r,n+a[c],a[c+1]-a[c]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,n){for(var i=0;i<r.charset.length;i++)if(r.charset[i]==n)return i;return-1},e.CFF.glyphBySE=function(r,n){return n<0||n>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[n])},e.CFF.readEncoding=function(r,n,i){e._bin;var o=[".notdef"],a=r[n];if(n++,a!=0)throw"error: unknown encoding format: "+a;var f=r[n];n++;for(var u=0;u<f;u++)o.push(r[n+u]);return o},e.CFF.readCharset=function(r,n,i){var o=e._bin,a=[".notdef"],f=r[n];if(n++,f==0)for(var u=0;u<i;u++){var c=o.readUshort(r,n);n+=2,a.push(c)}else{if(f!=1&&f!=2)throw"error: format: "+f;for(;a.length<i;){c=o.readUshort(r,n),n+=2;var h=0;for(f==1?(h=r[n],n++):(h=o.readUshort(r,n),n+=2),u=0;u<=h;u++)a.push(c),c++}}return a},e.CFF.readIndex=function(r,n,i){var o=e._bin,a=o.readUshort(r,n)+1,f=r[n+=2];if(n++,f==1)for(var u=0;u<a;u++)i.push(r[n+u]);else if(f==2)for(u=0;u<a;u++)i.push(o.readUshort(r,n+2*u));else if(f==3)for(u=0;u<a;u++)i.push(16777215&o.readUint(r,n+3*u-1));else if(a!=1)throw"unsupported offset size: "+f+", count: "+a;return(n+=a*f)-1},e.CFF.getCharString=function(r,n,i){var o=e._bin,a=r[n],f=r[n+1];r[n+2],r[n+3],r[n+4];var u=1,c=null,h=null;a<=20&&(c=a,u=1),a==12&&(c=100*a+f,u=2),21<=a&&a<=27&&(c=a,u=1),a==28&&(h=o.readShort(r,n+1),u=3),29<=a&&a<=31&&(c=a,u=1),32<=a&&a<=246&&(h=a-139,u=1),247<=a&&a<=250&&(h=256*(a-247)+f+108,u=2),251<=a&&a<=254&&(h=256*-(a-251)-f-108,u=2),a==255&&(h=o.readInt(r,n+1)/65535,u=5),i.val=h??"o"+c,i.size=u},e.CFF.readCharString=function(r,n,i){for(var o=n+i,a=e._bin,f=[];n<o;){var u=r[n],c=r[n+1];r[n+2],r[n+3],r[n+4];var h=1,d=null,p=null;u<=20&&(d=u,h=1),u==12&&(d=100*u+c,h=2),u!=19&&u!=20||(d=u,h=2),21<=u&&u<=27&&(d=u,h=1),u==28&&(p=a.readShort(r,n+1),h=3),29<=u&&u<=31&&(d=u,h=1),32<=u&&u<=246&&(p=u-139,h=1),247<=u&&u<=250&&(p=256*(u-247)+c+108,h=2),251<=u&&u<=254&&(p=256*-(u-251)-c-108,h=2),u==255&&(p=a.readInt(r,n+1)/65535,h=5),f.push(p??"o"+d),n+=h}return f},e.CFF.readDict=function(r,n,i){for(var o=e._bin,a={},f=[];n<i;){var u=r[n],c=r[n+1];r[n+2],r[n+3],r[n+4];var h=1,d=null,p=null;if(u==28&&(p=o.readShort(r,n+1),h=3),u==29&&(p=o.readInt(r,n+1),h=5),32<=u&&u<=246&&(p=u-139,h=1),247<=u&&u<=250&&(p=256*(u-247)+c+108,h=2),251<=u&&u<=254&&(p=256*-(u-251)-c-108,h=2),u==255)throw p=o.readInt(r,n+1)/65535,h=5,"unknown number";if(u==30){var g=[];for(h=1;;){var v=r[n+h];h++;var A=v>>4,_=15&v;if(A!=15&&g.push(A),_!=15&&g.push(_),_==15)break}for(var x="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],S=0;S<g.length;S++)x+=y[g[S]];p=parseFloat(x)}u<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],h=1,u==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][c],h=2)),d!=null?(a[d]=f.length==1?f[0]:f,f=[]):f.push(p),n+=h}return a},e.cmap={},e.cmap.parse=function(r,n,i){r=new Uint8Array(r.buffer,n,i),n=0;var o=e._bin,a={};o.readUshort(r,n),n+=2;var f=o.readUshort(r,n);n+=2;var u=[];a.tables=[];for(var c=0;c<f;c++){var h=o.readUshort(r,n);n+=2;var d=o.readUshort(r,n);n+=2;var p=o.readUint(r,n);n+=4;var g="p"+h+"e"+d,v=u.indexOf(p);if(v==-1){var A;v=a.tables.length,u.push(p);var _=o.readUshort(r,p);_==0?A=e.cmap.parse0(r,p):_==4?A=e.cmap.parse4(r,p):_==6?A=e.cmap.parse6(r,p):_==12?A=e.cmap.parse12(r,p):console.debug("unknown format: "+_,h,d,p),a.tables.push(A)}if(a[g]!=null)throw"multiple tables for one platform+encoding";a[g]=v}return a},e.cmap.parse0=function(r,n){var i=e._bin,o={};o.format=i.readUshort(r,n),n+=2;var a=i.readUshort(r,n);n+=2,i.readUshort(r,n),n+=2,o.map=[];for(var f=0;f<a-6;f++)o.map.push(r[n+f]);return o},e.cmap.parse4=function(r,n){var i=e._bin,o=n,a={};a.format=i.readUshort(r,n),n+=2;var f=i.readUshort(r,n);n+=2,i.readUshort(r,n),n+=2;var u=i.readUshort(r,n);n+=2;var c=u/2;a.searchRange=i.readUshort(r,n),n+=2,a.entrySelector=i.readUshort(r,n),n+=2,a.rangeShift=i.readUshort(r,n),n+=2,a.endCount=i.readUshorts(r,n,c),n+=2*c,n+=2,a.startCount=i.readUshorts(r,n,c),n+=2*c,a.idDelta=[];for(var h=0;h<c;h++)a.idDelta.push(i.readShort(r,n)),n+=2;for(a.idRangeOffset=i.readUshorts(r,n,c),n+=2*c,a.glyphIdArray=[];n<o+f;)a.glyphIdArray.push(i.readUshort(r,n)),n+=2;return a},e.cmap.parse6=function(r,n){var i=e._bin,o={};o.format=i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2,i.readUshort(r,n),n+=2,o.firstCode=i.readUshort(r,n),n+=2;var a=i.readUshort(r,n);n+=2,o.glyphIdArray=[];for(var f=0;f<a;f++)o.glyphIdArray.push(i.readUshort(r,n)),n+=2;return o},e.cmap.parse12=function(r,n){var i=e._bin,o={};o.format=i.readUshort(r,n),n+=2,n+=2,i.readUint(r,n),n+=4,i.readUint(r,n),n+=4;var a=i.readUint(r,n);n+=4,o.groups=[];for(var f=0;f<a;f++){var u=n+12*f,c=i.readUint(r,u+0),h=i.readUint(r,u+4),d=i.readUint(r,u+8);o.groups.push([c,h,d])}return o},e.glyf={},e.glyf.parse=function(r,n,i,o){for(var a=[],f=0;f<o.maxp.numGlyphs;f++)a.push(null);return a},e.glyf._parseGlyf=function(r,n){var i=e._bin,o=r._data,a=e._tabOffset(o,"glyf",r._offset)+r.loca[n];if(r.loca[n]==r.loca[n+1])return null;var f={};if(f.noc=i.readShort(o,a),a+=2,f.xMin=i.readShort(o,a),a+=2,f.yMin=i.readShort(o,a),a+=2,f.xMax=i.readShort(o,a),a+=2,f.yMax=i.readShort(o,a),a+=2,f.xMin>=f.xMax||f.yMin>=f.yMax)return null;if(f.noc>0){f.endPts=[];for(var u=0;u<f.noc;u++)f.endPts.push(i.readUshort(o,a)),a+=2;var c=i.readUshort(o,a);if(a+=2,o.length-a<c)return null;f.instructions=i.readBytes(o,a,c),a+=c;var h=f.endPts[f.noc-1]+1;for(f.flags=[],u=0;u<h;u++){var d=o[a];if(a++,f.flags.push(d),(8&d)!=0){var p=o[a];a++;for(var g=0;g<p;g++)f.flags.push(d),u++}}for(f.xs=[],u=0;u<h;u++){var v=(2&f.flags[u])!=0,A=(16&f.flags[u])!=0;v?(f.xs.push(A?o[a]:-o[a]),a++):A?f.xs.push(0):(f.xs.push(i.readShort(o,a)),a+=2)}for(f.ys=[],u=0;u<h;u++)v=(4&f.flags[u])!=0,A=(32&f.flags[u])!=0,v?(f.ys.push(A?o[a]:-o[a]),a++):A?f.ys.push(0):(f.ys.push(i.readShort(o,a)),a+=2);var _=0,x=0;for(u=0;u<h;u++)_+=f.xs[u],x+=f.ys[u],f.xs[u]=_,f.ys[u]=x}else{var y;f.parts=[];do{y=i.readUshort(o,a),a+=2;var S={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(f.parts.push(S),S.glyphIndex=i.readUshort(o,a),a+=2,1&y){var C=i.readShort(o,a);a+=2;var U=i.readShort(o,a);a+=2}else C=i.readInt8(o,a),a++,U=i.readInt8(o,a),a++;2&y?(S.m.tx=C,S.m.ty=U):(S.p1=C,S.p2=U),8&y?(S.m.a=S.m.d=i.readF2dot14(o,a),a+=2):64&y?(S.m.a=i.readF2dot14(o,a),a+=2,S.m.d=i.readF2dot14(o,a),a+=2):128&y&&(S.m.a=i.readF2dot14(o,a),a+=2,S.m.b=i.readF2dot14(o,a),a+=2,S.m.c=i.readF2dot14(o,a),a+=2,S.m.d=i.readF2dot14(o,a),a+=2)}while(32&y);if(256&y){var k=i.readUshort(o,a);for(a+=2,f.instr=[],u=0;u<k;u++)f.instr.push(o[a]),a++}}return f},e.GDEF={},e.GDEF.parse=function(r,n,i,o){var a=n;n+=4;var f=e._bin.readUshort(r,n);return{glyphClassDef:f===0?null:e._lctf.readClassDef(r,a+f)}},e.GPOS={},e.GPOS.parse=function(r,n,i,o){return e._lctf.parse(r,n,i,o,e.GPOS.subt)},e.GPOS.subt=function(r,n,i,o){var a=e._bin,f=i,u={};if(u.fmt=a.readUshort(r,i),i+=2,n==1||n==2||n==3||n==7||n==8&&u.fmt<=2){var c=a.readUshort(r,i);i+=2,u.coverage=e._lctf.readCoverage(r,c+f)}if(n==1&&u.fmt==1){var h=a.readUshort(r,i);i+=2,h!=0&&(u.pos=e.GPOS.readValueRecord(r,i,h))}else if(n==2&&u.fmt>=1&&u.fmt<=2){h=a.readUshort(r,i),i+=2;var d=a.readUshort(r,i);i+=2;var p=e._lctf.numOfOnes(h),g=e._lctf.numOfOnes(d);if(u.fmt==1){u.pairsets=[];var v=a.readUshort(r,i);i+=2;for(var A=0;A<v;A++){var _=f+a.readUshort(r,i);i+=2;var x=a.readUshort(r,_);_+=2;for(var y=[],S=0;S<x;S++){var C=a.readUshort(r,_);_+=2,h!=0&&(w=e.GPOS.readValueRecord(r,_,h),_+=2*p),d!=0&&(D=e.GPOS.readValueRecord(r,_,d),_+=2*g),y.push({gid2:C,val1:w,val2:D})}u.pairsets.push(y)}}if(u.fmt==2){var U=a.readUshort(r,i);i+=2;var k=a.readUshort(r,i);i+=2;var O=a.readUshort(r,i);i+=2;var R=a.readUshort(r,i);for(i+=2,u.classDef1=e._lctf.readClassDef(r,f+U),u.classDef2=e._lctf.readClassDef(r,f+k),u.matrix=[],A=0;A<O;A++){var N=[];for(S=0;S<R;S++){var w=null,D=null;h!=0&&(w=e.GPOS.readValueRecord(r,i,h),i+=2*p),d!=0&&(D=e.GPOS.readValueRecord(r,i,d),i+=2*g),N.push({val1:w,val2:D})}u.matrix.push(N)}}}else if(n==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(r,a.readUshort(r,i)+f),u.baseCoverage=e._lctf.readCoverage(r,a.readUshort(r,i+2)+f),u.markClassCount=a.readUshort(r,i+4),u.markArray=e.GPOS.readMarkArray(r,a.readUshort(r,i+6)+f),u.baseArray=e.GPOS.readBaseArray(r,a.readUshort(r,i+8)+f,u.markClassCount);else if(n==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(r,a.readUshort(r,i)+f),u.mark2Coverage=e._lctf.readCoverage(r,a.readUshort(r,i+2)+f),u.markClassCount=a.readUshort(r,i+4),u.mark1Array=e.GPOS.readMarkArray(r,a.readUshort(r,i+6)+f),u.mark2Array=e.GPOS.readBaseArray(r,a.readUshort(r,i+8)+f,u.markClassCount);else{if(n==9&&u.fmt==1){var E=a.readUshort(r,i);i+=2;var b=a.readUint(r,i);if(i+=4,o.ltype==9)o.ltype=E;else if(o.ltype!=E)throw"invalid extension substitution";return e.GPOS.subt(r,o.ltype,f+b)}console.debug("unsupported GPOS table LookupType",n,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(r,n,i){var o=e._bin,a=[];return a.push(1&i?o.readShort(r,n):0),n+=1&i?2:0,a.push(2&i?o.readShort(r,n):0),n+=2&i?2:0,a.push(4&i?o.readShort(r,n):0),n+=4&i?2:0,a.push(8&i?o.readShort(r,n):0),n+=8&i?2:0,a},e.GPOS.readBaseArray=function(r,n,i){var o=e._bin,a=[],f=n,u=o.readUshort(r,n);n+=2;for(var c=0;c<u;c++){for(var h=[],d=0;d<i;d++)h.push(e.GPOS.readAnchorRecord(r,f+o.readUshort(r,n))),n+=2;a.push(h)}return a},e.GPOS.readMarkArray=function(r,n){var i=e._bin,o=[],a=n,f=i.readUshort(r,n);n+=2;for(var u=0;u<f;u++){var c=e.GPOS.readAnchorRecord(r,i.readUshort(r,n+2)+a);c.markClass=i.readUshort(r,n),o.push(c),n+=4}return o},e.GPOS.readAnchorRecord=function(r,n){var i=e._bin,o={};return o.fmt=i.readUshort(r,n),o.x=i.readShort(r,n+2),o.y=i.readShort(r,n+4),o},e.GSUB={},e.GSUB.parse=function(r,n,i,o){return e._lctf.parse(r,n,i,o,e.GSUB.subt)},e.GSUB.subt=function(r,n,i,o){var a=e._bin,f=i,u={};if(u.fmt=a.readUshort(r,i),i+=2,n!=1&&n!=2&&n!=4&&n!=5&&n!=6)return null;if(n==1||n==2||n==4||n==5&&u.fmt<=2||n==6&&u.fmt<=2){var c=a.readUshort(r,i);i+=2,u.coverage=e._lctf.readCoverage(r,f+c)}if(n==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=a.readShort(r,i),i+=2;else if(u.fmt==2){var h=a.readUshort(r,i);i+=2,u.newg=a.readUshorts(r,i,h),i+=2*u.newg.length}}else if(n==2&&u.fmt==1){h=a.readUshort(r,i),i+=2,u.seqs=[];for(var d=0;d<h;d++){var p=a.readUshort(r,i)+f;i+=2;var g=a.readUshort(r,p);u.seqs.push(a.readUshorts(r,p+2,g))}}else if(n==4)for(u.vals=[],h=a.readUshort(r,i),i+=2,d=0;d<h;d++){var v=a.readUshort(r,i);i+=2,u.vals.push(e.GSUB.readLigatureSet(r,f+v))}else if(n==5&&u.fmt==2){if(u.fmt==2){var A=a.readUshort(r,i);i+=2,u.cDef=e._lctf.readClassDef(r,f+A),u.scset=[];var _=a.readUshort(r,i);for(i+=2,d=0;d<_;d++){var x=a.readUshort(r,i);i+=2,u.scset.push(x==0?null:e.GSUB.readSubClassSet(r,f+x))}}}else if(n==6&&u.fmt==3){if(u.fmt==3){for(d=0;d<3;d++){h=a.readUshort(r,i),i+=2;for(var y=[],S=0;S<h;S++)y.push(e._lctf.readCoverage(r,f+a.readUshort(r,i+2*S)));i+=2*h,d==0&&(u.backCvg=y),d==1&&(u.inptCvg=y),d==2&&(u.ahedCvg=y)}h=a.readUshort(r,i),i+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(r,i,h)}}else{if(n==7&&u.fmt==1){var C=a.readUshort(r,i);i+=2;var U=a.readUint(r,i);if(i+=4,o.ltype==9)o.ltype=C;else if(o.ltype!=C)throw"invalid extension substitution";return e.GSUB.subt(r,o.ltype,f+U)}console.debug("unsupported GSUB table LookupType",n,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(r,n){var i=e._bin.readUshort,o=n,a=[],f=i(r,n);n+=2;for(var u=0;u<f;u++){var c=i(r,n);n+=2,a.push(e.GSUB.readSubClassRule(r,o+c))}return a},e.GSUB.readSubClassRule=function(r,n){var i=e._bin.readUshort,o={},a=i(r,n),f=i(r,n+=2);n+=2,o.input=[];for(var u=0;u<a-1;u++)o.input.push(i(r,n)),n+=2;return o.substLookupRecords=e.GSUB.readSubstLookupRecords(r,n,f),o},e.GSUB.readSubstLookupRecords=function(r,n,i){for(var o=e._bin.readUshort,a=[],f=0;f<i;f++)a.push(o(r,n),o(r,n+2)),n+=4;return a},e.GSUB.readChainSubClassSet=function(r,n){var i=e._bin,o=n,a=[],f=i.readUshort(r,n);n+=2;for(var u=0;u<f;u++){var c=i.readUshort(r,n);n+=2,a.push(e.GSUB.readChainSubClassRule(r,o+c))}return a},e.GSUB.readChainSubClassRule=function(r,n){for(var i=e._bin,o={},a=["backtrack","input","lookahead"],f=0;f<a.length;f++){var u=i.readUshort(r,n);n+=2,f==1&&u--,o[a[f]]=i.readUshorts(r,n,u),n+=2*o[a[f]].length}return u=i.readUshort(r,n),n+=2,o.subst=i.readUshorts(r,n,2*u),n+=2*o.subst.length,o},e.GSUB.readLigatureSet=function(r,n){var i=e._bin,o=n,a=[],f=i.readUshort(r,n);n+=2;for(var u=0;u<f;u++){var c=i.readUshort(r,n);n+=2,a.push(e.GSUB.readLigature(r,o+c))}return a},e.GSUB.readLigature=function(r,n){var i=e._bin,o={chain:[]};o.nglyph=i.readUshort(r,n),n+=2;var a=i.readUshort(r,n);n+=2;for(var f=0;f<a-1;f++)o.chain.push(i.readUshort(r,n)),n+=2;return o},e.head={},e.head.parse=function(r,n,i){var o=e._bin,a={};return o.readFixed(r,n),n+=4,a.fontRevision=o.readFixed(r,n),n+=4,o.readUint(r,n),n+=4,o.readUint(r,n),n+=4,a.flags=o.readUshort(r,n),n+=2,a.unitsPerEm=o.readUshort(r,n),n+=2,a.created=o.readUint64(r,n),n+=8,a.modified=o.readUint64(r,n),n+=8,a.xMin=o.readShort(r,n),n+=2,a.yMin=o.readShort(r,n),n+=2,a.xMax=o.readShort(r,n),n+=2,a.yMax=o.readShort(r,n),n+=2,a.macStyle=o.readUshort(r,n),n+=2,a.lowestRecPPEM=o.readUshort(r,n),n+=2,a.fontDirectionHint=o.readShort(r,n),n+=2,a.indexToLocFormat=o.readShort(r,n),n+=2,a.glyphDataFormat=o.readShort(r,n),n+=2,a},e.hhea={},e.hhea.parse=function(r,n,i){var o=e._bin,a={};return o.readFixed(r,n),n+=4,a.ascender=o.readShort(r,n),n+=2,a.descender=o.readShort(r,n),n+=2,a.lineGap=o.readShort(r,n),n+=2,a.advanceWidthMax=o.readUshort(r,n),n+=2,a.minLeftSideBearing=o.readShort(r,n),n+=2,a.minRightSideBearing=o.readShort(r,n),n+=2,a.xMaxExtent=o.readShort(r,n),n+=2,a.caretSlopeRise=o.readShort(r,n),n+=2,a.caretSlopeRun=o.readShort(r,n),n+=2,a.caretOffset=o.readShort(r,n),n+=2,n+=8,a.metricDataFormat=o.readShort(r,n),n+=2,a.numberOfHMetrics=o.readUshort(r,n),n+=2,a},e.hmtx={},e.hmtx.parse=function(r,n,i,o){for(var a=e._bin,f={aWidth:[],lsBearing:[]},u=0,c=0,h=0;h<o.maxp.numGlyphs;h++)h<o.hhea.numberOfHMetrics&&(u=a.readUshort(r,n),n+=2,c=a.readShort(r,n),n+=2),f.aWidth.push(u),f.lsBearing.push(c);return f},e.kern={},e.kern.parse=function(r,n,i,o){var a=e._bin,f=a.readUshort(r,n);if(n+=2,f==1)return e.kern.parseV1(r,n-2,i,o);var u=a.readUshort(r,n);n+=2;for(var c={glyph1:[],rval:[]},h=0;h<u;h++){n+=2,i=a.readUshort(r,n),n+=2;var d=a.readUshort(r,n);n+=2;var p=d>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;n=e.kern.readFormat0(r,n,c)}return c},e.kern.parseV1=function(r,n,i,o){var a=e._bin;a.readFixed(r,n),n+=4;var f=a.readUint(r,n);n+=4;for(var u={glyph1:[],rval:[]},c=0;c<f;c++){a.readUint(r,n),n+=4;var h=a.readUshort(r,n);n+=2,a.readUshort(r,n),n+=2;var d=h>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;n=e.kern.readFormat0(r,n,u)}return u},e.kern.readFormat0=function(r,n,i){var o=e._bin,a=-1,f=o.readUshort(r,n);n+=2,o.readUshort(r,n),n+=2,o.readUshort(r,n),n+=2,o.readUshort(r,n),n+=2;for(var u=0;u<f;u++){var c=o.readUshort(r,n);n+=2;var h=o.readUshort(r,n);n+=2;var d=o.readShort(r,n);n+=2,c!=a&&(i.glyph1.push(c),i.rval.push({glyph2:[],vals:[]}));var p=i.rval[i.rval.length-1];p.glyph2.push(h),p.vals.push(d),a=c}return n},e.loca={},e.loca.parse=function(r,n,i,o){var a=e._bin,f=[],u=o.head.indexToLocFormat,c=o.maxp.numGlyphs+1;if(u==0)for(var h=0;h<c;h++)f.push(a.readUshort(r,n+(h<<1))<<1);if(u==1)for(h=0;h<c;h++)f.push(a.readUint(r,n+(h<<2)));return f},e.maxp={},e.maxp.parse=function(r,n,i){var o=e._bin,a={},f=o.readUint(r,n);return n+=4,a.numGlyphs=o.readUshort(r,n),n+=2,f==65536&&(a.maxPoints=o.readUshort(r,n),n+=2,a.maxContours=o.readUshort(r,n),n+=2,a.maxCompositePoints=o.readUshort(r,n),n+=2,a.maxCompositeContours=o.readUshort(r,n),n+=2,a.maxZones=o.readUshort(r,n),n+=2,a.maxTwilightPoints=o.readUshort(r,n),n+=2,a.maxStorage=o.readUshort(r,n),n+=2,a.maxFunctionDefs=o.readUshort(r,n),n+=2,a.maxInstructionDefs=o.readUshort(r,n),n+=2,a.maxStackElements=o.readUshort(r,n),n+=2,a.maxSizeOfInstructions=o.readUshort(r,n),n+=2,a.maxComponentElements=o.readUshort(r,n),n+=2,a.maxComponentDepth=o.readUshort(r,n),n+=2),a},e.name={},e.name.parse=function(r,n,i){var o=e._bin,a={};o.readUshort(r,n),n+=2;var f=o.readUshort(r,n);n+=2,o.readUshort(r,n);for(var u,c=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],h=n+=2,d=0;d<f;d++){var p=o.readUshort(r,n);n+=2;var g=o.readUshort(r,n);n+=2;var v=o.readUshort(r,n);n+=2;var A=o.readUshort(r,n);n+=2;var _=o.readUshort(r,n);n+=2;var x=o.readUshort(r,n);n+=2;var y,S=c[A],C=h+12*f+x;if(p==0)y=o.readUnicode(r,C,_/2);else if(p==3&&g==0)y=o.readUnicode(r,C,_/2);else if(g==0)y=o.readASCII(r,C,_);else if(g==1)y=o.readUnicode(r,C,_/2);else if(g==3)y=o.readUnicode(r,C,_/2);else{if(p!=1)throw"unknown encoding "+g+", platformID: "+p;y=o.readASCII(r,C,_),console.debug("reading unknown MAC encoding "+g+" as ASCII")}var U="p"+p+","+v.toString(16);a[U]==null&&(a[U]={}),a[U][S!==void 0?S:A]=y,a[U]._lang=v}for(var k in a)if(a[k].postScriptName!=null&&a[k]._lang==1033)return a[k];for(var k in a)if(a[k].postScriptName!=null&&a[k]._lang==0)return a[k];for(var k in a)if(a[k].postScriptName!=null&&a[k]._lang==3084)return a[k];for(var k in a)if(a[k].postScriptName!=null)return a[k];for(var k in a){u=k;break}return console.debug("returning name table with languageID "+a[u]._lang),a[u]},e["OS/2"]={},e["OS/2"].parse=function(r,n,i){var o=e._bin.readUshort(r,n);n+=2;var a={};if(o==0)e["OS/2"].version0(r,n,a);else if(o==1)e["OS/2"].version1(r,n,a);else if(o==2||o==3||o==4)e["OS/2"].version2(r,n,a);else{if(o!=5)throw"unknown OS/2 table version: "+o;e["OS/2"].version5(r,n,a)}return a},e["OS/2"].version0=function(r,n,i){var o=e._bin;return i.xAvgCharWidth=o.readShort(r,n),n+=2,i.usWeightClass=o.readUshort(r,n),n+=2,i.usWidthClass=o.readUshort(r,n),n+=2,i.fsType=o.readUshort(r,n),n+=2,i.ySubscriptXSize=o.readShort(r,n),n+=2,i.ySubscriptYSize=o.readShort(r,n),n+=2,i.ySubscriptXOffset=o.readShort(r,n),n+=2,i.ySubscriptYOffset=o.readShort(r,n),n+=2,i.ySuperscriptXSize=o.readShort(r,n),n+=2,i.ySuperscriptYSize=o.readShort(r,n),n+=2,i.ySuperscriptXOffset=o.readShort(r,n),n+=2,i.ySuperscriptYOffset=o.readShort(r,n),n+=2,i.yStrikeoutSize=o.readShort(r,n),n+=2,i.yStrikeoutPosition=o.readShort(r,n),n+=2,i.sFamilyClass=o.readShort(r,n),n+=2,i.panose=o.readBytes(r,n,10),n+=10,i.ulUnicodeRange1=o.readUint(r,n),n+=4,i.ulUnicodeRange2=o.readUint(r,n),n+=4,i.ulUnicodeRange3=o.readUint(r,n),n+=4,i.ulUnicodeRange4=o.readUint(r,n),n+=4,i.achVendID=[o.readInt8(r,n),o.readInt8(r,n+1),o.readInt8(r,n+2),o.readInt8(r,n+3)],n+=4,i.fsSelection=o.readUshort(r,n),n+=2,i.usFirstCharIndex=o.readUshort(r,n),n+=2,i.usLastCharIndex=o.readUshort(r,n),n+=2,i.sTypoAscender=o.readShort(r,n),n+=2,i.sTypoDescender=o.readShort(r,n),n+=2,i.sTypoLineGap=o.readShort(r,n),n+=2,i.usWinAscent=o.readUshort(r,n),n+=2,i.usWinDescent=o.readUshort(r,n),n+=2},e["OS/2"].version1=function(r,n,i){var o=e._bin;return n=e["OS/2"].version0(r,n,i),i.ulCodePageRange1=o.readUint(r,n),n+=4,i.ulCodePageRange2=o.readUint(r,n),n+=4},e["OS/2"].version2=function(r,n,i){var o=e._bin;return n=e["OS/2"].version1(r,n,i),i.sxHeight=o.readShort(r,n),n+=2,i.sCapHeight=o.readShort(r,n),n+=2,i.usDefault=o.readUshort(r,n),n+=2,i.usBreak=o.readUshort(r,n),n+=2,i.usMaxContext=o.readUshort(r,n),n+=2},e["OS/2"].version5=function(r,n,i){var o=e._bin;return n=e["OS/2"].version2(r,n,i),i.usLowerOpticalPointSize=o.readUshort(r,n),n+=2,i.usUpperOpticalPointSize=o.readUshort(r,n),n+=2},e.post={},e.post.parse=function(r,n,i){var o=e._bin,a={};return a.version=o.readFixed(r,n),n+=4,a.italicAngle=o.readFixed(r,n),n+=4,a.underlinePosition=o.readShort(r,n),n+=2,a.underlineThickness=o.readShort(r,n),n+=2,a},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,n){var i=r.cmap,o=-1;if(i.p0e4!=null?o=i.p0e4:i.p3e1!=null?o=i.p3e1:i.p1e0!=null?o=i.p1e0:i.p0e3!=null&&(o=i.p0e3),o==-1)throw"no familiar platform and encoding!";var a=i.tables[o];if(a.format==0)return n>=a.map.length?0:a.map[n];if(a.format==4){for(var f=-1,u=0;u<a.endCount.length;u++)if(n<=a.endCount[u]){f=u;break}return f==-1||a.startCount[f]>n?0:65535&(a.idRangeOffset[f]!=0?a.glyphIdArray[n-a.startCount[f]+(a.idRangeOffset[f]>>1)-(a.idRangeOffset.length-f)]:n+a.idDelta[f])}if(a.format==12){if(n>a.groups[a.groups.length-1][1])return 0;for(u=0;u<a.groups.length;u++){var c=a.groups[u];if(c[0]<=n&&n<=c[1])return c[2]+(n-c[0])}return 0}throw"unknown cmap table format "+a.format},e.U.glyphToPath=function(r,n){var i={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[n]){var o=r.SVG.entries[n];return o==null?i:(typeof o=="string"&&(o=e.SVG.toPath(o),r.SVG.entries[n]=o),o)}if(r.CFF){var a={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},f=r.CFF,u=r.CFF.Private;if(f.ROS){for(var c=0;f.FDSelect[c+2]<=n;)c+=2;u=f.FDArray[f.FDSelect[c+1]].Private}e.U._drawCFF(r.CFF.CharStrings[n],a,f,u,i)}else r.glyf&&e.U._drawGlyf(n,r,i);return i},e.U._drawGlyf=function(r,n,i){var o=n.glyf[r];o==null&&(o=n.glyf[r]=e.glyf._parseGlyf(n,r)),o!=null&&(o.noc>-1?e.U._simpleGlyph(o,i):e.U._compoGlyph(o,n,i))},e.U._simpleGlyph=function(r,n){for(var i=0;i<r.noc;i++){for(var o=i==0?0:r.endPts[i-1]+1,a=r.endPts[i],f=o;f<=a;f++){var u=f==o?a:f-1,c=f==a?o:f+1,h=1&r.flags[f],d=1&r.flags[u],p=1&r.flags[c],g=r.xs[f],v=r.ys[f];if(f==o)if(h){if(!d){e.U.P.moveTo(n,g,v);continue}e.U.P.moveTo(n,r.xs[u],r.ys[u])}else d?e.U.P.moveTo(n,r.xs[u],r.ys[u]):e.U.P.moveTo(n,(r.xs[u]+g)/2,(r.ys[u]+v)/2);h?d&&e.U.P.lineTo(n,g,v):p?e.U.P.qcurveTo(n,g,v,r.xs[c],r.ys[c]):e.U.P.qcurveTo(n,g,v,(g+r.xs[c])/2,(v+r.ys[c])/2)}e.U.P.closePath(n)}},e.U._compoGlyph=function(r,n,i){for(var o=0;o<r.parts.length;o++){var a={cmds:[],crds:[]},f=r.parts[o];e.U._drawGlyf(f.glyphIndex,n,a);for(var u=f.m,c=0;c<a.crds.length;c+=2){var h=a.crds[c],d=a.crds[c+1];i.crds.push(h*u.a+d*u.b+u.tx),i.crds.push(h*u.c+d*u.d+u.ty)}for(c=0;c<a.cmds.length;c++)i.cmds.push(a.cmds[c])}},e.U._getGlyphClass=function(r,n){var i=e._lctf.getInterval(n,r);return i==-1?0:n[i+2]},e.U._applySubs=function(r,n,i,o){for(var a=r.length-n-1,f=0;f<i.tabs.length;f++)if(i.tabs[f]!=null){var u,c=i.tabs[f];if(!c.coverage||(u=e._lctf.coverageIndex(c.coverage,r[n]))!=-1){if(i.ltype==1)r[n],c.fmt==1?r[n]=r[n]+c.delta:r[n]=c.newg[u];else if(i.ltype==4)for(var h=c.vals[u],d=0;d<h.length;d++){var p=h[d],g=p.chain.length;if(!(g>a)){for(var v=!0,A=0,_=0;_<g;_++){for(;r[n+A+(1+_)]==-1;)A++;p.chain[_]!=r[n+A+(1+_)]&&(v=!1)}if(v){for(r[n]=p.nglyph,_=0;_<g+A;_++)r[n+_+1]=-1;break}}}else if(i.ltype==5&&c.fmt==2)for(var x=e._lctf.getInterval(c.cDef,r[n]),y=c.cDef[x+2],S=c.scset[y],C=0;C<S.length;C++){var U=S[C],k=U.input;if(!(k.length>a)){for(v=!0,_=0;_<k.length;_++){var O=e._lctf.getInterval(c.cDef,r[n+1+_]);if(x==-1&&c.cDef[O+2]!=k[_]){v=!1;break}}if(v){var R=U.substLookupRecords;for(d=0;d<R.length;d+=2)R[d],R[d+1]}}}else if(i.ltype==6&&c.fmt==3){if(!e.U._glsCovered(r,c.backCvg,n-c.backCvg.length)||!e.U._glsCovered(r,c.inptCvg,n)||!e.U._glsCovered(r,c.ahedCvg,n+c.inptCvg.length))continue;var N=c.lookupRec;for(C=0;C<N.length;C+=2){x=N[C];var w=o[N[C+1]];e.U._applySubs(r,n+x,w,o)}}}}},e.U._glsCovered=function(r,n,i){for(var o=0;o<n.length;o++)if(e._lctf.coverageIndex(n[o],r[i+o])==-1)return!1;return!0},e.U.glyphsToPath=function(r,n,i){for(var o={cmds:[],crds:[]},a=0,f=0;f<n.length;f++){var u=n[f];if(u!=-1){for(var c=f<n.length-1&&n[f+1]!=-1?n[f+1]:0,h=e.U.glyphToPath(r,u),d=0;d<h.crds.length;d+=2)o.crds.push(h.crds[d]+a),o.crds.push(h.crds[d+1]);for(i&&o.cmds.push(i),d=0;d<h.cmds.length;d++)o.cmds.push(h.cmds[d]);i&&o.cmds.push("X"),a+=r.hmtx.aWidth[u],f<n.length-1&&(a+=e.U.getPairAdjustment(r,u,c))}}return o},e.U.P={},e.U.P.moveTo=function(r,n,i){r.cmds.push("M"),r.crds.push(n,i)},e.U.P.lineTo=function(r,n,i){r.cmds.push("L"),r.crds.push(n,i)},e.U.P.curveTo=function(r,n,i,o,a,f,u){r.cmds.push("C"),r.crds.push(n,i,o,a,f,u)},e.U.P.qcurveTo=function(r,n,i,o,a){r.cmds.push("Q"),r.crds.push(n,i,o,a)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,n,i,o,a){for(var f=n.stack,u=n.nStems,c=n.haveWidth,h=n.width,d=n.open,p=0,g=n.x,v=n.y,A=0,_=0,x=0,y=0,S=0,C=0,U=0,k=0,O=0,R=0,N={val:0,size:0};p<r.length;){e.CFF.getCharString(r,p,N);var w=N.val;if(p+=N.size,w=="o1"||w=="o18")f.length%2!=0&&!c&&(h=f.shift()+o.nominalWidthX),u+=f.length>>1,f.length=0,c=!0;else if(w=="o3"||w=="o23")f.length%2!=0&&!c&&(h=f.shift()+o.nominalWidthX),u+=f.length>>1,f.length=0,c=!0;else if(w=="o4")f.length>1&&!c&&(h=f.shift()+o.nominalWidthX,c=!0),d&&e.U.P.closePath(a),v+=f.pop(),e.U.P.moveTo(a,g,v),d=!0;else if(w=="o5")for(;f.length>0;)g+=f.shift(),v+=f.shift(),e.U.P.lineTo(a,g,v);else if(w=="o6"||w=="o7")for(var D=f.length,E=w=="o6",b=0;b<D;b++){var G=f.shift();E?g+=G:v+=G,E=!E,e.U.P.lineTo(a,g,v)}else if(w=="o8"||w=="o24"){D=f.length;for(var j=0;j+6<=D;)A=g+f.shift(),_=v+f.shift(),x=A+f.shift(),y=_+f.shift(),g=x+f.shift(),v=y+f.shift(),e.U.P.curveTo(a,A,_,x,y,g,v),j+=6;w=="o24"&&(g+=f.shift(),v+=f.shift(),e.U.P.lineTo(a,g,v))}else{if(w=="o11")break;if(w=="o1234"||w=="o1235"||w=="o1236"||w=="o1237")w=="o1234"&&(_=v,x=(A=g+f.shift())+f.shift(),R=y=_+f.shift(),C=y,k=v,g=(U=(S=(O=x+f.shift())+f.shift())+f.shift())+f.shift(),e.U.P.curveTo(a,A,_,x,y,O,R),e.U.P.curveTo(a,S,C,U,k,g,v)),w=="o1235"&&(A=g+f.shift(),_=v+f.shift(),x=A+f.shift(),y=_+f.shift(),O=x+f.shift(),R=y+f.shift(),S=O+f.shift(),C=R+f.shift(),U=S+f.shift(),k=C+f.shift(),g=U+f.shift(),v=k+f.shift(),f.shift(),e.U.P.curveTo(a,A,_,x,y,O,R),e.U.P.curveTo(a,S,C,U,k,g,v)),w=="o1236"&&(A=g+f.shift(),_=v+f.shift(),x=A+f.shift(),R=y=_+f.shift(),C=y,U=(S=(O=x+f.shift())+f.shift())+f.shift(),k=C+f.shift(),g=U+f.shift(),e.U.P.curveTo(a,A,_,x,y,O,R),e.U.P.curveTo(a,S,C,U,k,g,v)),w=="o1237"&&(A=g+f.shift(),_=v+f.shift(),x=A+f.shift(),y=_+f.shift(),O=x+f.shift(),R=y+f.shift(),S=O+f.shift(),C=R+f.shift(),U=S+f.shift(),k=C+f.shift(),Math.abs(U-g)>Math.abs(k-v)?g=U+f.shift():v=k+f.shift(),e.U.P.curveTo(a,A,_,x,y,O,R),e.U.P.curveTo(a,S,C,U,k,g,v));else if(w=="o14"){if(f.length>0&&!c&&(h=f.shift()+i.nominalWidthX,c=!0),f.length==4){var J=f.shift(),B=f.shift(),P=f.shift(),m=f.shift(),T=e.CFF.glyphBySE(i,P),M=e.CFF.glyphBySE(i,m);e.U._drawCFF(i.CharStrings[T],n,i,o,a),n.x=J,n.y=B,e.U._drawCFF(i.CharStrings[M],n,i,o,a)}d&&(e.U.P.closePath(a),d=!1)}else if(w=="o19"||w=="o20")f.length%2!=0&&!c&&(h=f.shift()+o.nominalWidthX),u+=f.length>>1,f.length=0,c=!0,p+=u+7>>3;else if(w=="o21")f.length>2&&!c&&(h=f.shift()+o.nominalWidthX,c=!0),v+=f.pop(),g+=f.pop(),d&&e.U.P.closePath(a),e.U.P.moveTo(a,g,v),d=!0;else if(w=="o22")f.length>1&&!c&&(h=f.shift()+o.nominalWidthX,c=!0),g+=f.pop(),d&&e.U.P.closePath(a),e.U.P.moveTo(a,g,v),d=!0;else if(w=="o25"){for(;f.length>6;)g+=f.shift(),v+=f.shift(),e.U.P.lineTo(a,g,v);A=g+f.shift(),_=v+f.shift(),x=A+f.shift(),y=_+f.shift(),g=x+f.shift(),v=y+f.shift(),e.U.P.curveTo(a,A,_,x,y,g,v)}else if(w=="o26")for(f.length%2&&(g+=f.shift());f.length>0;)A=g,_=v+f.shift(),g=x=A+f.shift(),v=(y=_+f.shift())+f.shift(),e.U.P.curveTo(a,A,_,x,y,g,v);else if(w=="o27")for(f.length%2&&(v+=f.shift());f.length>0;)_=v,x=(A=g+f.shift())+f.shift(),y=_+f.shift(),g=x+f.shift(),v=y,e.U.P.curveTo(a,A,_,x,y,g,v);else if(w=="o10"||w=="o29"){var L=w=="o10"?o:i;if(f.length==0)console.debug("error: empty stack");else{var F=f.pop(),V=L.Subrs[F+L.Bias];n.x=g,n.y=v,n.nStems=u,n.haveWidth=c,n.width=h,n.open=d,e.U._drawCFF(V,n,i,o,a),g=n.x,v=n.y,u=n.nStems,c=n.haveWidth,h=n.width,d=n.open}}else if(w=="o30"||w=="o31"){var I=f.length,z=(j=0,w=="o31");for(j+=I-(D=-3&I);j<D;)z?(_=v,x=(A=g+f.shift())+f.shift(),v=(y=_+f.shift())+f.shift(),D-j==5?(g=x+f.shift(),j++):g=x,z=!1):(A=g,_=v+f.shift(),x=A+f.shift(),y=_+f.shift(),g=x+f.shift(),D-j==5?(v=y+f.shift(),j++):v=y,z=!0),e.U.P.curveTo(a,A,_,x,y,g,v),j+=4}else{if((w+"").charAt(0)=="o")throw console.debug("Unknown operation: "+w,r),w;f.push(w)}}}n.x=g,n.y=v,n.nStems=u,n.haveWidth=c,n.width=h,n.open=d};var s=e,l={Typr:s};return t.Typr=s,t.default=l,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function ds(){return function(t){var e=Uint8Array,s=Uint16Array,l=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),n=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),i=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=function(w,D){for(var E=new s(31),b=0;b<31;++b)E[b]=D+=1<<w[b-1];var G=new l(E[30]);for(b=1;b<30;++b)for(var j=E[b];j<E[b+1];++j)G[j]=j-E[b]<<5|b;return[E,G]},a=o(r,2),f=a[0],u=a[1];f[28]=258,u[258]=28;for(var c=o(n,0)[0],h=new s(32768),d=0;d<32768;++d){var p=(43690&d)>>>1|(21845&d)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,h[d]=((65280&p)>>>8|(255&p)<<8)>>>1}var g=function(w,D,E){for(var b=w.length,G=0,j=new s(D);G<b;++G)++j[w[G]-1];var J,B=new s(D);for(G=0;G<D;++G)B[G]=B[G-1]+j[G-1]<<1;{J=new s(1<<D);var P=15-D;for(G=0;G<b;++G)if(w[G])for(var m=G<<4|w[G],T=D-w[G],M=B[w[G]-1]++<<T,L=M|(1<<T)-1;M<=L;++M)J[h[M]>>>P]=m}return J},v=new e(288);for(d=0;d<144;++d)v[d]=8;for(d=144;d<256;++d)v[d]=9;for(d=256;d<280;++d)v[d]=7;for(d=280;d<288;++d)v[d]=8;var A=new e(32);for(d=0;d<32;++d)A[d]=5;var _=g(v,9),x=g(A,5),y=function(w){for(var D=w[0],E=1;E<w.length;++E)w[E]>D&&(D=w[E]);return D},S=function(w,D,E){var b=D/8|0;return(w[b]|w[b+1]<<8)>>(7&D)&E},C=function(w,D){var E=D/8|0;return(w[E]|w[E+1]<<8|w[E+2]<<16)>>(7&D)},U=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(w,D,E){var b=new Error(D||U[w]);if(b.code=w,Error.captureStackTrace&&Error.captureStackTrace(b,k),!E)throw b;return b},O=function(w,D,E){var b=w.length;if(!b||E&&!E.l&&b<5)return D||new e(0);var G=!D||E,j=!E||E.i;E||(E={}),D||(D=new e(3*b));var J,B=function(fe){var Fe=D.length;if(fe>Fe){var Te=new e(Math.max(2*Fe,fe));Te.set(D),D=Te}},P=E.f||0,m=E.p||0,T=E.b||0,M=E.l,L=E.d,F=E.m,V=E.n,I=8*b;do{if(!M){E.f=P=S(w,m,1);var z=S(w,m+1,3);if(m+=3,!z){var K=w[($=((J=m)/8|0)+(7&J&&1)+4)-4]|w[$-3]<<8,ee=$+K;if(ee>b){j&&k(0);break}G&&B(T+K),D.set(w.subarray($,ee),T),E.b=T+=K,E.p=m=8*ee;continue}if(z==1)M=_,L=x,F=9,V=5;else if(z==2){var Y=S(w,m,31)+257,H=S(w,m+10,15)+4,ve=Y+S(w,m+5,31)+1;m+=14;for(var ue=new e(ve),Z=new e(19),te=0;te<H;++te)Z[i[te]]=S(w,m+3*te,7);m+=3*H;var se=y(Z),X=(1<<se)-1,ne=g(Z,se);for(te=0;te<ve;){var $,W=ne[S(w,m,X)];if(m+=15&W,($=W>>>4)<16)ue[te++]=$;else{var he=0,Q=0;for($==16?(Q=3+S(w,m,3),m+=2,he=ue[te-1]):$==17?(Q=3+S(w,m,7),m+=3):$==18&&(Q=11+S(w,m,127),m+=7);Q--;)ue[te++]=he}}var ie=ue.subarray(0,Y),q=ue.subarray(Y);F=y(ie),V=y(q),M=g(ie,F),L=g(q,V)}else k(1);if(m>I){j&&k(0);break}}G&&B(T+131072);for(var xe=(1<<F)-1,re=(1<<V)-1,oe=m;;oe=m){var le=(he=M[C(w,m)&xe])>>>4;if((m+=15&he)>I){j&&k(0);break}if(he||k(2),le<256)D[T++]=le;else{if(le==256){oe=m,M=null;break}var de=le-254;if(le>264){var Se=r[te=le-257];de=S(w,m,(1<<Se)-1)+f[te],m+=Se}var Ce=L[C(w,m)&re],ge=Ce>>>4;if(Ce||k(3),m+=15&Ce,q=c[ge],ge>3&&(Se=n[ge],q+=C(w,m)&(1<<Se)-1,m+=Se),m>I){j&&k(0);break}G&&B(T+131072);for(var me=T+de;T<me;T+=4)D[T]=D[T-q],D[T+1]=D[T+1-q],D[T+2]=D[T+2-q],D[T+3]=D[T+3-q];T=me}}E.l=M,E.p=oe,E.b=T,M&&(P=1,E.m=F,E.d=L,E.n=V)}while(!P);return T==D.length?D:function(fe,Fe,Te){(Te==null||Te>fe.length)&&(Te=fe.length);var We=new(fe instanceof s?s:fe instanceof l?l:e)(Te-Fe);return We.set(fe.subarray(Fe,Te)),We}(D,0,T)},R=new e(0),N=typeof TextDecoder<"u"&&new TextDecoder;try{N.decode(R,{stream:!0})}catch{}return t.convert_streams=function(w){var D=new DataView(w),E=0;function b(){var Y=D.getUint16(E);return E+=2,Y}function G(){var Y=D.getUint32(E);return E+=4,Y}function j(Y){K.setUint16(ee,Y),ee+=2}function J(Y){K.setUint32(ee,Y),ee+=4}for(var B={signature:G(),flavor:G(),length:G(),numTables:b(),reserved:b(),totalSfntSize:G(),majorVersion:b(),minorVersion:b(),metaOffset:G(),metaLength:G(),metaOrigLength:G(),privOffset:G(),privLength:G()},P=0;Math.pow(2,P)<=B.numTables;)P++;P--;for(var m=16*Math.pow(2,P),T=16*B.numTables-m,M=12,L=[],F=0;F<B.numTables;F++)L.push({tag:G(),offset:G(),compLength:G(),origLength:G(),origChecksum:G()}),M+=16;var V,I=new Uint8Array(12+16*L.length+L.reduce(function(Y,H){return Y+H.origLength+4},0)),z=I.buffer,K=new DataView(z),ee=0;return J(B.flavor),j(B.numTables),j(m),j(P),j(T),L.forEach(function(Y){J(Y.tag),J(Y.origChecksum),J(M),J(Y.origLength),Y.outOffset=M,(M+=Y.origLength)%4!=0&&(M+=4-M%4)}),L.forEach(function(Y){var H,ve=w.slice(Y.offset,Y.offset+Y.compLength);if(Y.compLength!=Y.origLength){var ue=new Uint8Array(Y.origLength);H=new Uint8Array(ve,2),O(H,ue)}else ue=new Uint8Array(ve);I.set(ue,Y.outOffset);var Z=0;(M=Y.outOffset+Y.origLength)%4!=0&&(Z=4-M%4),I.set(new Uint8Array(Z).buffer,Y.outOffset+Y.origLength),V=M+Z}),z.slice(0,V)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function ps(t,e){const s={M:2,L:2,Q:4,C:6,Z:0},l={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,n=2,i=4,o=8,a=16,f=32;let u;function c(U){if(!u){const k={R:n,L:r,D:i,C:a,U:f,T:o};u=new Map;for(let O in l){let R=0;l[O].split(",").forEach(N=>{let[w,D]=N.split("+");w=parseInt(w,36),D=D?parseInt(D,36):0,u.set(R+=w,k[O]);for(let E=D;E--;)u.set(++R,k[O])})}}return u.get(U)||f}const h=1,d=2,p=3,g=4,v=[null,"isol","init","fina","medi"];function A(U){const k=new Uint8Array(U.length);let O=f,R=h,N=-1;for(let w=0;w<U.length;w++){const D=U.codePointAt(w);let E=c(D)|0,b=h;E&o||(O&(r|i|a)?E&(n|i|a)?(b=p,(R===h||R===p)&&k[N]++):E&(r|f)&&(R===d||R===g)&&k[N]--:O&(n|f)&&(R===d||R===g)&&k[N]--,R=k[w]=b,O=E,N=w,D>65535&&w++)}return k}function _(U,k){const O=[];for(let N=0;N<k.length;N++){const w=k.codePointAt(N);w>65535&&N++,O.push(t.U.codeToGlyph(U,w))}const R=U.GSUB;if(R){const{lookupList:N,featureList:w}=R;let D;const E=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,b=[];w.forEach(G=>{if(E.test(G.tag))for(let j=0;j<G.tab.length;j++){if(b[G.tab[j]])continue;b[G.tab[j]]=!0;const J=N[G.tab[j]],B=/^(isol|init|fina|medi)$/.test(G.tag);B&&!D&&(D=A(k));for(let P=0;P<O.length;P++)(!D||!B||v[D[P]]===G.tag)&&t.U._applySubs(O,P,J,N)}})}return O}function x(U,k){const O=new Int16Array(k.length*3);let R=0;for(;R<k.length;R++){const E=k[R];if(E===-1)continue;O[R*3+2]=U.hmtx.aWidth[E];const b=U.GPOS;if(b){const G=b.lookupList;for(let j=0;j<G.length;j++){const J=G[j];for(let B=0;B<J.tabs.length;B++){const P=J.tabs[B];if(J.ltype===1){if(t._lctf.coverageIndex(P.coverage,E)!==-1&&P.pos){D(P.pos,R);break}}else if(J.ltype===2){let m=null,T=N();if(T!==-1){const M=t._lctf.coverageIndex(P.coverage,k[T]);if(M!==-1){if(P.fmt===1){const L=P.pairsets[M];for(let F=0;F<L.length;F++)L[F].gid2===E&&(m=L[F])}else if(P.fmt===2){const L=t.U._getGlyphClass(k[T],P.classDef1),F=t.U._getGlyphClass(E,P.classDef2);m=P.matrix[L][F]}if(m){m.val1&&D(m.val1,T),m.val2&&D(m.val2,R);break}}}}else if(J.ltype===4){const m=t._lctf.coverageIndex(P.markCoverage,E);if(m!==-1){const T=N(w),M=T===-1?-1:t._lctf.coverageIndex(P.baseCoverage,k[T]);if(M!==-1){const L=P.markArray[m],F=P.baseArray[M][L.markClass];O[R*3]=F.x-L.x+O[T*3]-O[T*3+2],O[R*3+1]=F.y-L.y+O[T*3+1];break}}}else if(J.ltype===6){const m=t._lctf.coverageIndex(P.mark1Coverage,E);if(m!==-1){const T=N();if(T!==-1){const M=k[T];if(y(U,M)===3){const L=t._lctf.coverageIndex(P.mark2Coverage,M);if(L!==-1){const F=P.mark1Array[m],V=P.mark2Array[L][F.markClass];O[R*3]=V.x-F.x+O[T*3]-O[T*3+2],O[R*3+1]=V.y-F.y+O[T*3+1];break}}}}}}}}else if(U.kern&&!U.cff){const G=N();if(G!==-1){const j=U.kern.glyph1.indexOf(k[G]);if(j!==-1){const J=U.kern.rval[j].glyph2.indexOf(E);J!==-1&&(O[G*3+2]+=U.kern.rval[j].vals[J])}}}}return O;function N(E){for(let b=R-1;b>=0;b--)if(k[b]!==-1&&(!E||E(k[b])))return b;return-1}function w(E){return y(U,E)===1}function D(E,b){for(let G=0;G<3;G++)O[b*3+G]+=E[G]||0}}function y(U,k){const O=U.GDEF&&U.GDEF.glyphClassDef;return O?t.U._getGlyphClass(k,O):0}function S(...U){for(let k=0;k<U.length;k++)if(typeof U[k]=="number")return U[k]}function C(U){const k=Object.create(null),O=U["OS/2"],R=U.hhea,N=U.head.unitsPerEm,w=S(O&&O.sTypoAscender,R&&R.ascender,N),D={unitsPerEm:N,ascender:w,descender:S(O&&O.sTypoDescender,R&&R.descender,0),capHeight:S(O&&O.sCapHeight,w),xHeight:S(O&&O.sxHeight,w),lineGap:S(O&&O.sTypoLineGap,R&&R.lineGap),supportsCodePoint(E){return t.U.codeToGlyph(U,E)>0},forEachGlyph(E,b,G,j){let J=0;const B=1/D.unitsPerEm*b,P=_(U,E);let m=0;const T=x(U,P);return P.forEach((M,L)=>{if(M!==-1){let F=k[M];if(!F){const{cmds:V,crds:I}=t.U.glyphToPath(U,M);let z="",K=0;for(let ue=0,Z=V.length;ue<Z;ue++){const te=s[V[ue]];z+=V[ue];for(let se=1;se<=te;se++)z+=(se>1?",":"")+I[K++]}let ee,Y,H,ve;if(I.length){ee=Y=1/0,H=ve=-1/0;for(let ue=0,Z=I.length;ue<Z;ue+=2){let te=I[ue],se=I[ue+1];te<ee&&(ee=te),se<Y&&(Y=se),te>H&&(H=te),se>ve&&(ve=se)}}else ee=H=Y=ve=0;F=k[M]={index:M,advanceWidth:U.hmtx.aWidth[M],xMin:ee,yMin:Y,xMax:H,yMax:ve,path:z}}j.call(null,F,J+T[L*3]*B,T[L*3+1]*B,m),J+=T[L*3+2]*B,G&&(J+=G*b)}m+=E.codePointAt(m)>65535?2:1}),J}};return D}return function(k){const O=new Uint8Array(k,0,4),R=t._bin.readASCII(O,0,4);if(R==="wOFF")k=e(k);else if(R==="wOF2")throw new Error("woff2 fonts not supported");return C(t.parse(k)[0])}}const vs=Lt({name:"Typr Font Parser",dependencies:[hs,ds,ps],init(t,e,s){const l=t(),r=e();return s(l,r)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function gs(){return function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(x){var y=x>>5;this.buckets.set(y,(this.buckets.get(y)||0)|1<<(31&x))},e.prototype.has=function(x){var y=this.buckets.get(x>>5);return y!==void 0&&(y&1<<(31&x))!=0},e.prototype.serialize=function(){var x=[];return this.buckets.forEach(function(y,S){x.push((+S).toString(36)+":"+y.toString(36))}),x.join(",")},e.prototype.deserialize=function(x){var y=this;this.buckets.clear(),x.split(",").forEach(function(S){var C=S.split(":");y.buckets.set(parseInt(C[0],36),parseInt(C[1],36))})};var s=Math.pow(2,8),l=s-1,r=~l;function n(x){var y=function(C){return C&r}(x).toString(16),S=function(C){return(C&r)+s-1}(x).toString(16);return"codepoint-index/plane"+(x>>16)+"/"+y+"-"+S+".json"}function i(x,y){var S=x&l,C=y.codePointAt(S/6|0);return((C=(C||48)-48)&1<<S%6)!=0}function o(x,y){var S;(S=x,S.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(C){return C.split("-").map(function(U){return parseInt(U.trim(),16)})})).forEach(function(C){var U=C[0],k=C[1];k===void 0&&(k=U),y(U,k)})}function a(x,y){o(x,function(S,C){for(var U=S;U<=C;U++)y(U)})}var f={},u={},c=new WeakMap,h="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function d(x){var y=c.get(x);return y||(y=new e,a(x.ranges,function(S){return y.add(S)}),c.set(x,y)),y}var p,g=new Map;function v(x,y,S){return x[y]?y:x[S]?S:function(C){for(var U in C)return U}(x)}function A(x,y){var S=y;if(!x.includes(S)){S=1/0;for(var C=0;C<x.length;C++)Math.abs(x[C]-y)<Math.abs(S-y)&&(S=x[C])}return S}function _(x){return p||(p=new Set,a("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(y){p.add(y)})),p.has(x)}return t.CodePointSet=e,t.clearCache=function(){f={},u={}},t.getFontsForString=function(x,y){y===void 0&&(y={});var S,C=y.lang;C===void 0&&(C=new RegExp("\\p{Script=Hangul}","u").test(S=x)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(S)?"ja":"en");var U=y.category;U===void 0&&(U="sans-serif");var k=y.style;k===void 0&&(k="normal");var O=y.weight;O===void 0&&(O=400);var R=(y.dataUrl||h).replace(/\/$/g,""),N=new Map,w=new Uint8Array(x.length),D={},E={},b=new Array(x.length),G=new Map,j=!1;function J(m){var T=g.get(m);return T||(T=fetch(R+"/"+m).then(function(M){if(!M.ok)throw new Error(M.statusText);return M.json().then(function(L){if(!Array.isArray(L)||L[0]!==1)throw new Error("Incorrect schema version; need 1, got "+L[0]);return L[1]})}).catch(function(M){if(R!==h)return j||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+R+'", trying default CDN. '+M.message),j=!0),R=h,g.delete(m),J(m);throw M}),g.set(m,T)),T}for(var B=function(m){var T=x.codePointAt(m),M=n(T);b[m]=M,f[M]||G.has(M)||G.set(M,J(M).then(function(L){f[M]=L})),T>65535&&(m++,P=m)},P=0;P<x.length;P++)B(P);return Promise.all(G.values()).then(function(){G.clear();for(var m=function(M){var L=x.codePointAt(M),F=null,V=f[b[M]],I=void 0;for(var z in V){var K=E[z];if(K===void 0&&(K=E[z]=new RegExp(z).test(C||"en")),K){for(var ee in I=z,V[z])if(i(L,V[z][ee])){F=ee;break}break}}if(!F){e:for(var Y in V)if(Y!==I){for(var H in V[Y])if(i(L,V[Y][H])){F=H;break e}}}F||(console.debug("No font coverage for U+"+L.toString(16)),F="latin"),b[M]=F,u[F]||G.has(F)||G.set(F,J("font-meta/"+F+".json").then(function(ve){u[F]=ve})),L>65535&&(M++,T=M)},T=0;T<x.length;T++)m(T);return Promise.all(G.values())}).then(function(){for(var m,T=null,M=0;M<x.length;M++){var L=x.codePointAt(M);if(T&&(_(L)||d(T).has(L)))w[M]=w[M-1];else{T=u[b[M]];var F=D[T.id];if(!F){var V=T.typeforms,I=v(V,U,"sans-serif"),z=v(V[I],k,"normal"),K=A((m=V[I])===null||m===void 0?void 0:m[z],O);F=D[T.id]=R+"/font-files/"+T.id+"/"+I+"."+z+"."+K+".woff"}var ee=N.get(F);ee==null&&(ee=N.size,N.set(F,ee)),w[M]=ee}L>65535&&(M++,w[M]=w[M-1])}return{fontUrls:Array.from(N.keys()),chars:w}})},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}function ms(t,e){const s=Object.create(null),l=Object.create(null);function r(i,o){const a=f=>{console.error(`Failure loading font ${i}`,f)};try{const f=new XMLHttpRequest;f.open("get",i,!0),f.responseType="arraybuffer",f.onload=function(){if(f.status>=400)a(new Error(f.statusText));else if(f.status>0)try{const u=t(f.response);u.src=i,o(u)}catch(u){a(u)}},f.onerror=a,f.send()}catch(f){a(f)}}function n(i,o){let a=s[i];a?o(a):l[i]?l[i].push(o):(l[i]=[o],r(i,f=>{f.src=i,s[i]=f,l[i].forEach(u=>u(f)),delete l[i]}))}return function(i,o,{lang:a,fonts:f=[],style:u="normal",weight:c="normal",unicodeFontsURL:h}={}){const d=new Uint8Array(i.length),p=[];i.length||_();const g=new Map,v=[];if(u!=="italic"&&(u="normal"),typeof c!="number"&&(c=c==="bold"?700:400),f&&!Array.isArray(f)&&(f=[f]),f=f.slice().filter(y=>!y.lang||y.lang.test(a)).reverse(),f.length){let U=0;(function k(O=0){for(let R=O,N=i.length;R<N;R++){const w=i.codePointAt(R);if(U===1&&p[d[R-1]].supportsCodePoint(w)||/\s/.test(i[R]))d[R]=d[R-1],U===2&&(v[v.length-1][1]=R);else for(let D=d[R],E=f.length;D<=E;D++)if(D===E){const b=U===2?v[v.length-1]:v[v.length]=[R,R];b[1]=R,U=2}else{d[R]=D;const{src:b,unicodeRange:G}=f[D];if(!G||x(w,G)){const j=s[b];if(!j){n(b,()=>{k(R)});return}if(j.supportsCodePoint(w)){let J=g.get(j);typeof J!="number"&&(J=p.length,p.push(j),g.set(j,J)),d[R]=J,U=1;break}}}w>65535&&R+1<N&&(d[R+1]=d[R],R++,U===2&&(v[v.length-1][1]=R))}A()})()}else v.push([0,i.length-1]),A();function A(){if(v.length){const y=v.map(S=>i.substring(S[0],S[1]+1)).join(`
`);e.getFontsForString(y,{lang:a||void 0,style:u,weight:c,dataUrl:h}).then(({fontUrls:S,chars:C})=>{const U=p.length;let k=0;v.forEach(R=>{for(let N=0,w=R[1]-R[0];N<=w;N++)d[R[0]+N]=C[k++]+U;k++});let O=0;S.forEach((R,N)=>{n(R,w=>{p[N+U]=w,++O===S.length&&_()})})})}else _()}function _(){o({chars:d,fonts:p})}function x(y,S){for(let C=0;C<S.length;C++){const[U,k=U]=S[C];if(U<=y&&y<=k)return!0}return!1}}}const ys=Lt({name:"FontResolver",dependencies:[ms,vs,gs],init(t,e,s){return t(e,s())}});function _s(t,e){const l=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",n=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function i({text:p,lang:g,fonts:v,style:A,weight:_,preResolvedFonts:x,unicodeFontsURL:y},S){const C=({chars:U,fonts:k})=>{let O,R;const N=[];for(let w=0;w<U.length;w++)U[w]!==R?(R=U[w],N.push(O={start:w,end:w,fontObj:k[U[w]]})):O.end=w;S(N)};x?C(x):t(p,C,{lang:g,fonts:v,style:A,weight:_,unicodeFontsURL:y})}function o({text:p="",font:g,lang:v,sdfGlyphSize:A=64,fontSize:_=400,fontWeight:x=1,fontStyle:y="normal",letterSpacing:S=0,lineHeight:C="normal",maxWidth:U=1/0,direction:k,textAlign:O="left",textIndent:R=0,whiteSpace:N="normal",overflowWrap:w="normal",anchorX:D=0,anchorY:E=0,metricsOnly:b=!1,unicodeFontsURL:G,preResolvedFonts:j=null,includeCaretPositions:J=!1,chunkedBoundsSize:B=8192,colorRanges:P=null},m){const T=c(),M={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),_=+_,S=+S,U=+U,C=C||"normal",R=+R,i({text:p,lang:v,style:y,weight:x,fonts:typeof g=="string"?[{src:g}]:g,unicodeFontsURL:G,preResolvedFonts:j},L=>{M.fontLoad=c()-T;const F=isFinite(U);let V=null,I=null,z=null,K=null,ee=null,Y=null,H=null,ve=null,ue=0,Z=0,te=N!=="nowrap";const se=new Map,X=c();let ne=R,$=0,W=new h;const he=[W];L.forEach(re=>{const{fontObj:oe}=re,{ascender:le,descender:de,unitsPerEm:Se,lineGap:Ce,capHeight:ge,xHeight:me}=oe;let fe=se.get(oe);if(!fe){const ce=_/Se,we=C==="normal"?(le-de+Ce)*ce:C*_,ut=(we-(le-de)*ce)/2,be=Math.min(we,(le-de)*ce),ye=(le+de)/2*ce+be/2;fe={index:se.size,src:oe.src,fontObj:oe,fontSizeMult:ce,unitsPerEm:Se,ascender:le*ce,descender:de*ce,capHeight:ge*ce,xHeight:me*ce,lineHeight:we,baseline:-ut-le*ce,caretTop:ye,caretBottom:ye-be},se.set(oe,fe)}const{fontSizeMult:Fe}=fe,Te=p.slice(re.start,re.end+1);let We,Ue;oe.forEachGlyph(Te,_,S,(ce,we,ut,be)=>{we+=$,be+=re.start,We=we,Ue=ce;const ye=p.charAt(be),Le=ce.advanceWidth*Fe,Ee=W.count;let pe;if("isEmpty"in ce||(ce.isWhitespace=!!ye&&new RegExp(r).test(ye),ce.canBreakAfter=!!ye&&n.test(ye),ce.isEmpty=ce.xMin===ce.xMax||ce.yMin===ce.yMax||l.test(ye)),!ce.isWhitespace&&!ce.isEmpty&&Z++,te&&F&&!ce.isWhitespace&&we+Le+ne>U&&Ee){if(W.glyphAt(Ee-1).glyphObj.canBreakAfter)pe=new h,ne=-we;else for(let Be=Ee;Be--;)if(Be===0&&w==="break-word"){pe=new h,ne=-we;break}else if(W.glyphAt(Be).glyphObj.canBreakAfter){pe=W.splitAt(Be+1);const Ie=pe.glyphAt(0).x;ne-=Ie;for(let Ge=pe.count;Ge--;)pe.glyphAt(Ge).x-=Ie;break}pe&&(W.isSoftWrapped=!0,W=pe,he.push(W),ue=U)}let Ae=W.glyphAt(W.count);Ae.glyphObj=ce,Ae.x=we+ne,Ae.y=ut,Ae.width=Le,Ae.charIndex=be,Ae.fontData=fe,ye===`
`&&(W=new h,he.push(W),ne=-(we+Le+S*_)+R)}),$=We+Ue.advanceWidth*Fe+S*_});let Q=0;he.forEach(re=>{let oe=!0;for(let le=re.count;le--;){const de=re.glyphAt(le);oe&&!de.glyphObj.isWhitespace&&(re.width=de.x+de.width,re.width>ue&&(ue=re.width),oe=!1);let{lineHeight:Se,capHeight:Ce,xHeight:ge,baseline:me}=de.fontData;Se>re.lineHeight&&(re.lineHeight=Se);const fe=me-re.baseline;fe<0&&(re.baseline+=fe,re.cap+=fe,re.ex+=fe),re.cap=Math.max(re.cap,re.baseline+Ce),re.ex=Math.max(re.ex,re.baseline+ge)}re.baseline-=Q,re.cap-=Q,re.ex-=Q,Q+=re.lineHeight});let ie=0,q=0;if(D&&(typeof D=="number"?ie=-D:typeof D=="string"&&(ie=-ue*(D==="left"?0:D==="center"?.5:D==="right"?1:f(D)))),E&&(typeof E=="number"?q=-E:typeof E=="string"&&(q=E==="top"?0:E==="top-baseline"?-he[0].baseline:E==="top-cap"?-he[0].cap:E==="top-ex"?-he[0].ex:E==="middle"?Q/2:E==="bottom"?Q:E==="bottom-baseline"?-he[he.length-1].baseline:f(E)*Q)),!b){const re=e.getEmbeddingLevels(p,k);V=new Uint16Array(Z),I=new Uint8Array(Z),z=new Float32Array(Z*2),K={},H=[1/0,1/0,-1/0,-1/0],ve=[],J&&(Y=new Float32Array(p.length*4)),P&&(ee=new Uint8Array(Z*3));let oe=0,le=-1,de=-1,Se,Ce;if(he.forEach((ge,me)=>{let{count:fe,width:Fe}=ge;if(fe>0){let Te=0;for(let be=fe;be--&&ge.glyphAt(be).glyphObj.isWhitespace;)Te++;let We=0,Ue=0;if(O==="center")We=(ue-Fe)/2;else if(O==="right")We=ue-Fe;else if(O==="justify"&&ge.isSoftWrapped){let be=0;for(let ye=fe-Te;ye--;)ge.glyphAt(ye).glyphObj.isWhitespace&&be++;Ue=(ue-Fe)/be}if(Ue||We){let be=0;for(let ye=0;ye<fe;ye++){let Le=ge.glyphAt(ye);const Ee=Le.glyphObj;Le.x+=We+be,Ue!==0&&Ee.isWhitespace&&ye<fe-Te&&(be+=Ue,Le.width+=Ue)}}const ce=e.getReorderSegments(p,re,ge.glyphAt(0).charIndex,ge.glyphAt(ge.count-1).charIndex);for(let be=0;be<ce.length;be++){const[ye,Le]=ce[be];let Ee=1/0,pe=-1/0;for(let Ae=0;Ae<fe;Ae++)if(ge.glyphAt(Ae).charIndex>=ye){let Be=Ae,Ie=Ae;for(;Ie<fe;Ie++){let Ge=ge.glyphAt(Ie);if(Ge.charIndex>Le)break;Ie<fe-Te&&(Ee=Math.min(Ee,Ge.x),pe=Math.max(pe,Ge.x+Ge.width))}for(let Ge=Be;Ge<Ie;Ge++){const qe=ge.glyphAt(Ge);qe.x=pe-(qe.x+qe.width-Ee)}break}}let we;const ut=be=>we=be;for(let be=0;be<fe;be++){const ye=ge.glyphAt(be);we=ye.glyphObj;const Le=we.index,Ee=re.levels[ye.charIndex]&1;if(Ee){const pe=e.getMirroredCharacter(p[ye.charIndex]);pe&&ye.fontData.fontObj.forEachGlyph(pe,0,0,ut)}if(J){const{charIndex:pe,fontData:Ae}=ye,Be=ye.x+ie,Ie=ye.x+ye.width+ie;Y[pe*4]=Ee?Ie:Be,Y[pe*4+1]=Ee?Be:Ie,Y[pe*4+2]=ge.baseline+Ae.caretBottom+q,Y[pe*4+3]=ge.baseline+Ae.caretTop+q;const Ge=pe-le;Ge>1&&u(Y,le,Ge),le=pe}if(P){const{charIndex:pe}=ye;for(;pe>de;)de++,P.hasOwnProperty(de)&&(Ce=P[de])}if(!we.isWhitespace&&!we.isEmpty){const pe=oe++,{fontSizeMult:Ae,src:Be,index:Ie}=ye.fontData,Ge=K[Be]||(K[Be]={});Ge[Le]||(Ge[Le]={path:we.path,pathBounds:[we.xMin,we.yMin,we.xMax,we.yMax]});const qe=ye.x+ie,ct=ye.y+ge.baseline+q;z[pe*2]=qe,z[pe*2+1]=ct;const at=qe+we.xMin*Ae,ht=ct+we.yMin*Ae,gt=qe+we.xMax*Ae,st=ct+we.yMax*Ae;at<H[0]&&(H[0]=at),ht<H[1]&&(H[1]=ht),gt>H[2]&&(H[2]=gt),st>H[3]&&(H[3]=st),pe%B===0&&(Se={start:pe,end:pe,rect:[1/0,1/0,-1/0,-1/0]},ve.push(Se)),Se.end++;const Ne=Se.rect;if(at<Ne[0]&&(Ne[0]=at),ht<Ne[1]&&(Ne[1]=ht),gt>Ne[2]&&(Ne[2]=gt),st>Ne[3]&&(Ne[3]=st),V[pe]=Le,I[pe]=Ie,P){const mt=pe*3;ee[mt]=Ce>>16&255,ee[mt+1]=Ce>>8&255,ee[mt+2]=Ce&255}}}}}),Y){const ge=p.length-le;ge>1&&u(Y,le,ge)}}const xe=[];se.forEach(({index:re,src:oe,unitsPerEm:le,ascender:de,descender:Se,lineHeight:Ce,capHeight:ge,xHeight:me})=>{xe[re]={src:oe,unitsPerEm:le,ascender:de,descender:Se,lineHeight:Ce,capHeight:ge,xHeight:me}}),M.typesetting=c()-X,m({glyphIds:V,glyphFontIndices:I,glyphPositions:z,glyphData:K,fontData:xe,caretPositions:Y,glyphColors:ee,chunkedBounds:ve,fontSize:_,topBaseline:q+he[0].baseline,blockBounds:[ie,q-Q,ie+ue,q],visibleBounds:H,timings:M})})}function a(p,g){o({...p,metricsOnly:!0},v=>{const[A,_,x,y]=v.blockBounds;g({width:x-A,height:y-_})})}function f(p){let g=p.match(/^([\d.]+)%$/),v=g?parseFloat(g[1]):NaN;return isNaN(v)?0:v/100}function u(p,g,v){const A=p[g*4],_=p[g*4+1],x=p[g*4+2],y=p[g*4+3],S=(_-A)/v;for(let C=0;C<v;C++){const U=(g+C)*4;p[U]=A+S*C,p[U+1]=A+S*(C+1),p[U+2]=x,p[U+3]=y}}function c(){return(self.performance||Date).now()}function h(){this.data=[]}const d=["glyphObj","x","y","width","charIndex","fontData"];return h.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/d.length)},glyphAt(p){let g=h.flyweight;return g.data=this.data,g.index=p,g},splitAt(p){let g=new h;return g.data=this.data.splice(p*d.length),g}},h.flyweight=d.reduce((p,g,v,A)=>(Object.defineProperty(p,g,{get(){return this.data[this.index*d.length+v]},set(_){this.data[this.index*d.length+v]=_}}),p),{data:null,index:0}),{typeset:o,measure:a}}const xt=()=>(self.performance||Date).now(),qn=Eo();let Li;function xs(t,e,s,l,r,n,i,o,a,f,u=!0){return u?bs(t,e,s,l,r,n,i,o,a,f).then(null,c=>(Li||(console.warn("WebGL SDF generation failed, falling back to JS",c),Li=!0),Gi(t,e,s,l,r,n,i,o,a,f))):Gi(t,e,s,l,r,n,i,o,a,f)}const On=[],ws=5;let Dr=0;function Co(){const t=xt();for(;On.length&&xt()-t<ws;)On.shift()();Dr=On.length?setTimeout(Co,0):0}const bs=(...t)=>new Promise((e,s)=>{On.push(()=>{const l=xt();try{qn.webgl.generateIntoCanvas(...t),e({timing:xt()-l})}catch(r){s(r)}}),Dr||(Dr=setTimeout(Co,0))}),Ss=4,Us=2e3,Oi={};let ks=0;function Gi(t,e,s,l,r,n,i,o,a,f){const u="TroikaTextSDFGenerator_JS_"+ks++%Ss;let c=Oi[u];return c||(c=Oi[u]={workerModule:Lt({name:u,workerId:u,dependencies:[Eo,xt],init(h,d){const p=h().javascript.generate;return function(...g){const v=d();return{textureData:p(...g),timing:d()-v}}},getTransferables(h){return[h.textureData.buffer]}}),requests:0,idleTimer:null}),c.requests++,clearTimeout(c.idleTimer),c.workerModule(t,e,s,l,r,n).then(({textureData:h,timing:d})=>{const p=xt(),g=new Uint8Array(h.length*4);for(let v=0;v<h.length;v++)g[v*4+f]=h[v];return qn.webglUtils.renderImageData(i,g,o,a,t,e,1<<3-f),d+=xt()-p,--c.requests===0&&(c.idleTimer=setTimeout(()=>{ns(u)},Us)),{timing:d}})}function Ts(t){t._warm||(qn.webgl.isSupported(t),t._warm=!0)}const Es=qn.webglUtils.resizeWebGLCanvasWithoutClearing,At={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},As=new ln;function Et(){return(self.performance||Date).now()}const Pi=Object.create(null);function Fo(t,e){t=Ms({},t);const s=Et(),{defaultFontURL:l}=At,r=[];if(l&&r.push({label:"default",src:Ii(l)}),t.font&&r.push({label:"user",src:Ii(t.font)}),t.font=r,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||At.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||At.unicodeFontsURL,t.colorRanges!=null){let h={};for(let d in t.colorRanges)if(t.colorRanges.hasOwnProperty(d)){let p=t.colorRanges[d];typeof p!="number"&&(p=As.set(p).getHex()),h[d]=p}t.colorRanges=h}Object.freeze(t);const{textureWidth:n,sdfExponent:i}=At,{sdfGlyphSize:o}=t,a=n/o*4;let f=Pi[o];if(!f){const h=document.createElement("canvas");h.width=n,h.height=o*256/a,f=Pi[o]={glyphCount:0,sdfGlyphSize:o,sdfCanvas:h,sdfTexture:new Ma(h,void 0,void 0,void 0,Ei,Ei),contextLost:!1,glyphsByFont:new Map},f.sdfTexture.generateMipmaps=!1,Cs(f)}const{sdfTexture:u,sdfCanvas:c}=f;Rs(t).then(h=>{const{glyphIds:d,glyphFontIndices:p,fontData:g,glyphPositions:v,fontSize:A,timings:_}=h,x=[],y=new Float32Array(d.length*4);let S=0,C=0;const U=Et(),k=g.map(D=>{let E=f.glyphsByFont.get(D.src);return E||f.glyphsByFont.set(D.src,E=new Map),E});d.forEach((D,E)=>{const b=p[E],{src:G,unitsPerEm:j}=g[b];let J=k[b].get(D);if(!J){const{path:M,pathBounds:L}=h.glyphData[G][D],F=Math.max(L[2]-L[0],L[3]-L[1])/o*(At.sdfMargin*o+.5),V=f.glyphCount++,I=[L[0]-F,L[1]-F,L[2]+F,L[3]+F];k[b].set(D,J={path:M,atlasIndex:V,sdfViewBox:I}),x.push(J)}const{sdfViewBox:B}=J,P=v[C++],m=v[C++],T=A/j;y[S++]=P+B[0]*T,y[S++]=m+B[1]*T,y[S++]=P+B[2]*T,y[S++]=m+B[3]*T,d[E]=J.atlasIndex}),_.quads=(_.quads||0)+(Et()-U);const O=Et();_.sdf={};const R=c.height,N=Math.ceil(f.glyphCount/a),w=Math.pow(2,Math.ceil(Math.log2(N*o)));w>R&&(console.info(`Increasing SDF texture size ${R}->${w}`),Es(c,n,w),u.dispose()),Promise.all(x.map(D=>Mo(D,f,t.gpuAccelerateSDF).then(({timing:E})=>{_.sdf[D.atlasIndex]=E}))).then(()=>{x.length&&!f.contextLost&&(Do(f),u.needsUpdate=!0),_.sdfTotal=Et()-O,_.total=Et()-s,e(Object.freeze({parameters:t,sdfTexture:u,sdfGlyphSize:o,sdfExponent:i,glyphBounds:y,glyphAtlasIndices:d,glyphColors:h.glyphColors,caretPositions:h.caretPositions,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{f.contextLost||Ts(c)})}function Mo({path:t,atlasIndex:e,sdfViewBox:s},{sdfGlyphSize:l,sdfCanvas:r,contextLost:n},i){if(n)return Promise.resolve({timing:-1});const{textureWidth:o,sdfExponent:a}=At,f=Math.max(s[2]-s[0],s[3]-s[1]),u=Math.floor(e/4),c=u%(o/l)*l,h=Math.floor(u/(o/l))*l,d=e%4;return xs(l,l,t,s,f,a,r,c,h,d,i)}function Cs(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",s=>{console.log("Context Lost",s),s.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",s=>{console.log("Context Restored",s),t.contextLost=!1;const l=[];t.glyphsByFont.forEach(r=>{r.forEach(n=>{l.push(Mo(n,t,!0))})}),Promise.all(l).then(()=>{Do(t),t.sdfTexture.needsUpdate=!0})})}function Fs({font:t,characters:e,sdfGlyphSize:s},l){let r=Array.isArray(e)?e.join(`
`):""+e;Fo({font:t,sdfGlyphSize:s,text:r},l)}function Ms(t,e){for(let s in e)e.hasOwnProperty(s)&&(t[s]=e[s]);return t}let kn;function Ii(t){return kn||(kn=typeof document>"u"?{}:document.createElement("a")),kn.href=t,kn.href}function Do(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:s}=t,{width:l,height:r}=e,n=t.sdfCanvas.getContext("webgl");let i=s.image.data;(!i||i.length!==l*r*4)&&(i=new Uint8Array(l*r*4),s.image={width:l,height:r,data:i},s.flipY=!1,s.isDataTexture=!0),n.readPixels(0,0,l,r,n.RGBA,n.UNSIGNED_BYTE,i)}}const Ds=Lt({name:"Typesetter",dependencies:[_s,ys,is],init(t,e,s){return t(e,s())}}),Rs=Lt({name:"Typesetter",dependencies:[Ds],init(t){return function(e){return new Promise(s=>{t.typeset(e,s)})}},getTransferables(t){const e=[];for(let s in t)t[s]&&t[s].buffer&&e.push(t[s].buffer);return e}}),Bi={};function Ls(t){let e=Bi[t];if(!e){const s=new Jr(1,1,t,t),l=s.clone(),r=s.attributes,n=l.attributes,i=new Na,o=r.uv.count;for(let a=0;a<o;a++)n.position.array[a*3]*=-1,n.normal.array[a*3+2]*=-1;["position","normal","uv"].forEach(a=>{i.setAttribute(a,new Wa([...r[a].array,...n[a].array],r[a].itemSize))}),i.setIndex([...s.index.array,...l.index.array.map(a=>a+o)]),i.translate(.5,.5,0),e=Bi[t]=i}return e}const Os="aTroikaGlyphBounds",Ni="aTroikaGlyphIndex",Gs="aTroikaGlyphColor";class Ps extends Da{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Ra,this.boundingBox=new La}computeBoundingSphere(){}computeBoundingBox(){}setSide(e){const s=this.getIndex().count;this.setDrawRange(e===Oa?s/2:0,e===Uo?s:s/2)}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let s=Ls(e);["position","normal","uv"].forEach(l=>{this.attributes[l]=s.attributes[l].clone()}),this.setIndex(s.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,s,l,r,n){br(this,Os,e,4),br(this,Ni,s,1),br(this,Gs,n,3),this._blockBounds=l,this._chunkedBounds=r,this.instanceCount=s.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:s,boundingBox:l}=this;if(s){const{PI:r,floor:n,min:i,max:o,sin:a,cos:f}=Math,u=r/2,c=r*2,h=Math.abs(s),d=e[0]/h,p=e[2]/h,g=n((d+u)/c)!==n((p+u)/c)?-h:i(a(d)*h,a(p)*h),v=n((d-u)/c)!==n((p-u)/c)?h:o(a(d)*h,a(p)*h),A=n((d+r)/c)!==n((p+r)/c)?h*2:o(h-f(d)*h,h-f(p)*h);l.min.set(g,e[1],s<0?-A:0),l.max.set(v,e[3],s<0?0:A)}else l.min.set(e[0],e[1],0),l.max.set(e[2],e[3],0);l.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let s=this.getAttribute(Ni).count,l=this._chunkedBounds;if(l)for(let r=l.length;r--;){s=l[r].end;let n=l[r].rect;if(n[1]<e.w&&n[3]>e.y&&n[0]<e.z&&n[2]>e.x)break}this.instanceCount=s}}function br(t,e,s,l){const r=t.getAttribute(e);s?r&&r.array.length===s.length?(r.array.set(s),r.needsUpdate=!0):(t.setAttribute(e,new Ga(s,l)),delete t._maxInstanceCount,t.dispose()):r&&t.deleteAttribute(e)}const Is=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaDistanceOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Bs=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,Ns=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaDistanceOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaOutlineOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,Ws=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function zs(t){const e=Mr(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new en},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new Ai(0,0,0,0)},uTroikaClipRect:{value:new Ai(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new en},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new ln},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Pa},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:Is,vertexTransform:Bs,fragmentDefs:Ns,fragmentColorTransform:Ws,customRewriter({vertexShader:s,fragmentShader:l}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(l)&&(l=l.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(s)||(s=s.replace(Ao,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:s,fragmentShader:l}}});return e.transparent=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Kr=new Ia({color:16777215,side:Uo,transparent:!0}),Wi=8421504,zi=new Ba,Tn=new Yr,Sr=new Yr,Xt=[],Vs=new Yr,Ur="+x+y";function Vi(t){return Array.isArray(t)?t[0]:t}let Ro=()=>{const t=new jr(new Jr(1,1),Kr);return Ro=()=>t,t},Lo=()=>{const t=new jr(new Jr(1,1,32,1),Kr);return Lo=()=>t,t};const Hs={type:"syncstart"},Xs={type:"synccomplete"},Oo=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],js=Oo.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Go=class extends jr{constructor(){const e=new Ps;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=Wi,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Ur,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(Hs),Fo({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},s=>{this._isSyncing=!1,this._textRenderInfo=s,this.geometry.updateGlyphs(s.glyphBounds,s.glyphAtlasIndices,s.blockBounds,s.chunkedBounds,s.glyphColors);const l=this._queuedSyncs;l&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{l.forEach(r=>r&&r())})),this.dispatchEvent(Xs),e&&e()})))}onBeforeRender(e,s,l,r,n,i){this.sync(),n.isTroikaTextMaterial&&this._prepareForRender(n),n._hadOwnSide=n.hasOwnProperty("side"),this.geometry.setSide(n._actualSide=n.side),n.side=Fa}onAfterRender(e,s,l,r,n,i){n._hadOwnSide?n.side=n._actualSide:delete n.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let e=this._derivedMaterial;const s=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Kr.clone());if((!e||e.baseMaterial!==s)&&(e=this._derivedMaterial=zs(s),s.addEventListener("dispose",function l(){s.removeEventListener("dispose",l),e.dispose()})),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let l=e._outlineMtl;return l||(l=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),l.isTextOutlineMaterial=!0,l.depthWrite=!1,l.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),l.dispose()})),[l,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Vi(this.material).getDepthMaterial()}get customDistanceMaterial(){return Vi(this.material).getDistanceMaterial()}_prepareForRender(e){const s=e.isTextOutlineMaterial,l=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:o,blockBounds:a}=r;l.uTroikaSDFTexture.value=o,l.uTroikaSDFTextureSize.value.set(o.image.width,o.image.height),l.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,l.uTroikaSDFExponent.value=r.sdfExponent,l.uTroikaTotalBounds.value.fromArray(a),l.uTroikaUseGlyphColors.value=!s&&!!r.glyphColors;let f=0,u=0,c=0,h,d,p,g=0,v=0;if(s){let{outlineWidth:_,outlineOffsetX:x,outlineOffsetY:y,outlineBlur:S,outlineOpacity:C}=this;f=this._parsePercent(_)||0,u=Math.max(0,this._parsePercent(S)||0),h=C,g=this._parsePercent(x)||0,v=this._parsePercent(y)||0}else c=Math.max(0,this._parsePercent(this.strokeWidth)||0),c&&(p=this.strokeColor,l.uTroikaStrokeColor.value.set(p??Wi),d=this.strokeOpacity,d==null&&(d=1)),h=this.fillOpacity;l.uTroikaDistanceOffset.value=f,l.uTroikaPositionOffset.value.set(g,v),l.uTroikaBlurRadius.value=u,l.uTroikaStrokeWidth.value=c,l.uTroikaStrokeOpacity.value=d,l.uTroikaFillOpacity.value=h??1,l.uTroikaCurveRadius.value=this.curveRadius||0;let A=this.clipRect;if(A&&Array.isArray(A)&&A.length===4)l.uTroikaClipRect.value.fromArray(A);else{const _=(this.fontSize||.1)*100;l.uTroikaClipRect.value.set(a[0]-_,a[1]-_,a[2]+_,a[3]+_)}this.geometry.applyClipRect(l.uTroikaClipRect.value)}l.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const n=s?this.outlineColor||0:this.color;if(n==null)delete e.color;else{const o=e.hasOwnProperty("color")?e.color:e.color=new ln;(n!==o._input||typeof n=="object")&&o.set(o._input=n)}let i=this.orientation||Ur;if(i!==e._orientation){let o=l.uTroikaOrient.value;i=i.replace(/[^-+xyz]/g,"");let a=i!==Ur&&i.match(/^([-+])([xyz])([-+])([xyz])$/);if(a){let[,f,u,c,h]=a;Tn.set(0,0,0)[u]=f==="-"?1:-1,Sr.set(0,0,0)[h]=c==="-"?-1:1,zi.lookAt(Vs,Tn.cross(Sr),Sr),o.setFromMatrix4(zi)}else o.identity();e._orientation=i}}_parsePercent(e){if(typeof e=="string"){let s=e.match(/^(-?[\d.]+)%$/),l=s?parseFloat(s[1]):NaN;e=(isNaN(l)?0:l/100)*this.fontSize}return e}localPositionToTextCoords(e,s=new en){s.copy(e);const l=this.curveRadius;return l&&(s.x=Math.atan2(e.x,Math.abs(l)-Math.abs(e.z))*Math.abs(l)),s}worldPositionToTextCoords(e,s=new en){return Tn.copy(e),this.localPositionToTextCoords(this.worldToLocal(Tn),s)}raycast(e,s){const{textRenderInfo:l,curveRadius:r}=this;if(l){const n=l.blockBounds,i=r?Lo():Ro(),o=i.geometry,{position:a,uv:f}=o.attributes;for(let u=0;u<f.count;u++){let c=n[0]+f.getX(u)*(n[2]-n[0]);const h=n[1]+f.getY(u)*(n[3]-n[1]);let d=0;r&&(d=r-Math.cos(c/r)*r,c=Math.sin(c/r)*r),a.setXYZ(u,c,h,d)}o.boundingSphere=this.geometry.boundingSphere,o.boundingBox=this.geometry.boundingBox,i.matrixWorld=this.matrixWorld,i.material.side=this.material.side,Xt.length=0,i.raycast(e,Xt);for(let u=0;u<Xt.length;u++)Xt[u].object=this,s.push(Xt[u])}}copy(e){const s=this.geometry;return super.copy(e),this.geometry=s,js.forEach(l=>{this[l]=e[l]}),this}clone(){return new this.constructor().copy(this)}};Oo.forEach(t=>{const e="_private_"+t;Object.defineProperty(Go.prototype,t,{get(){return this[e]},set(s){s!==this[e]&&(this[e]=s,this._needsSync=!0)}})});const Ys=rt.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:s="middle",font:l,fontSize:r=1,children:n,characters:i,onSync:o,...a},f)=>{const u=ko(({invalidate:p})=>p),[c]=rt.useState(()=>new Go),[h,d]=rt.useMemo(()=>{const p=[];let g="";return rt.Children.forEach(n,v=>{typeof v=="string"||typeof v=="number"?g+=v:p.push(v)}),[p,g]},[n]);return za(()=>new Promise(p=>Fs({font:l,characters:i},p)),["troika-text",l,i]),rt.useLayoutEffect(()=>void c.sync(()=>{u(),o&&o(c)})),rt.useEffect(()=>()=>c.dispose(),[c]),rt.createElement("primitive",Va({object:c,ref:f,font:l,text:d,anchorX:e,anchorY:s,fontSize:r,sdfGlyphSize:t},a),h)});class Js{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const s=this._partials;let l=0;for(let r=0;r<this._n&&r<32;r++){const n=s[r],i=e+n,o=Math.abs(e)<Math.abs(n)?e-(i-n):n-(i-e);o&&(s[l++]=o),e=i}return s[l]=e,this._n=l+1,this}valueOf(){const e=this._partials;let s=this._n,l,r,n,i=0;if(s>0){for(i=e[--s];s>0&&(l=i,r=e[--s],i=l+r,n=r-(i-l),!n););s>0&&(n<0&&e[s-1]<0||n>0&&e[s-1]>0)&&(r=n*2,l=i+r,r==l-i&&(i=l))}return i}}function*Ks(t){for(const e of t)yield*e}function Po(t){return Array.from(Ks(t))}var qs={value:()=>{}};function Io(){for(var t=0,e=arguments.length,s={},l;t<e;++t){if(!(l=arguments[t]+"")||l in s||/[\s.]/.test(l))throw new Error("illegal type: "+l);s[l]=[]}return new Gn(s)}function Gn(t){this._=t}function Qs(t,e){return t.trim().split(/^|\s+/).map(function(s){var l="",r=s.indexOf(".");if(r>=0&&(l=s.slice(r+1),s=s.slice(0,r)),s&&!e.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:l}})}Gn.prototype=Io.prototype={constructor:Gn,on:function(t,e){var s=this._,l=Qs(t+"",s),r,n=-1,i=l.length;if(arguments.length<2){for(;++n<i;)if((r=(t=l[n]).type)&&(r=Zs(s[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++n<i;)if(r=(t=l[n]).type)s[r]=Hi(s[r],t.name,e);else if(e==null)for(r in s)s[r]=Hi(s[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var s in e)t[s]=e[s].slice();return new Gn(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var s=new Array(r),l=0,r,n;l<r;++l)s[l]=arguments[l+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(n=this._[t],l=0,r=n.length;l<r;++l)n[l].value.apply(e,s)},apply:function(t,e,s){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var l=this._[t],r=0,n=l.length;r<n;++r)l[r].value.apply(e,s)}};function Zs(t,e){for(var s=0,l=t.length,r;s<l;++s)if((r=t[s]).name===e)return r.value}function Hi(t,e,s){for(var l=0,r=t.length;l<r;++l)if(t[l].name===e){t[l]=qs,t=t.slice(0,l).concat(t.slice(l+1));break}return s!=null&&t.push({name:e,value:s}),t}var Rr="http://www.w3.org/1999/xhtml";const Xi={svg:"http://www.w3.org/2000/svg",xhtml:Rr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Qn(t){var e=t+="",s=e.indexOf(":");return s>=0&&(e=t.slice(0,s))!=="xmlns"&&(t=t.slice(s+1)),Xi.hasOwnProperty(e)?{space:Xi[e],local:t}:t}function $s(t){return function(){var e=this.ownerDocument,s=this.namespaceURI;return s===Rr&&e.documentElement.namespaceURI===Rr?e.createElement(t):e.createElementNS(s,t)}}function ef(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Bo(t){var e=Qn(t);return(e.local?ef:$s)(e)}function tf(){}function qr(t){return t==null?tf:function(){return this.querySelector(t)}}function nf(t){typeof t!="function"&&(t=qr(t));for(var e=this._groups,s=e.length,l=new Array(s),r=0;r<s;++r)for(var n=e[r],i=n.length,o=l[r]=new Array(i),a,f,u=0;u<i;++u)(a=n[u])&&(f=t.call(a,a.__data__,u,n))&&("__data__"in a&&(f.__data__=a.__data__),o[u]=f);return new et(l,this._parents)}function rf(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function of(){return[]}function No(t){return t==null?of:function(){return this.querySelectorAll(t)}}function af(t){return function(){return rf(t.apply(this,arguments))}}function sf(t){typeof t=="function"?t=af(t):t=No(t);for(var e=this._groups,s=e.length,l=[],r=[],n=0;n<s;++n)for(var i=e[n],o=i.length,a,f=0;f<o;++f)(a=i[f])&&(l.push(t.call(a,a.__data__,f,i)),r.push(a));return new et(l,r)}function Wo(t){return function(){return this.matches(t)}}function zo(t){return function(e){return e.matches(t)}}var ff=Array.prototype.find;function lf(t){return function(){return ff.call(this.children,t)}}function uf(){return this.firstElementChild}function cf(t){return this.select(t==null?uf:lf(typeof t=="function"?t:zo(t)))}var hf=Array.prototype.filter;function df(){return Array.from(this.children)}function pf(t){return function(){return hf.call(this.children,t)}}function vf(t){return this.selectAll(t==null?df:pf(typeof t=="function"?t:zo(t)))}function gf(t){typeof t!="function"&&(t=Wo(t));for(var e=this._groups,s=e.length,l=new Array(s),r=0;r<s;++r)for(var n=e[r],i=n.length,o=l[r]=[],a,f=0;f<i;++f)(a=n[f])&&t.call(a,a.__data__,f,n)&&o.push(a);return new et(l,this._parents)}function Vo(t){return new Array(t.length)}function mf(){return new et(this._enter||this._groups.map(Vo),this._parents)}function Nn(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Nn.prototype={constructor:Nn,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function yf(t){return function(){return t}}function _f(t,e,s,l,r,n){for(var i=0,o,a=e.length,f=n.length;i<f;++i)(o=e[i])?(o.__data__=n[i],l[i]=o):s[i]=new Nn(t,n[i]);for(;i<a;++i)(o=e[i])&&(r[i]=o)}function xf(t,e,s,l,r,n,i){var o,a,f=new Map,u=e.length,c=n.length,h=new Array(u),d;for(o=0;o<u;++o)(a=e[o])&&(h[o]=d=i.call(a,a.__data__,o,e)+"",f.has(d)?r[o]=a:f.set(d,a));for(o=0;o<c;++o)d=i.call(t,n[o],o,n)+"",(a=f.get(d))?(l[o]=a,a.__data__=n[o],f.delete(d)):s[o]=new Nn(t,n[o]);for(o=0;o<u;++o)(a=e[o])&&f.get(h[o])===a&&(r[o]=a)}function wf(t){return t.__data__}function bf(t,e){if(!arguments.length)return Array.from(this,wf);var s=e?xf:_f,l=this._parents,r=this._groups;typeof t!="function"&&(t=yf(t));for(var n=r.length,i=new Array(n),o=new Array(n),a=new Array(n),f=0;f<n;++f){var u=l[f],c=r[f],h=c.length,d=Sf(t.call(u,u&&u.__data__,f,l)),p=d.length,g=o[f]=new Array(p),v=i[f]=new Array(p),A=a[f]=new Array(h);s(u,c,g,v,A,d,e);for(var _=0,x=0,y,S;_<p;++_)if(y=g[_]){for(_>=x&&(x=_+1);!(S=v[x])&&++x<p;);y._next=S||null}}return i=new et(i,l),i._enter=o,i._exit=a,i}function Sf(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Uf(){return new et(this._exit||this._groups.map(Vo),this._parents)}function kf(t,e,s){var l=this.enter(),r=this,n=this.exit();return typeof t=="function"?(l=t(l),l&&(l=l.selection())):l=l.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),s==null?n.remove():s(n),l&&r?l.merge(r).order():r}function Tf(t){for(var e=t.selection?t.selection():t,s=this._groups,l=e._groups,r=s.length,n=l.length,i=Math.min(r,n),o=new Array(r),a=0;a<i;++a)for(var f=s[a],u=l[a],c=f.length,h=o[a]=new Array(c),d,p=0;p<c;++p)(d=f[p]||u[p])&&(h[p]=d);for(;a<r;++a)o[a]=s[a];return new et(o,this._parents)}function Ef(){for(var t=this._groups,e=-1,s=t.length;++e<s;)for(var l=t[e],r=l.length-1,n=l[r],i;--r>=0;)(i=l[r])&&(n&&i.compareDocumentPosition(n)^4&&n.parentNode.insertBefore(i,n),n=i);return this}function Af(t){t||(t=Cf);function e(c,h){return c&&h?t(c.__data__,h.__data__):!c-!h}for(var s=this._groups,l=s.length,r=new Array(l),n=0;n<l;++n){for(var i=s[n],o=i.length,a=r[n]=new Array(o),f,u=0;u<o;++u)(f=i[u])&&(a[u]=f);a.sort(e)}return new et(r,this._parents).order()}function Cf(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ff(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Mf(){return Array.from(this)}function Df(){for(var t=this._groups,e=0,s=t.length;e<s;++e)for(var l=t[e],r=0,n=l.length;r<n;++r){var i=l[r];if(i)return i}return null}function Rf(){let t=0;for(const e of this)++t;return t}function Lf(){return!this.node()}function Of(t){for(var e=this._groups,s=0,l=e.length;s<l;++s)for(var r=e[s],n=0,i=r.length,o;n<i;++n)(o=r[n])&&t.call(o,o.__data__,n,r);return this}function Gf(t){return function(){this.removeAttribute(t)}}function Pf(t){return function(){this.removeAttributeNS(t.space,t.local)}}function If(t,e){return function(){this.setAttribute(t,e)}}function Bf(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Nf(t,e){return function(){var s=e.apply(this,arguments);s==null?this.removeAttribute(t):this.setAttribute(t,s)}}function Wf(t,e){return function(){var s=e.apply(this,arguments);s==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,s)}}function zf(t,e){var s=Qn(t);if(arguments.length<2){var l=this.node();return s.local?l.getAttributeNS(s.space,s.local):l.getAttribute(s)}return this.each((e==null?s.local?Pf:Gf:typeof e=="function"?s.local?Wf:Nf:s.local?Bf:If)(s,e))}function Ho(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Vf(t){return function(){this.style.removeProperty(t)}}function Hf(t,e,s){return function(){this.style.setProperty(t,e,s)}}function Xf(t,e,s){return function(){var l=e.apply(this,arguments);l==null?this.style.removeProperty(t):this.style.setProperty(t,l,s)}}function jf(t,e,s){return arguments.length>1?this.each((e==null?Vf:typeof e=="function"?Xf:Hf)(t,e,s??"")):Ft(this.node(),t)}function Ft(t,e){return t.style.getPropertyValue(e)||Ho(t).getComputedStyle(t,null).getPropertyValue(e)}function Yf(t){return function(){delete this[t]}}function Jf(t,e){return function(){this[t]=e}}function Kf(t,e){return function(){var s=e.apply(this,arguments);s==null?delete this[t]:this[t]=s}}function qf(t,e){return arguments.length>1?this.each((e==null?Yf:typeof e=="function"?Kf:Jf)(t,e)):this.node()[t]}function Xo(t){return t.trim().split(/^|\s+/)}function Qr(t){return t.classList||new jo(t)}function jo(t){this._node=t,this._names=Xo(t.getAttribute("class")||"")}jo.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Yo(t,e){for(var s=Qr(t),l=-1,r=e.length;++l<r;)s.add(e[l])}function Jo(t,e){for(var s=Qr(t),l=-1,r=e.length;++l<r;)s.remove(e[l])}function Qf(t){return function(){Yo(this,t)}}function Zf(t){return function(){Jo(this,t)}}function $f(t,e){return function(){(e.apply(this,arguments)?Yo:Jo)(this,t)}}function el(t,e){var s=Xo(t+"");if(arguments.length<2){for(var l=Qr(this.node()),r=-1,n=s.length;++r<n;)if(!l.contains(s[r]))return!1;return!0}return this.each((typeof e=="function"?$f:e?Qf:Zf)(s,e))}function tl(){this.textContent=""}function nl(t){return function(){this.textContent=t}}function rl(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function il(t){return arguments.length?this.each(t==null?tl:(typeof t=="function"?rl:nl)(t)):this.node().textContent}function ol(){this.innerHTML=""}function al(t){return function(){this.innerHTML=t}}function sl(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function fl(t){return arguments.length?this.each(t==null?ol:(typeof t=="function"?sl:al)(t)):this.node().innerHTML}function ll(){this.nextSibling&&this.parentNode.appendChild(this)}function ul(){return this.each(ll)}function cl(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hl(){return this.each(cl)}function dl(t){var e=typeof t=="function"?t:Bo(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function pl(){return null}function vl(t,e){var s=typeof t=="function"?t:Bo(t),l=e==null?pl:typeof e=="function"?e:qr(e);return this.select(function(){return this.insertBefore(s.apply(this,arguments),l.apply(this,arguments)||null)})}function gl(){var t=this.parentNode;t&&t.removeChild(this)}function ml(){return this.each(gl)}function yl(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _l(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function xl(t){return this.select(t?_l:yl)}function wl(t){return arguments.length?this.property("__data__",t):this.node().__data__}function bl(t){return function(e){t.call(this,e,this.__data__)}}function Sl(t){return t.trim().split(/^|\s+/).map(function(e){var s="",l=e.indexOf(".");return l>=0&&(s=e.slice(l+1),e=e.slice(0,l)),{type:e,name:s}})}function Ul(t){return function(){var e=this.__on;if(e){for(var s=0,l=-1,r=e.length,n;s<r;++s)n=e[s],(!t.type||n.type===t.type)&&n.name===t.name?this.removeEventListener(n.type,n.listener,n.options):e[++l]=n;++l?e.length=l:delete this.__on}}}function kl(t,e,s){return function(){var l=this.__on,r,n=bl(e);if(l){for(var i=0,o=l.length;i<o;++i)if((r=l[i]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=n,r.options=s),r.value=e;return}}this.addEventListener(t.type,n,s),r={type:t.type,name:t.name,value:e,listener:n,options:s},l?l.push(r):this.__on=[r]}}function Tl(t,e,s){var l=Sl(t+""),r,n=l.length,i;if(arguments.length<2){var o=this.node().__on;if(o){for(var a=0,f=o.length,u;a<f;++a)for(r=0,u=o[a];r<n;++r)if((i=l[r]).type===u.type&&i.name===u.name)return u.value}return}for(o=e?kl:Ul,r=0;r<n;++r)this.each(o(l[r],e,s));return this}function Ko(t,e,s){var l=Ho(t),r=l.CustomEvent;typeof r=="function"?r=new r(e,s):(r=l.document.createEvent("Event"),s?(r.initEvent(e,s.bubbles,s.cancelable),r.detail=s.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function El(t,e){return function(){return Ko(this,t,e)}}function Al(t,e){return function(){return Ko(this,t,e.apply(this,arguments))}}function Cl(t,e){return this.each((typeof e=="function"?Al:El)(t,e))}function*Fl(){for(var t=this._groups,e=0,s=t.length;e<s;++e)for(var l=t[e],r=0,n=l.length,i;r<n;++r)(i=l[r])&&(yield i)}var Ml=[null];function et(t,e){this._groups=t,this._parents=e}function un(){return new et([[document.documentElement]],Ml)}function Dl(){return this}et.prototype=un.prototype={constructor:et,select:nf,selectAll:sf,selectChild:cf,selectChildren:vf,filter:gf,data:bf,enter:mf,exit:Uf,join:kf,merge:Tf,selection:Dl,order:Ef,sort:Af,call:Ff,nodes:Mf,node:Df,size:Rf,empty:Lf,each:Of,attr:zf,style:jf,property:qf,classed:el,text:il,html:fl,raise:ul,lower:hl,append:dl,insert:vl,remove:ml,clone:xl,datum:wl,on:Tl,dispatch:Cl,[Symbol.iterator]:Fl};function Zr(t,e,s){t.prototype=e.prototype=s,s.constructor=t}function qo(t,e){var s=Object.create(t.prototype);for(var l in e)s[l]=e[l];return s}function cn(){}var tn=.7,Wn=1/tn,Ct="\\s*([+-]?\\d+)\\s*",nn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",it="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rl=/^#([0-9a-f]{3,8})$/,Ll=new RegExp(`^rgb\\(${Ct},${Ct},${Ct}\\)$`),Ol=new RegExp(`^rgb\\(${it},${it},${it}\\)$`),Gl=new RegExp(`^rgba\\(${Ct},${Ct},${Ct},${nn}\\)$`),Pl=new RegExp(`^rgba\\(${it},${it},${it},${nn}\\)$`),Il=new RegExp(`^hsl\\(${nn},${it},${it}\\)$`),Bl=new RegExp(`^hsla\\(${nn},${it},${it},${nn}\\)$`),ji={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zr(cn,rn,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Yi,formatHex:Yi,formatHex8:Nl,formatHsl:Wl,formatRgb:Ji,toString:Ji});function Yi(){return this.rgb().formatHex()}function Nl(){return this.rgb().formatHex8()}function Wl(){return Qo(this).formatHsl()}function Ji(){return this.rgb().formatRgb()}function rn(t){var e,s;return t=(t+"").trim().toLowerCase(),(e=Rl.exec(t))?(s=e[1].length,e=parseInt(e[1],16),s===6?Ki(e):s===3?new Xe(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):s===8?En(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):s===4?En(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ll.exec(t))?new Xe(e[1],e[2],e[3],1):(e=Ol.exec(t))?new Xe(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Gl.exec(t))?En(e[1],e[2],e[3],e[4]):(e=Pl.exec(t))?En(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Il.exec(t))?Zi(e[1],e[2]/100,e[3]/100,1):(e=Bl.exec(t))?Zi(e[1],e[2]/100,e[3]/100,e[4]):ji.hasOwnProperty(t)?Ki(ji[t]):t==="transparent"?new Xe(NaN,NaN,NaN,0):null}function Ki(t){return new Xe(t>>16&255,t>>8&255,t&255,1)}function En(t,e,s,l){return l<=0&&(t=e=s=NaN),new Xe(t,e,s,l)}function zl(t){return t instanceof cn||(t=rn(t)),t?(t=t.rgb(),new Xe(t.r,t.g,t.b,t.opacity)):new Xe}function Lr(t,e,s,l){return arguments.length===1?zl(t):new Xe(t,e,s,l??1)}function Xe(t,e,s,l){this.r=+t,this.g=+e,this.b=+s,this.opacity=+l}Zr(Xe,Lr,qo(cn,{brighter(t){return t=t==null?Wn:Math.pow(Wn,t),new Xe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?tn:Math.pow(tn,t),new Xe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Xe(wt(this.r),wt(this.g),wt(this.b),zn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qi,formatHex:qi,formatHex8:Vl,formatRgb:Qi,toString:Qi}));function qi(){return`#${_t(this.r)}${_t(this.g)}${_t(this.b)}`}function Vl(){return`#${_t(this.r)}${_t(this.g)}${_t(this.b)}${_t((isNaN(this.opacity)?1:this.opacity)*255)}`}function Qi(){const t=zn(this.opacity);return`${t===1?"rgb(":"rgba("}${wt(this.r)}, ${wt(this.g)}, ${wt(this.b)}${t===1?")":`, ${t})`}`}function zn(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function wt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function _t(t){return t=wt(t),(t<16?"0":"")+t.toString(16)}function Zi(t,e,s,l){return l<=0?t=e=s=NaN:s<=0||s>=1?t=e=NaN:e<=0&&(t=NaN),new $e(t,e,s,l)}function Qo(t){if(t instanceof $e)return new $e(t.h,t.s,t.l,t.opacity);if(t instanceof cn||(t=rn(t)),!t)return new $e;if(t instanceof $e)return t;t=t.rgb();var e=t.r/255,s=t.g/255,l=t.b/255,r=Math.min(e,s,l),n=Math.max(e,s,l),i=NaN,o=n-r,a=(n+r)/2;return o?(e===n?i=(s-l)/o+(s<l)*6:s===n?i=(l-e)/o+2:i=(e-s)/o+4,o/=a<.5?n+r:2-n-r,i*=60):o=a>0&&a<1?0:i,new $e(i,o,a,t.opacity)}function Hl(t,e,s,l){return arguments.length===1?Qo(t):new $e(t,e,s,l??1)}function $e(t,e,s,l){this.h=+t,this.s=+e,this.l=+s,this.opacity=+l}Zr($e,Hl,qo(cn,{brighter(t){return t=t==null?Wn:Math.pow(Wn,t),new $e(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?tn:Math.pow(tn,t),new $e(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,s=this.l,l=s+(s<.5?s:1-s)*e,r=2*s-l;return new Xe(kr(t>=240?t-240:t+120,r,l),kr(t,r,l),kr(t<120?t+240:t-120,r,l),this.opacity)},clamp(){return new $e($i(this.h),An(this.s),An(this.l),zn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=zn(this.opacity);return`${t===1?"hsl(":"hsla("}${$i(this.h)}, ${An(this.s)*100}%, ${An(this.l)*100}%${t===1?")":`, ${t})`}`}}));function $i(t){return t=(t||0)%360,t<0?t+360:t}function An(t){return Math.max(0,Math.min(1,t||0))}function kr(t,e,s){return(t<60?e+(s-e)*t/60:t<180?s:t<240?e+(s-e)*(240-t)/60:e)*255}const Zo=t=>()=>t;function Xl(t,e){return function(s){return t+s*e}}function jl(t,e,s){return t=Math.pow(t,s),e=Math.pow(e,s)-t,s=1/s,function(l){return Math.pow(t+l*e,s)}}function Yl(t){return(t=+t)==1?$o:function(e,s){return s-e?jl(e,s,t):Zo(isNaN(e)?s:e)}}function $o(t,e){var s=e-t;return s?Xl(t,s):Zo(isNaN(t)?e:t)}const eo=function t(e){var s=Yl(e);function l(r,n){var i=s((r=Lr(r)).r,(n=Lr(n)).r),o=s(r.g,n.g),a=s(r.b,n.b),f=$o(r.opacity,n.opacity);return function(u){return r.r=i(u),r.g=o(u),r.b=a(u),r.opacity=f(u),r+""}}return l.gamma=t,l}(1);function vt(t,e){return t=+t,e=+e,function(s){return t*(1-s)+e*s}}var Or=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tr=new RegExp(Or.source,"g");function Jl(t){return function(){return t}}function Kl(t){return function(e){return t(e)+""}}function ql(t,e){var s=Or.lastIndex=Tr.lastIndex=0,l,r,n,i=-1,o=[],a=[];for(t=t+"",e=e+"";(l=Or.exec(t))&&(r=Tr.exec(e));)(n=r.index)>s&&(n=e.slice(s,n),o[i]?o[i]+=n:o[++i]=n),(l=l[0])===(r=r[0])?o[i]?o[i]+=r:o[++i]=r:(o[++i]=null,a.push({i,x:vt(l,r)})),s=Tr.lastIndex;return s<e.length&&(n=e.slice(s),o[i]?o[i]+=n:o[++i]=n),o.length<2?a[0]?Kl(a[0].x):Jl(e):(e=a.length,function(f){for(var u=0,c;u<e;++u)o[(c=a[u]).i]=c.x(f);return o.join("")})}var to=180/Math.PI,Gr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ea(t,e,s,l,r,n){var i,o,a;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(a=t*s+e*l)&&(s-=t*a,l-=e*a),(o=Math.sqrt(s*s+l*l))&&(s/=o,l/=o,a/=o),t*l<e*s&&(t=-t,e=-e,a=-a,i=-i),{translateX:r,translateY:n,rotate:Math.atan2(e,t)*to,skewX:Math.atan(a)*to,scaleX:i,scaleY:o}}var Cn;function Ql(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Gr:ea(e.a,e.b,e.c,e.d,e.e,e.f)}function Zl(t){return t==null||(Cn||(Cn=document.createElementNS("http://www.w3.org/2000/svg","g")),Cn.setAttribute("transform",t),!(t=Cn.transform.baseVal.consolidate()))?Gr:(t=t.matrix,ea(t.a,t.b,t.c,t.d,t.e,t.f))}function ta(t,e,s,l){function r(f){return f.length?f.pop()+" ":""}function n(f,u,c,h,d,p){if(f!==c||u!==h){var g=d.push("translate(",null,e,null,s);p.push({i:g-4,x:vt(f,c)},{i:g-2,x:vt(u,h)})}else(c||h)&&d.push("translate("+c+e+h+s)}function i(f,u,c,h){f!==u?(f-u>180?u+=360:u-f>180&&(f+=360),h.push({i:c.push(r(c)+"rotate(",null,l)-2,x:vt(f,u)})):u&&c.push(r(c)+"rotate("+u+l)}function o(f,u,c,h){f!==u?h.push({i:c.push(r(c)+"skewX(",null,l)-2,x:vt(f,u)}):u&&c.push(r(c)+"skewX("+u+l)}function a(f,u,c,h,d,p){if(f!==c||u!==h){var g=d.push(r(d)+"scale(",null,",",null,")");p.push({i:g-4,x:vt(f,c)},{i:g-2,x:vt(u,h)})}else(c!==1||h!==1)&&d.push(r(d)+"scale("+c+","+h+")")}return function(f,u){var c=[],h=[];return f=t(f),u=t(u),n(f.translateX,f.translateY,u.translateX,u.translateY,c,h),i(f.rotate,u.rotate,c,h),o(f.skewX,u.skewX,c,h),a(f.scaleX,f.scaleY,u.scaleX,u.scaleY,c,h),f=u=null,function(d){for(var p=-1,g=h.length,v;++p<g;)c[(v=h[p]).i]=v.x(d);return c.join("")}}}var $l=ta(Ql,"px, ","px)","deg)"),eu=ta(Zl,", ",")",")"),Mt=0,Yt=0,jt=0,na=1e3,Vn,Jt,Hn=0,bt=0,Zn=0,on=typeof performance=="object"&&performance.now?performance:Date,ra=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $r(){return bt||(ra(tu),bt=on.now()+Zn)}function tu(){bt=0}function Xn(){this._call=this._time=this._next=null}Xn.prototype=ia.prototype={constructor:Xn,restart:function(t,e,s){if(typeof t!="function")throw new TypeError("callback is not a function");s=(s==null?$r():+s)+(e==null?0:+e),!this._next&&Jt!==this&&(Jt?Jt._next=this:Vn=this,Jt=this),this._call=t,this._time=s,Pr()},stop:function(){this._call&&(this._call=null,this._time=1/0,Pr())}};function ia(t,e,s){var l=new Xn;return l.restart(t,e,s),l}function nu(){$r(),++Mt;for(var t=Vn,e;t;)(e=bt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Mt}function no(){bt=(Hn=on.now())+Zn,Mt=Yt=0;try{nu()}finally{Mt=0,iu(),bt=0}}function ru(){var t=on.now(),e=t-Hn;e>na&&(Zn-=e,Hn=t)}function iu(){for(var t,e=Vn,s,l=1/0;e;)e._call?(l>e._time&&(l=e._time),t=e,e=e._next):(s=e._next,e._next=null,e=t?t._next=s:Vn=s);Jt=t,Pr(l)}function Pr(t){if(!Mt){Yt&&(Yt=clearTimeout(Yt));var e=t-bt;e>24?(t<1/0&&(Yt=setTimeout(no,t-on.now()-Zn)),jt&&(jt=clearInterval(jt))):(jt||(Hn=on.now(),jt=setInterval(ru,na)),Mt=1,ra(no))}}function ro(t,e,s){var l=new Xn;return e=e==null?0:+e,l.restart(r=>{l.stop(),t(r+e)},e,s),l}var ou=Io("start","end","cancel","interrupt"),au=[],oa=0,io=1,Ir=2,Pn=3,oo=4,Br=5,In=6;function $n(t,e,s,l,r,n){var i=t.__transition;if(!i)t.__transition={};else if(s in i)return;su(t,s,{name:e,index:l,group:r,on:ou,tween:au,time:n.time,delay:n.delay,duration:n.duration,ease:n.ease,timer:null,state:oa})}function ei(t,e){var s=tt(t,e);if(s.state>oa)throw new Error("too late; already scheduled");return s}function ot(t,e){var s=tt(t,e);if(s.state>Pn)throw new Error("too late; already running");return s}function tt(t,e){var s=t.__transition;if(!s||!(s=s[e]))throw new Error("transition not found");return s}function su(t,e,s){var l=t.__transition,r;l[e]=s,s.timer=ia(n,0,s.time);function n(f){s.state=io,s.timer.restart(i,s.delay,s.time),s.delay<=f&&i(f-s.delay)}function i(f){var u,c,h,d;if(s.state!==io)return a();for(u in l)if(d=l[u],d.name===s.name){if(d.state===Pn)return ro(i);d.state===oo?(d.state=In,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete l[u]):+u<e&&(d.state=In,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete l[u])}if(ro(function(){s.state===Pn&&(s.state=oo,s.timer.restart(o,s.delay,s.time),o(f))}),s.state=Ir,s.on.call("start",t,t.__data__,s.index,s.group),s.state===Ir){for(s.state=Pn,r=new Array(h=s.tween.length),u=0,c=-1;u<h;++u)(d=s.tween[u].value.call(t,t.__data__,s.index,s.group))&&(r[++c]=d);r.length=c+1}}function o(f){for(var u=f<s.duration?s.ease.call(null,f/s.duration):(s.timer.restart(a),s.state=Br,1),c=-1,h=r.length;++c<h;)r[c].call(t,u);s.state===Br&&(s.on.call("end",t,t.__data__,s.index,s.group),a())}function a(){s.state=In,s.timer.stop(),delete l[e];for(var f in l)return;delete t.__transition}}function fu(t,e){var s=t.__transition,l,r,n=!0,i;if(s){e=e==null?null:e+"";for(i in s){if((l=s[i]).name!==e){n=!1;continue}r=l.state>Ir&&l.state<Br,l.state=In,l.timer.stop(),l.on.call(r?"interrupt":"cancel",t,t.__data__,l.index,l.group),delete s[i]}n&&delete t.__transition}}function lu(t){return this.each(function(){fu(this,t)})}function uu(t,e){var s,l;return function(){var r=ot(this,t),n=r.tween;if(n!==s){l=s=n;for(var i=0,o=l.length;i<o;++i)if(l[i].name===e){l=l.slice(),l.splice(i,1);break}}r.tween=l}}function cu(t,e,s){var l,r;if(typeof s!="function")throw new Error;return function(){var n=ot(this,t),i=n.tween;if(i!==l){r=(l=i).slice();for(var o={name:e,value:s},a=0,f=r.length;a<f;++a)if(r[a].name===e){r[a]=o;break}a===f&&r.push(o)}n.tween=r}}function hu(t,e){var s=this._id;if(t+="",arguments.length<2){for(var l=tt(this.node(),s).tween,r=0,n=l.length,i;r<n;++r)if((i=l[r]).name===t)return i.value;return null}return this.each((e==null?uu:cu)(s,t,e))}function ti(t,e,s){var l=t._id;return t.each(function(){var r=ot(this,l);(r.value||(r.value={}))[e]=s.apply(this,arguments)}),function(r){return tt(r,l).value[e]}}function aa(t,e){var s;return(typeof e=="number"?vt:e instanceof rn?eo:(s=rn(e))?(e=s,eo):ql)(t,e)}function du(t){return function(){this.removeAttribute(t)}}function pu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vu(t,e,s){var l,r=s+"",n;return function(){var i=this.getAttribute(t);return i===r?null:i===l?n:n=e(l=i,s)}}function gu(t,e,s){var l,r=s+"",n;return function(){var i=this.getAttributeNS(t.space,t.local);return i===r?null:i===l?n:n=e(l=i,s)}}function mu(t,e,s){var l,r,n;return function(){var i,o=s(this),a;return o==null?void this.removeAttribute(t):(i=this.getAttribute(t),a=o+"",i===a?null:i===l&&a===r?n:(r=a,n=e(l=i,o)))}}function yu(t,e,s){var l,r,n;return function(){var i,o=s(this),a;return o==null?void this.removeAttributeNS(t.space,t.local):(i=this.getAttributeNS(t.space,t.local),a=o+"",i===a?null:i===l&&a===r?n:(r=a,n=e(l=i,o)))}}function _u(t,e){var s=Qn(t),l=s==="transform"?eu:aa;return this.attrTween(t,typeof e=="function"?(s.local?yu:mu)(s,l,ti(this,"attr."+t,e)):e==null?(s.local?pu:du)(s):(s.local?gu:vu)(s,l,e))}function xu(t,e){return function(s){this.setAttribute(t,e.call(this,s))}}function wu(t,e){return function(s){this.setAttributeNS(t.space,t.local,e.call(this,s))}}function bu(t,e){var s,l;function r(){var n=e.apply(this,arguments);return n!==l&&(s=(l=n)&&wu(t,n)),s}return r._value=e,r}function Su(t,e){var s,l;function r(){var n=e.apply(this,arguments);return n!==l&&(s=(l=n)&&xu(t,n)),s}return r._value=e,r}function Uu(t,e){var s="attr."+t;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;var l=Qn(t);return this.tween(s,(l.local?bu:Su)(l,e))}function ku(t,e){return function(){ei(this,t).delay=+e.apply(this,arguments)}}function Tu(t,e){return e=+e,function(){ei(this,t).delay=e}}function Eu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ku:Tu)(e,t)):tt(this.node(),e).delay}function Au(t,e){return function(){ot(this,t).duration=+e.apply(this,arguments)}}function Cu(t,e){return e=+e,function(){ot(this,t).duration=e}}function Fu(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Au:Cu)(e,t)):tt(this.node(),e).duration}function Mu(t,e){if(typeof e!="function")throw new Error;return function(){ot(this,t).ease=e}}function Du(t){var e=this._id;return arguments.length?this.each(Mu(e,t)):tt(this.node(),e).ease}function Ru(t,e){return function(){var s=e.apply(this,arguments);if(typeof s!="function")throw new Error;ot(this,t).ease=s}}function Lu(t){if(typeof t!="function")throw new Error;return this.each(Ru(this._id,t))}function Ou(t){typeof t!="function"&&(t=Wo(t));for(var e=this._groups,s=e.length,l=new Array(s),r=0;r<s;++r)for(var n=e[r],i=n.length,o=l[r]=[],a,f=0;f<i;++f)(a=n[f])&&t.call(a,a.__data__,f,n)&&o.push(a);return new lt(l,this._parents,this._name,this._id)}function Gu(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,s=t._groups,l=e.length,r=s.length,n=Math.min(l,r),i=new Array(l),o=0;o<n;++o)for(var a=e[o],f=s[o],u=a.length,c=i[o]=new Array(u),h,d=0;d<u;++d)(h=a[d]||f[d])&&(c[d]=h);for(;o<l;++o)i[o]=e[o];return new lt(i,this._parents,this._name,this._id)}function Pu(t){return(t+"").trim().split(/^|\s+/).every(function(e){var s=e.indexOf(".");return s>=0&&(e=e.slice(0,s)),!e||e==="start"})}function Iu(t,e,s){var l,r,n=Pu(e)?ei:ot;return function(){var i=n(this,t),o=i.on;o!==l&&(r=(l=o).copy()).on(e,s),i.on=r}}function Bu(t,e){var s=this._id;return arguments.length<2?tt(this.node(),s).on.on(t):this.each(Iu(s,t,e))}function Nu(t){return function(){var e=this.parentNode;for(var s in this.__transition)if(+s!==t)return;e&&e.removeChild(this)}}function Wu(){return this.on("end.remove",Nu(this._id))}function zu(t){var e=this._name,s=this._id;typeof t!="function"&&(t=qr(t));for(var l=this._groups,r=l.length,n=new Array(r),i=0;i<r;++i)for(var o=l[i],a=o.length,f=n[i]=new Array(a),u,c,h=0;h<a;++h)(u=o[h])&&(c=t.call(u,u.__data__,h,o))&&("__data__"in u&&(c.__data__=u.__data__),f[h]=c,$n(f[h],e,s,h,f,tt(u,s)));return new lt(n,this._parents,e,s)}function Vu(t){var e=this._name,s=this._id;typeof t!="function"&&(t=No(t));for(var l=this._groups,r=l.length,n=[],i=[],o=0;o<r;++o)for(var a=l[o],f=a.length,u,c=0;c<f;++c)if(u=a[c]){for(var h=t.call(u,u.__data__,c,a),d,p=tt(u,s),g=0,v=h.length;g<v;++g)(d=h[g])&&$n(d,e,s,g,h,p);n.push(h),i.push(u)}return new lt(n,i,e,s)}var Hu=un.prototype.constructor;function Xu(){return new Hu(this._groups,this._parents)}function ju(t,e){var s,l,r;return function(){var n=Ft(this,t),i=(this.style.removeProperty(t),Ft(this,t));return n===i?null:n===s&&i===l?r:r=e(s=n,l=i)}}function sa(t){return function(){this.style.removeProperty(t)}}function Yu(t,e,s){var l,r=s+"",n;return function(){var i=Ft(this,t);return i===r?null:i===l?n:n=e(l=i,s)}}function Ju(t,e,s){var l,r,n;return function(){var i=Ft(this,t),o=s(this),a=o+"";return o==null&&(a=o=(this.style.removeProperty(t),Ft(this,t))),i===a?null:i===l&&a===r?n:(r=a,n=e(l=i,o))}}function Ku(t,e){var s,l,r,n="style."+e,i="end."+n,o;return function(){var a=ot(this,t),f=a.on,u=a.value[n]==null?o||(o=sa(e)):void 0;(f!==s||r!==u)&&(l=(s=f).copy()).on(i,r=u),a.on=l}}function qu(t,e,s){var l=(t+="")=="transform"?$l:aa;return e==null?this.styleTween(t,ju(t,l)).on("end.style."+t,sa(t)):typeof e=="function"?this.styleTween(t,Ju(t,l,ti(this,"style."+t,e))).each(Ku(this._id,t)):this.styleTween(t,Yu(t,l,e),s).on("end.style."+t,null)}function Qu(t,e,s){return function(l){this.style.setProperty(t,e.call(this,l),s)}}function Zu(t,e,s){var l,r;function n(){var i=e.apply(this,arguments);return i!==r&&(l=(r=i)&&Qu(t,i,s)),l}return n._value=e,n}function $u(t,e,s){var l="style."+(t+="");if(arguments.length<2)return(l=this.tween(l))&&l._value;if(e==null)return this.tween(l,null);if(typeof e!="function")throw new Error;return this.tween(l,Zu(t,e,s??""))}function ec(t){return function(){this.textContent=t}}function tc(t){return function(){var e=t(this);this.textContent=e??""}}function nc(t){return this.tween("text",typeof t=="function"?tc(ti(this,"text",t)):ec(t==null?"":t+""))}function rc(t){return function(e){this.textContent=t.call(this,e)}}function ic(t){var e,s;function l(){var r=t.apply(this,arguments);return r!==s&&(e=(s=r)&&rc(r)),e}return l._value=t,l}function oc(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,ic(t))}function ac(){for(var t=this._name,e=this._id,s=fa(),l=this._groups,r=l.length,n=0;n<r;++n)for(var i=l[n],o=i.length,a,f=0;f<o;++f)if(a=i[f]){var u=tt(a,e);$n(a,t,s,f,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new lt(l,this._parents,t,s)}function sc(){var t,e,s=this,l=s._id,r=s.size();return new Promise(function(n,i){var o={value:i},a={value:function(){--r===0&&n()}};s.each(function(){var f=ot(this,l),u=f.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(o),e._.interrupt.push(o),e._.end.push(a)),f.on=e}),r===0&&n()})}var fc=0;function lt(t,e,s,l){this._groups=t,this._parents=e,this._name=s,this._id=l}function fa(){return++fc}var ft=un.prototype;lt.prototype={constructor:lt,select:zu,selectAll:Vu,selectChild:ft.selectChild,selectChildren:ft.selectChildren,filter:Ou,merge:Gu,selection:Xu,transition:ac,call:ft.call,nodes:ft.nodes,node:ft.node,size:ft.size,empty:ft.empty,each:ft.each,on:Bu,attr:_u,attrTween:Uu,style:qu,styleTween:$u,text:nc,textTween:oc,remove:Wu,tween:hu,delay:Eu,duration:Fu,ease:Du,easeVarying:Lu,end:sc,[Symbol.iterator]:ft[Symbol.iterator]};function lc(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var uc={time:null,delay:0,duration:250,ease:lc};function cc(t,e){for(var s;!(s=t.__transition)||!(s=s[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return s}function hc(t){var e,s;t instanceof lt?(e=t._id,t=t._name):(e=fa(),(s=uc).time=$r(),t=t==null?null:t+"");for(var l=this._groups,r=l.length,n=0;n<r;++n)for(var i=l[n],o=i.length,a,f=0;f<o;++f)(a=i[f])&&$n(a,t,e,f,i,s||cc(a,e));return new lt(l,this._parents,t,e)}un.prototype.interrupt=lu;un.prototype.transition=hc;var ke=1e-6,dc=1e-12,_e=Math.PI,je=_e/2,ao=_e/4,Ke=_e*2,Je=180/_e,Oe=_e/180,Me=Math.abs,la=Math.atan,an=Math.atan2,De=Math.cos,pc=Math.exp,vc=Math.log,Re=Math.sin,gc=Math.sign||function(t){return t>0?1:t<0?-1:0},er=Math.sqrt,mc=Math.tan;function yc(t){return t>1?0:t<-1?_e:Math.acos(t)}function sn(t){return t>1?je:t<-1?-je:Math.asin(t)}function Kt(){}function jn(t,e){t&&fo.hasOwnProperty(t.type)&&fo[t.type](t,e)}var so={Feature:function(t,e){jn(t.geometry,e)},FeatureCollection:function(t,e){for(var s=t.features,l=-1,r=s.length;++l<r;)jn(s[l].geometry,e)}},fo={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var s=t.coordinates,l=-1,r=s.length;++l<r;)t=s[l],e.point(t[0],t[1],t[2])},LineString:function(t,e){Nr(t.coordinates,e,0)},MultiLineString:function(t,e){for(var s=t.coordinates,l=-1,r=s.length;++l<r;)Nr(s[l],e,0)},Polygon:function(t,e){lo(t.coordinates,e)},MultiPolygon:function(t,e){for(var s=t.coordinates,l=-1,r=s.length;++l<r;)lo(s[l],e)},GeometryCollection:function(t,e){for(var s=t.geometries,l=-1,r=s.length;++l<r;)jn(s[l],e)}};function Nr(t,e,s){var l=-1,r=t.length-s,n;for(e.lineStart();++l<r;)n=t[l],e.point(n[0],n[1],n[2]);e.lineEnd()}function lo(t,e){var s=-1,l=t.length;for(e.polygonStart();++s<l;)Nr(t[s],e,1);e.polygonEnd()}function _c(t,e){t&&so.hasOwnProperty(t.type)?so[t.type](t,e):jn(t,e)}function Wr(t){return[an(t[1],t[0]),sn(t[2])]}function Dt(t){var e=t[0],s=t[1],l=De(s);return[l*De(e),l*Re(e),Re(s)]}function Fn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Yn(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Er(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Mn(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function zr(t){var e=er(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Vr(t,e){function s(l,r){return l=t(l,r),e(l[0],l[1])}return t.invert&&e.invert&&(s.invert=function(l,r){return l=e.invert(l,r),l&&t.invert(l[0],l[1])}),s}function Hr(t,e){return Me(t)>_e&&(t-=Math.round(t/Ke)*Ke),[t,e]}Hr.invert=Hr;function ua(t,e,s){return(t%=Ke)?e||s?Vr(co(t),ho(e,s)):co(t):e||s?ho(e,s):Hr}function uo(t){return function(e,s){return e+=t,Me(e)>_e&&(e-=Math.round(e/Ke)*Ke),[e,s]}}function co(t){var e=uo(t);return e.invert=uo(-t),e}function ho(t,e){var s=De(t),l=Re(t),r=De(e),n=Re(e);function i(o,a){var f=De(a),u=De(o)*f,c=Re(o)*f,h=Re(a),d=h*s+u*l;return[an(c*r-d*n,u*s-h*l),sn(d*r+c*n)]}return i.invert=function(o,a){var f=De(a),u=De(o)*f,c=Re(o)*f,h=Re(a),d=h*r-c*n;return[an(c*r+h*n,u*s+d*l),sn(d*s-u*l)]},i}function xc(t){t=ua(t[0]*Oe,t[1]*Oe,t.length>2?t[2]*Oe:0);function e(s){return s=t(s[0]*Oe,s[1]*Oe),s[0]*=Je,s[1]*=Je,s}return e.invert=function(s){return s=t.invert(s[0]*Oe,s[1]*Oe),s[0]*=Je,s[1]*=Je,s},e}function wc(t,e,s,l,r,n){if(s){var i=De(e),o=Re(e),a=l*s;r==null?(r=e+l*Ke,n=e-a/2):(r=po(i,r),n=po(i,n),(l>0?r<n:r>n)&&(r+=l*Ke));for(var f,u=r;l>0?u>n:u<n;u-=a)f=Wr([i,-o*De(u),-o*Re(u)]),t.point(f[0],f[1])}}function po(t,e){e=Dt(e),e[0]-=t,zr(e);var s=yc(-e[1]);return((-e[2]<0?-s:s)+Ke-ke)%Ke}function ca(){var t=[],e;return{point:function(s,l,r){e.push([s,l,r])},lineStart:function(){t.push(e=[])},lineEnd:Kt,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var s=t;return t=[],e=null,s}}}function Bn(t,e){return Me(t[0]-e[0])<ke&&Me(t[1]-e[1])<ke}function Dn(t,e,s,l){this.x=t,this.z=e,this.o=s,this.e=l,this.v=!1,this.n=this.p=null}function ha(t,e,s,l,r){var n=[],i=[],o,a;if(t.forEach(function(p){if(!((g=p.length-1)<=0)){var g,v=p[0],A=p[g],_;if(Bn(v,A)){if(!v[2]&&!A[2]){for(r.lineStart(),o=0;o<g;++o)r.point((v=p[o])[0],v[1]);r.lineEnd();return}A[0]+=2*ke}n.push(_=new Dn(v,p,null,!0)),i.push(_.o=new Dn(v,null,_,!1)),n.push(_=new Dn(A,p,null,!1)),i.push(_.o=new Dn(A,null,_,!0))}}),!!n.length){for(i.sort(e),vo(n),vo(i),o=0,a=i.length;o<a;++o)i[o].e=s=!s;for(var f=n[0],u,c;;){for(var h=f,d=!0;h.v;)if((h=h.n)===f)return;u=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(o=0,a=u.length;o<a;++o)r.point((c=u[o])[0],c[1]);else l(h.x,h.n.x,1,r);h=h.n}else{if(d)for(u=h.p.z,o=u.length-1;o>=0;--o)r.point((c=u[o])[0],c[1]);else l(h.x,h.p.x,-1,r);h=h.p}h=h.o,u=h.z,d=!d}while(!h.v);r.lineEnd()}}}function vo(t){if(e=t.length){for(var e,s=0,l=t[0],r;++s<e;)l.n=r=t[s],r.p=l,l=r;l.n=r=t[0],r.p=l}}function Ar(t){return Me(t[0])<=_e?t[0]:gc(t[0])*((Me(t[0])+_e)%Ke-_e)}function bc(t,e){var s=Ar(e),l=e[1],r=Re(l),n=[Re(s),-De(s),0],i=0,o=0,a=new Js;r===1?l=je+ke:r===-1&&(l=-je-ke);for(var f=0,u=t.length;f<u;++f)if(h=(c=t[f]).length)for(var c,h,d=c[h-1],p=Ar(d),g=d[1]/2+ao,v=Re(g),A=De(g),_=0;_<h;++_,p=y,v=C,A=U,d=x){var x=c[_],y=Ar(x),S=x[1]/2+ao,C=Re(S),U=De(S),k=y-p,O=k>=0?1:-1,R=O*k,N=R>_e,w=v*C;if(a.add(an(w*O*Re(R),A*U+w*De(R))),i+=N?k+O*Ke:k,N^p>=s^y>=s){var D=Yn(Dt(d),Dt(x));zr(D);var E=Yn(n,D);zr(E);var b=(N^k>=0?-1:1)*sn(E[2]);(l>b||l===b&&(D[0]||D[1]))&&(o+=N^k>=0?1:-1)}}return(i<-ke||i<ke&&a<-dc)^o&1}function da(t,e,s,l){return function(r){var n=e(r),i=ca(),o=e(i),a=!1,f,u,c,h={point:d,lineStart:g,lineEnd:v,polygonStart:function(){h.point=A,h.lineStart=_,h.lineEnd=x,u=[],f=[]},polygonEnd:function(){h.point=d,h.lineStart=g,h.lineEnd=v,u=Po(u);var y=bc(f,l);u.length?(a||(r.polygonStart(),a=!0),ha(u,Uc,y,s,r)):y&&(a||(r.polygonStart(),a=!0),r.lineStart(),s(null,null,1,r),r.lineEnd()),a&&(r.polygonEnd(),a=!1),u=f=null},sphere:function(){r.polygonStart(),r.lineStart(),s(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(y,S){t(y,S)&&r.point(y,S)}function p(y,S){n.point(y,S)}function g(){h.point=p,n.lineStart()}function v(){h.point=d,n.lineEnd()}function A(y,S){c.push([y,S]),o.point(y,S)}function _(){o.lineStart(),c=[]}function x(){A(c[0][0],c[0][1]),o.lineEnd();var y=o.clean(),S=i.result(),C,U=S.length,k,O,R;if(c.pop(),f.push(c),c=null,!!U){if(y&1){if(O=S[0],(k=O.length-1)>0){for(a||(r.polygonStart(),a=!0),r.lineStart(),C=0;C<k;++C)r.point((R=O[C])[0],R[1]);r.lineEnd()}return}U>1&&y&2&&S.push(S.pop().concat(S.shift())),u.push(S.filter(Sc))}}return h}}function Sc(t){return t.length>1}function Uc(t,e){return((t=t.x)[0]<0?t[1]-je-ke:je-t[1])-((e=e.x)[0]<0?e[1]-je-ke:je-e[1])}const go=da(function(){return!0},kc,Ec,[-_e,-je]);function kc(t){var e=NaN,s=NaN,l=NaN,r;return{lineStart:function(){t.lineStart(),r=1},point:function(n,i){var o=n>0?_e:-_e,a=Me(n-e);Me(a-_e)<ke?(t.point(e,s=(s+i)/2>0?je:-je),t.point(l,s),t.lineEnd(),t.lineStart(),t.point(o,s),t.point(n,s),r=0):l!==o&&a>=_e&&(Me(e-l)<ke&&(e-=l*ke),Me(n-o)<ke&&(n-=o*ke),s=Tc(e,s,n,i),t.point(l,s),t.lineEnd(),t.lineStart(),t.point(o,s),r=0),t.point(e=n,s=i),l=o},lineEnd:function(){t.lineEnd(),e=s=NaN},clean:function(){return 2-r}}}function Tc(t,e,s,l){var r,n,i=Re(t-s);return Me(i)>ke?la((Re(e)*(n=De(l))*Re(s)-Re(l)*(r=De(e))*Re(t))/(r*n*i)):(e+l)/2}function Ec(t,e,s,l){var r;if(t==null)r=s*je,l.point(-_e,r),l.point(0,r),l.point(_e,r),l.point(_e,0),l.point(_e,-r),l.point(0,-r),l.point(-_e,-r),l.point(-_e,0),l.point(-_e,r);else if(Me(t[0]-e[0])>ke){var n=t[0]<e[0]?_e:-_e;r=s*n/2,l.point(-n,r),l.point(0,r),l.point(n,r)}else l.point(e[0],e[1])}function Ac(t){var e=De(t),s=2*Oe,l=e>0,r=Me(e)>ke;function n(u,c,h,d){wc(d,t,s,h,u,c)}function i(u,c){return De(u)*De(c)>e}function o(u){var c,h,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(v,A){var _=[v,A],x,y=i(v,A),S=l?y?0:f(v,A):y?f(v+(v<0?_e:-_e),A):0;if(!c&&(p=d=y)&&u.lineStart(),y!==d&&(x=a(c,_),(!x||Bn(c,x)||Bn(_,x))&&(_[2]=1)),y!==d)g=0,y?(u.lineStart(),x=a(_,c),u.point(x[0],x[1])):(x=a(c,_),u.point(x[0],x[1],2),u.lineEnd()),c=x;else if(r&&c&&l^y){var C;!(S&h)&&(C=a(_,c,!0))&&(g=0,l?(u.lineStart(),u.point(C[0][0],C[0][1]),u.point(C[1][0],C[1][1]),u.lineEnd()):(u.point(C[1][0],C[1][1]),u.lineEnd(),u.lineStart(),u.point(C[0][0],C[0][1],3)))}y&&(!c||!Bn(c,_))&&u.point(_[0],_[1]),c=_,d=y,h=S},lineEnd:function(){d&&u.lineEnd(),c=null},clean:function(){return g|(p&&d)<<1}}}function a(u,c,h){var d=Dt(u),p=Dt(c),g=[1,0,0],v=Yn(d,p),A=Fn(v,v),_=v[0],x=A-_*_;if(!x)return!h&&u;var y=e*A/x,S=-e*_/x,C=Yn(g,v),U=Mn(g,y),k=Mn(v,S);Er(U,k);var O=C,R=Fn(U,O),N=Fn(O,O),w=R*R-N*(Fn(U,U)-1);if(!(w<0)){var D=er(w),E=Mn(O,(-R-D)/N);if(Er(E,U),E=Wr(E),!h)return E;var b=u[0],G=c[0],j=u[1],J=c[1],B;G<b&&(B=b,b=G,G=B);var P=G-b,m=Me(P-_e)<ke,T=m||P<ke;if(!m&&J<j&&(B=j,j=J,J=B),T?m?j+J>0^E[1]<(Me(E[0]-b)<ke?j:J):j<=E[1]&&E[1]<=J:P>_e^(b<=E[0]&&E[0]<=G)){var M=Mn(O,(-R+D)/N);return Er(M,U),[E,Wr(M)]}}}function f(u,c){var h=l?t:_e-t,d=0;return u<-h?d|=1:u>h&&(d|=2),c<-h?d|=4:c>h&&(d|=8),d}return da(i,o,n,l?[0,-t]:[-_e,t-_e])}function Cc(t,e,s,l,r,n){var i=t[0],o=t[1],a=e[0],f=e[1],u=0,c=1,h=a-i,d=f-o,p;if(p=s-i,!(!h&&p>0)){if(p/=h,h<0){if(p<u)return;p<c&&(c=p)}else if(h>0){if(p>c)return;p>u&&(u=p)}if(p=r-i,!(!h&&p<0)){if(p/=h,h<0){if(p>c)return;p>u&&(u=p)}else if(h>0){if(p<u)return;p<c&&(c=p)}if(p=l-o,!(!d&&p>0)){if(p/=d,d<0){if(p<u)return;p<c&&(c=p)}else if(d>0){if(p>c)return;p>u&&(u=p)}if(p=n-o,!(!d&&p<0)){if(p/=d,d<0){if(p>c)return;p>u&&(u=p)}else if(d>0){if(p<u)return;p<c&&(c=p)}return u>0&&(t[0]=i+u*h,t[1]=o+u*d),c<1&&(e[0]=i+c*h,e[1]=o+c*d),!0}}}}}var qt=1e9,Rn=-qt;function Fc(t,e,s,l){function r(f,u){return t<=f&&f<=s&&e<=u&&u<=l}function n(f,u,c,h){var d=0,p=0;if(f==null||(d=i(f,c))!==(p=i(u,c))||a(f,u)<0^c>0)do h.point(d===0||d===3?t:s,d>1?l:e);while((d=(d+c+4)%4)!==p);else h.point(u[0],u[1])}function i(f,u){return Me(f[0]-t)<ke?u>0?0:3:Me(f[0]-s)<ke?u>0?2:1:Me(f[1]-e)<ke?u>0?1:0:u>0?3:2}function o(f,u){return a(f.x,u.x)}function a(f,u){var c=i(f,1),h=i(u,1);return c!==h?c-h:c===0?u[1]-f[1]:c===1?f[0]-u[0]:c===2?f[1]-u[1]:u[0]-f[0]}return function(f){var u=f,c=ca(),h,d,p,g,v,A,_,x,y,S,C,U={point:k,lineStart:w,lineEnd:D,polygonStart:R,polygonEnd:N};function k(b,G){r(b,G)&&u.point(b,G)}function O(){for(var b=0,G=0,j=d.length;G<j;++G)for(var J=d[G],B=1,P=J.length,m=J[0],T,M,L=m[0],F=m[1];B<P;++B)T=L,M=F,m=J[B],L=m[0],F=m[1],M<=l?F>l&&(L-T)*(l-M)>(F-M)*(t-T)&&++b:F<=l&&(L-T)*(l-M)<(F-M)*(t-T)&&--b;return b}function R(){u=c,h=[],d=[],C=!0}function N(){var b=O(),G=C&&b,j=(h=Po(h)).length;(G||j)&&(f.polygonStart(),G&&(f.lineStart(),n(null,null,1,f),f.lineEnd()),j&&ha(h,o,b,n,f),f.polygonEnd()),u=f,h=d=p=null}function w(){U.point=E,d&&d.push(p=[]),S=!0,y=!1,_=x=NaN}function D(){h&&(E(g,v),A&&y&&c.rejoin(),h.push(c.result())),U.point=k,y&&u.lineEnd()}function E(b,G){var j=r(b,G);if(d&&p.push([b,G]),S)g=b,v=G,A=j,S=!1,j&&(u.lineStart(),u.point(b,G));else if(j&&y)u.point(b,G);else{var J=[_=Math.max(Rn,Math.min(qt,_)),x=Math.max(Rn,Math.min(qt,x))],B=[b=Math.max(Rn,Math.min(qt,b)),G=Math.max(Rn,Math.min(qt,G))];Cc(J,B,t,e,s,l)?(y||(u.lineStart(),u.point(J[0],J[1])),u.point(B[0],B[1]),j||u.lineEnd(),C=!1):j&&(u.lineStart(),u.point(b,G),C=!1)}_=b,x=G,y=j}return U}}const mo=t=>t;var Rt=1/0,Jn=Rt,fn=-Rt,Kn=fn,yo={point:Mc,lineStart:Kt,lineEnd:Kt,polygonStart:Kt,polygonEnd:Kt,result:function(){var t=[[Rt,Jn],[fn,Kn]];return fn=Kn=-(Jn=Rt=1/0),t}};function Mc(t,e){t<Rt&&(Rt=t),t>fn&&(fn=t),e<Jn&&(Jn=e),e>Kn&&(Kn=e)}function ni(t){return function(e){var s=new Xr;for(var l in t)s[l]=t[l];return s.stream=e,s}}function Xr(){}Xr.prototype={constructor:Xr,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function ri(t,e,s){var l=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),l!=null&&t.clipExtent(null),_c(s,t.stream(yo)),e(yo.result()),l!=null&&t.clipExtent(l),t}function pa(t,e,s){return ri(t,function(l){var r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],i=Math.min(r/(l[1][0]-l[0][0]),n/(l[1][1]-l[0][1])),o=+e[0][0]+(r-i*(l[1][0]+l[0][0]))/2,a=+e[0][1]+(n-i*(l[1][1]+l[0][1]))/2;t.scale(150*i).translate([o,a])},s)}function Dc(t,e,s){return pa(t,[[0,0],e],s)}function Rc(t,e,s){return ri(t,function(l){var r=+e,n=r/(l[1][0]-l[0][0]),i=(r-n*(l[1][0]+l[0][0]))/2,o=-n*l[0][1];t.scale(150*n).translate([i,o])},s)}function Lc(t,e,s){return ri(t,function(l){var r=+e,n=r/(l[1][1]-l[0][1]),i=-n*l[0][0],o=(r-n*(l[1][1]+l[0][1]))/2;t.scale(150*n).translate([i,o])},s)}var _o=16,Oc=De(30*Oe);function xo(t,e){return+e?Pc(t,e):Gc(t)}function Gc(t){return ni({point:function(e,s){e=t(e,s),this.stream.point(e[0],e[1])}})}function Pc(t,e){function s(l,r,n,i,o,a,f,u,c,h,d,p,g,v){var A=f-l,_=u-r,x=A*A+_*_;if(x>4*e&&g--){var y=i+h,S=o+d,C=a+p,U=er(y*y+S*S+C*C),k=sn(C/=U),O=Me(Me(C)-1)<ke||Me(n-c)<ke?(n+c)/2:an(S,y),R=t(O,k),N=R[0],w=R[1],D=N-l,E=w-r,b=_*D-A*E;(b*b/x>e||Me((A*D+_*E)/x-.5)>.3||i*h+o*d+a*p<Oc)&&(s(l,r,n,i,o,a,N,w,O,y/=U,S/=U,C,g,v),v.point(N,w),s(N,w,O,y,S,C,f,u,c,h,d,p,g,v))}}return function(l){var r,n,i,o,a,f,u,c,h,d,p,g,v={point:A,lineStart:_,lineEnd:y,polygonStart:function(){l.polygonStart(),v.lineStart=S},polygonEnd:function(){l.polygonEnd(),v.lineStart=_}};function A(k,O){k=t(k,O),l.point(k[0],k[1])}function _(){c=NaN,v.point=x,l.lineStart()}function x(k,O){var R=Dt([k,O]),N=t(k,O);s(c,h,u,d,p,g,c=N[0],h=N[1],u=k,d=R[0],p=R[1],g=R[2],_o,l),l.point(c,h)}function y(){v.point=A,l.lineEnd()}function S(){_(),v.point=C,v.lineEnd=U}function C(k,O){x(r=k,O),n=c,i=h,o=d,a=p,f=g,v.point=x}function U(){s(c,h,u,d,p,g,n,i,r,o,a,f,_o,l),v.lineEnd=y,y()}return v}}var Ic=ni({point:function(t,e){this.stream.point(t*Oe,e*Oe)}});function Bc(t){return ni({point:function(e,s){var l=t(e,s);return this.stream.point(l[0],l[1])}})}function Nc(t,e,s,l,r){function n(i,o){return i*=l,o*=r,[e+t*i,s-t*o]}return n.invert=function(i,o){return[(i-e)/t*l,(s-o)/t*r]},n}function wo(t,e,s,l,r,n){if(!n)return Nc(t,e,s,l,r);var i=De(n),o=Re(n),a=i*t,f=o*t,u=i/t,c=o/t,h=(o*s-i*e)/t,d=(o*e+i*s)/t;function p(g,v){return g*=l,v*=r,[a*g-f*v+e,s-f*g-a*v]}return p.invert=function(g,v){return[l*(u*g-c*v+h),r*(d-c*g-u*v)]},p}function Wc(t){return zc(function(){return t})()}function zc(t){var e,s=150,l=480,r=250,n=0,i=0,o=0,a=0,f=0,u,c=0,h=1,d=1,p=null,g=go,v=null,A,_,x,y=mo,S=.5,C,U,k,O,R;function N(b){return k(b[0]*Oe,b[1]*Oe)}function w(b){return b=k.invert(b[0],b[1]),b&&[b[0]*Je,b[1]*Je]}N.stream=function(b){return O&&R===b?O:O=Ic(Bc(u)(g(C(y(R=b)))))},N.preclip=function(b){return arguments.length?(g=b,p=void 0,E()):g},N.postclip=function(b){return arguments.length?(y=b,v=A=_=x=null,E()):y},N.clipAngle=function(b){return arguments.length?(g=+b?Ac(p=b*Oe):(p=null,go),E()):p*Je},N.clipExtent=function(b){return arguments.length?(y=b==null?(v=A=_=x=null,mo):Fc(v=+b[0][0],A=+b[0][1],_=+b[1][0],x=+b[1][1]),E()):v==null?null:[[v,A],[_,x]]},N.scale=function(b){return arguments.length?(s=+b,D()):s},N.translate=function(b){return arguments.length?(l=+b[0],r=+b[1],D()):[l,r]},N.center=function(b){return arguments.length?(n=b[0]%360*Oe,i=b[1]%360*Oe,D()):[n*Je,i*Je]},N.rotate=function(b){return arguments.length?(o=b[0]%360*Oe,a=b[1]%360*Oe,f=b.length>2?b[2]%360*Oe:0,D()):[o*Je,a*Je,f*Je]},N.angle=function(b){return arguments.length?(c=b%360*Oe,D()):c*Je},N.reflectX=function(b){return arguments.length?(h=b?-1:1,D()):h<0},N.reflectY=function(b){return arguments.length?(d=b?-1:1,D()):d<0},N.precision=function(b){return arguments.length?(C=xo(U,S=b*b),E()):er(S)},N.fitExtent=function(b,G){return pa(N,b,G)},N.fitSize=function(b,G){return Dc(N,b,G)},N.fitWidth=function(b,G){return Rc(N,b,G)},N.fitHeight=function(b,G){return Lc(N,b,G)};function D(){var b=wo(s,0,0,h,d,c).apply(null,e(n,i)),G=wo(s,l-b[0],r-b[1],h,d,c);return u=ua(o,a,f),U=Vr(e,G),k=Vr(u,U),C=xo(U,S),E()}function E(){return O=R=null,N}return function(){return e=t.apply(this,arguments),N.invert=e.invert&&w,D()}}function ii(t,e){return[t,vc(mc((je+e)/2))]}ii.invert=function(t,e){return[t,2*la(pc(e))-je]};function Vc(){return Hc(ii).scale(961/Ke)}function Hc(t){var e=Wc(t),s=e.center,l=e.scale,r=e.translate,n=e.clipExtent,i=null,o,a,f;e.scale=function(c){return arguments.length?(l(c),u()):l()},e.translate=function(c){return arguments.length?(r(c),u()):r()},e.center=function(c){return arguments.length?(s(c),u()):s()},e.clipExtent=function(c){return arguments.length?(c==null?i=o=a=f=null:(i=+c[0][0],o=+c[0][1],a=+c[1][0],f=+c[1][1]),u()):i==null?null:[[i,o],[a,f]]};function u(){var c=_e*l(),h=e(xc(e.rotate()).invert([0,0]));return n(i==null?[[h[0]-c,h[1]-c],[h[0]+c,h[1]+c]]:t===ii?[[Math.max(h[0]-c,i),o],[Math.min(h[0]+c,a),f]]:[[i,Math.max(h[1]-c,o)],[a,Math.min(h[1]+c,f)]])}return u()}function Qt(t,e,s){this.k=t,this.x=e,this.y=s}Qt.prototype={constructor:Qt,scale:function(t){return t===1?this:new Qt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Qt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Qt.prototype;function Xc(){ko();const t=ja(Ka,Ua+"/geo/china.json"),[e,s]=rt.useState([]);rt.useEffect(()=>{let n=JSON.parse(t);const i=[];(a=>{const f=Vc().center([104,37.5]).scale(80).translate([0,0]);a.features.pop(),a.features.forEach(u=>{const c=u.properties.name,h=f(u.properties.center),d=u.geometry.coordinates,p=[];d.forEach(g=>{g.forEach(v=>{for(let A=0;A<v.length;A++){const[_,x]=f(v[A]);let y=new en(_,-x);p.push(y)}})}),i.push({name:c,position:h,shapes:p})})})(n),s(i)},[]);const[l,r]=rt.useState(!1);return He.jsx("group",{position:[-15,0,0],children:e.map((n,i)=>He.jsxs("mesh",{onClick:o=>{alert(n.name),console.log(n)},onPointerOver:()=>{r(i)},children:[He.jsx(Ya,{points:n.shapes,color:"red"}),He.jsx(Sa,{position:[0,0,-1.2],"material-color":i===l?16776960:new ln(255*255+i*10),args:[new Ja(n.shapes)]}),He.jsx(Ys,{position:[n.position[0],-n.position[1],.1],scale:.7,color:"red",children:n.name},i)]},n.name))})}const jc=()=>He.jsxs(Ha,{shadows:!0,dpr:[1,2],style:{height:"60vh"},gl:{alpha:!1},scene:{background:new ln(16777215)},camera:{position:[0,0,90],fov:45},children:[He.jsx(Xa,{}),He.jsx(qa,{children:He.jsx(Qa,{axisColors:["red","green","blue"],labelColor:"black"})}),He.jsx("ambientLight",{intensity:Math.PI}),He.jsx(Xc,{})]}),Yc=`import { staticPath } from '@/utils'
import {
  Extrude,
  GizmoHelper,
  GizmoViewport,
  Line,
  OrbitControls,
  Text,
} from '@react-three/drei'
import { Canvas, useLoader, useThree } from '@react-three/fiber'
import * as d3 from 'd3'
import { useEffect, useState } from 'react'
import * as THREE from 'three'

function Com() {
  const { scene } = useThree()
  const data = useLoader(THREE.FileLoader, staticPath + '/geo/china.json')
  const [fonts, setFonts] = useState([])
  useEffect(() => {
    let _data = JSON.parse(data)
    const fontsArr = []
    const generateGeometry = (jsondata) => {
      // 墨卡托投影转换
      const projection = d3
        .geoMercator()
        .center([104.0, 37.5])
        .scale(80)
        .translate([0, 0])
      jsondata.features.pop()
      jsondata.features.forEach((elem) => {
        const name = elem.properties.name
        const center = projection(elem.properties.center)
        // 每个的 坐标 数组
        const coordinates = elem.geometry.coordinates
        const shapes = []
        // 循环坐标数组
        coordinates.forEach((multiPolygon) => {
          multiPolygon.forEach((polygon) => {
            const points = []
            for (let i = 0; i < polygon.length; i++) {
              const [x, y] = projection(polygon[i])
              let point = new THREE.Vector2(x, -y)
              points.push(point)
              shapes.push(point)
            }
          })
        })
        fontsArr.push({
          name,
          position: center,
          shapes,
        })
      })
    }
    generateGeometry(_data)
    setFonts(fontsArr)
  }, [])
  const [checked, setChecked] = useState(false)

  return (
    <group position={[-15, 0, 0]}>
      {fonts.map((item, i) => {
        return (
          <mesh
            key={item.name}
            onClick={(e) => {
              alert(item.name)
              console.log(item)
            }}
            onPointerOver={() => {
              setChecked(i)
            }}
          >
            <Line points={item.shapes} color="red" />
            <Extrude
              position={[0, 0, -1.2]}
              material-color={
                i === checked ? 0xffff00 : new THREE.Color(255 * 255 + i * 10)
              }
              args={[new THREE.Shape(item.shapes)]}
            ></Extrude>

            <Text
              position={[item.position[0], -item.position[1], 0.1]}
              key={i}
              scale={0.7}
              color="red"
            >
              {item.name}
            </Text>
          </mesh>
        )
      })}
    </group>
  )
}

const Geo = () => {
  return (
    <Canvas
      shadows
      dpr={[1, 2]}
      style={{ height: '60vh' }}
      gl={{ alpha: false }}
      scene={{ background: new THREE.Color(0xffffff) }}
      camera={{ position: [0, 0, 90], fov: 45 }}
    >
      <OrbitControls />
      {/* <axesHelper args={[10]} /> */}
      <GizmoHelper>
        <GizmoViewport
          axisColors={['red', 'green', 'blue']}
          labelColor="black"
        />
      </GizmoHelper>
      <ambientLight intensity={Math.PI} />
      <Com />
    </Canvas>
  )
}
export default Geo
`,Jc=void 0,Kc=void 0,qc={code:Yc,title:Jc,desc:Kc},Qc=!0,Zc=Object.freeze(Object.defineProperty({__proto__:null,default:jc,demoMeta:qc,isDemo:Qc},Symbol.toStringTag,{value:"Module"}));function bo(t){const{Demo:e}={...So(),...t.components};return e||eh("Demo"),He.jsx(e,{...Zc})}function $c(t={}){const{wrapper:e}={...So(),...t.components};return e?He.jsx(e,{...t,children:He.jsx(bo,{...t})}):bo(t)}function eh(t,e){throw new Error("Expected component `"+t+"` to be defined: you likely forgot to import, pass, or provide it.")}const th=Object.freeze(Object.defineProperty({__proto__:null,default:$c},Symbol.toStringTag,{value:"Module"})),va={};va.outlineInfo=ba;va.main=th;export{va as default};
